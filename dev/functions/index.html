<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · PlantBiophysics.jl</title><meta name="title" content="API · PlantBiophysics.jl"/><meta property="og:title" content="API · PlantBiophysics.jl"/><meta property="twitter:title" content="API · PlantBiophysics.jl"/><meta name="description" content="Documentation for PlantBiophysics.jl."/><meta property="og:description" content="Documentation for PlantBiophysics.jl."/><meta property="twitter:description" content="Documentation for PlantBiophysics.jl."/><meta property="og:url" content="https://VEZY.github.io/PlantBiophysics.jl/functions/"/><meta property="twitter:url" content="https://VEZY.github.io/PlantBiophysics.jl/functions/"/><link rel="canonical" href="https://VEZY.github.io/PlantBiophysics.jl/functions/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="PlantBiophysics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">PlantBiophysics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../getting_started/get_started/">TL;DR</a></li><li><a class="tocitem" href="../getting_started/first_fit/">Parameter fitting</a></li></ul></li><li><a class="tocitem" href="../concepts/package_design/">Design</a></li><li><a class="tocitem" href="../variables/">Variables</a></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../models/photosynthesis/">Photosynthesis</a></li><li><a class="tocitem" href="../models/gs/">Stomatal conductance</a></li><li><a class="tocitem" href="../models/energy_balance/">Energy balance</a></li><li><a class="tocitem" href="../models/light/">Light interception</a></li></ul></li><li><a class="tocitem" href="../climate/microclimate/">Micro-climate</a></li><li><a class="tocitem" href="../fitting/parameter_fitting/">Tutorial: Parameter fitting</a></li><li><span class="tocitem">Tutorial: Simulation</span><ul><li><a class="tocitem" href="../simulation/first_simulation/">Simple Simulation</a></li><li><a class="tocitem" href="../simulation/several_simulation/">Several time steps</a></li><li><a class="tocitem" href="../simulation/several_objects_simulation/">Several objects</a></li><li><a class="tocitem" href="../simulation/mtg_simulation/">Whole-plant simulation</a></li></ul></li><li><a class="tocitem" href="../simulation/uncertainty_propagation/">Tutorial: Uncertainty propagation</a></li><li><span class="tocitem">Extending PlantBiophysics</span><ul><li><a class="tocitem" href="../extending/implement_a_model/">Implement a model</a></li><li><a class="tocitem" href="../extending/implement_a_process/">Implement a process</a></li></ul></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#API-documentation"><span>API documentation</span></a></li><li><a class="tocitem" href="#Un-exported-functions"><span>Un-exported functions</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/VEZY/PlantBiophysics.jl/blob/master/docs/src/functions.md#L" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h1><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#PlantBiophysics.AbstractEnergy_BalanceModel"><code>PlantBiophysics.AbstractEnergy_BalanceModel</code></a></li><li><a href="#PlantBiophysics.AbstractLight_InterceptionModel"><code>PlantBiophysics.AbstractLight_InterceptionModel</code></a></li><li><a href="#PlantBiophysics.AbstractPhotosynthesisModel"><code>PlantBiophysics.AbstractPhotosynthesisModel</code></a></li><li><a href="#PlantBiophysics.AbstractStomatal_ConductanceModel"><code>PlantBiophysics.AbstractStomatal_ConductanceModel</code></a></li><li><a href="#PlantBiophysics.Beer"><code>PlantBiophysics.Beer</code></a></li><li><a href="#PlantBiophysics.BeerShortwave"><code>PlantBiophysics.BeerShortwave</code></a></li><li><a href="#PlantBiophysics.ConstantA"><code>PlantBiophysics.ConstantA</code></a></li><li><a href="#PlantBiophysics.ConstantAGs"><code>PlantBiophysics.ConstantAGs</code></a></li><li><a href="#PlantBiophysics.ConstantGs"><code>PlantBiophysics.ConstantGs</code></a></li><li><a href="#PlantBiophysics.Fvcb"><code>PlantBiophysics.Fvcb</code></a></li><li><a href="#PlantBiophysics.FvcbIter"><code>PlantBiophysics.FvcbIter</code></a></li><li><a href="#PlantBiophysics.FvcbRaw"><code>PlantBiophysics.FvcbRaw</code></a></li><li><a href="#PlantBiophysics.LightIgnore"><code>PlantBiophysics.LightIgnore</code></a></li><li><a href="#PlantBiophysics.Medlyn"><code>PlantBiophysics.Medlyn</code></a></li><li><a href="#PlantBiophysics.Monteith"><code>PlantBiophysics.Monteith</code></a></li><li><a href="#PlantBiophysics.OpticalProperties"><code>PlantBiophysics.OpticalProperties</code></a></li><li><a href="#PlantBiophysics.Translucent"><code>PlantBiophysics.Translucent</code></a></li><li><a href="#PlantBiophysics.σ"><code>PlantBiophysics.σ</code></a></li><li><a href="#PlantBiophysics.Fvcb_net_assimiliation-NTuple{7, Any}"><code>PlantBiophysics.Fvcb_net_assimiliation</code></a></li><li><a href="#PlantBiophysics.arrhenius"><code>PlantBiophysics.arrhenius</code></a></li><li><a href="#PlantBiophysics.arrhenius"><code>PlantBiophysics.arrhenius</code></a></li><li><a href="#PlantBiophysics.black_body-Tuple{Any, Any, Any}"><code>PlantBiophysics.black_body</code></a></li><li><a href="#PlantBiophysics.f_ms_to_mol-NTuple{4, Any}"><code>PlantBiophysics.f_ms_to_mol</code></a></li><li><a href="#PlantBiophysics.gbh_to_gbw"><code>PlantBiophysics.gbh_to_gbw</code></a></li><li><a href="#PlantBiophysics.gbₕ_forced-Tuple{Any, Any}"><code>PlantBiophysics.gbₕ_forced</code></a></li><li><a href="#PlantBiophysics.gbₕ_free"><code>PlantBiophysics.gbₕ_free</code></a></li><li><a href="#PlantBiophysics.get_Cᵢᵥ-NTuple{7, Any}"><code>PlantBiophysics.get_Cᵢᵥ</code></a></li><li><a href="#PlantBiophysics.get_Cᵢⱼ-NTuple{6, Any}"><code>PlantBiophysics.get_Cᵢⱼ</code></a></li><li><a href="#PlantBiophysics.get_Dₕ"><code>PlantBiophysics.get_Dₕ</code></a></li><li><a href="#PlantBiophysics.get_J-NTuple{4, Any}"><code>PlantBiophysics.get_J</code></a></li><li><a href="#PlantBiophysics.get_km"><code>PlantBiophysics.get_km</code></a></li><li><a href="#PlantBiophysics.get_model-Tuple{Any, Any}"><code>PlantBiophysics.get_model</code></a></li><li><a href="#PlantBiophysics.get_process-Tuple{Any}"><code>PlantBiophysics.get_process</code></a></li><li><a href="#PlantBiophysics.grey_body-NTuple{4, Any}"><code>PlantBiophysics.grey_body</code></a></li><li><a href="#PlantBiophysics.gs_closure"><code>PlantBiophysics.gs_closure</code></a></li><li><a href="#PlantBiophysics.gs_closure"><code>PlantBiophysics.gs_closure</code></a></li><li><a href="#PlantBiophysics.gsc_to_gsw"><code>PlantBiophysics.gsc_to_gsw</code></a></li><li><a href="#PlantBiophysics.gsw_to_gsc"><code>PlantBiophysics.gsw_to_gsc</code></a></li><li><a href="#PlantBiophysics.instantiate-NTuple{4, Any}"><code>PlantBiophysics.instantiate</code></a></li><li><a href="#PlantBiophysics.is_model-Tuple{Any}"><code>PlantBiophysics.is_model</code></a></li><li><a href="#PlantBiophysics.latent_heat-NTuple{8, Any}"><code>PlantBiophysics.latent_heat</code></a></li><li><a href="#PlantBiophysics.locf!-Tuple{Any}"><code>PlantBiophysics.locf!</code></a></li><li><a href="#PlantBiophysics.max_root-Tuple{Any, Any, Any}"><code>PlantBiophysics.max_root</code></a></li><li><a href="#PlantBiophysics.mol_to_ms-NTuple{5, Any}"><code>PlantBiophysics.mol_to_ms</code></a></li><li><a href="#PlantBiophysics.ms_to_mol-NTuple{5, Any}"><code>PlantBiophysics.ms_to_mol</code></a></li><li><a href="#PlantBiophysics.negative_root-Tuple{Any, Any, Any}"><code>PlantBiophysics.negative_root</code></a></li><li><a href="#PlantBiophysics.net_longwave_radiation-NTuple{7, Any}"><code>PlantBiophysics.net_longwave_radiation</code></a></li><li><a href="#PlantBiophysics.positive_root-Tuple{Any, Any, Any}"><code>PlantBiophysics.positive_root</code></a></li><li><a href="#PlantBiophysics.read_licor6400-Tuple{Any}"><code>PlantBiophysics.read_licor6400</code></a></li><li><a href="#PlantBiophysics.read_model-Tuple{Any}"><code>PlantBiophysics.read_model</code></a></li><li><a href="#PlantBiophysics.read_walz-Tuple{Any}"><code>PlantBiophysics.read_walz</code></a></li><li><a href="#PlantBiophysics.sensible_heat-NTuple{8, Any}"><code>PlantBiophysics.sensible_heat</code></a></li><li><a href="#PlantBiophysics.Γ_star"><code>PlantBiophysics.Γ_star</code></a></li><li><a href="#PlantBiophysics.γ_star-NTuple{6, Any}"><code>PlantBiophysics.γ_star</code></a></li><li><a href="#PlantBiophysics.λE_to_E"><code>PlantBiophysics.λE_to_E</code></a></li><li><a href="#PlantSimEngine.fit-Tuple{Type{Beer}, Any}"><code>PlantSimEngine.fit</code></a></li><li><a href="#PlantSimEngine.fit-Union{Tuple{T}, Tuple{T, Any}} where T&lt;:Union{Type{Fvcb}, Type{FvcbIter}, Type{FvcbRaw}}"><code>PlantSimEngine.fit</code></a></li><li><a href="#PlantSimEngine.fit-Union{Tuple{T}, Tuple{T, Any}} where T&lt;:Type{Medlyn}"><code>PlantSimEngine.fit</code></a></li><li><a href="#PlantSimEngine.run!"><code>PlantSimEngine.run!</code></a></li><li><a href="#PlantSimEngine.run!"><code>PlantSimEngine.run!</code></a></li><li><a href="#PlantSimEngine.run!"><code>PlantSimEngine.run!</code></a></li><li><a href="#PlantSimEngine.run!"><code>PlantSimEngine.run!</code></a></li><li><a href="#PlantSimEngine.run!"><code>PlantSimEngine.run!</code></a></li><li><a href="#PlantSimEngine.run!-Tuple{ConstantGs, Any, Any, Any}"><code>PlantSimEngine.run!</code></a></li><li><a href="#PlantSimEngine.run!"><code>PlantSimEngine.run!</code></a></li><li><a href="#PlantSimEngine.run!"><code>PlantSimEngine.run!</code></a></li><li><a href="#PlantSimEngine.run!"><code>PlantSimEngine.run!</code></a></li></ul><h2 id="API-documentation"><a class="docs-heading-anchor" href="#API-documentation">API documentation</a><a id="API-documentation-1"></a><a class="docs-heading-anchor-permalink" href="#API-documentation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.AbstractEnergy_BalanceModel" href="#PlantBiophysics.AbstractEnergy_BalanceModel"><code>PlantBiophysics.AbstractEnergy_BalanceModel</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>energy_balance</code> process abstract model. </p><p>All models implemented to simulate the <code>energy_balance</code> process must be a subtype of this type, <em>e.g.</em>  <code>struct MyEnergy_BalanceModel &lt;: AbstractEnergy_BalanceModel end</code>.</p><p>You can list all models implementing this process using <code>subtypes</code>:</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">subtypes(AbstractEnergy_BalanceModel)</code></pre><p>Energy balance process. This process computes the energy balance of objects,  meaning that it computes the net radiation, the sensible heat flux, and the  latent heat flux if necessary. It can be coupled with a photosynthesis  model in the case of plants leaves.</p><p>At the moment, two models are implemented in the package:</p><ul><li><code>Monteith</code>: the model found in Monteith and Unsworth (2013)</li><li><code>Missing</code>: if no computation of the energy balance is needed</li></ul><p><strong>Note</strong></p><p>Some models need input values for some variables. For example <code>Monteith</code> requires a value for <code>Ra_SW_f</code>, <code>d</code> and <code>sky_fraction</code>. If you read the models from a file, you can use <code>init_status!</code> (see examples).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantMeteo, PlantSimEngine, PlantBiophysics

# ---Simple example---

meteo = Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)

# Using the model of Monteith and Unsworth (2013) for energy, Farquhar et al. (1980) for
# photosynthesis, and Medlyn et al. (2011) for stomatal conductance:
leaf =
    ModelList(
        energy_balance = Monteith(),
        photosynthesis = Fvcb(),
        stomatal_conductance = Medlyn(0.03, 12.0),
        status = (Ra_SW_f = 13.747, sky_fraction = 1.0, aPPFD = 1500.0, d = 0.03)
    )

run!(leaf,meteo)

# ---Using several components---

leaf2 = copy(leaf)
leaf2[:aPPFD] = 800.0

run!([leaf,leaf2],meteo)

# You can use a Dict if you&#39;d like to keep track of the leaf in the returned DataFrame:
run!(Dict(:leaf1 =&gt; leaf, :leaf2 =&gt; leaf2), meteo)

# ---Using several meteo time-steps---

w = Weather(
    [
        Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65),
        Atmosphere(T = 25.0, Wind = 1.5, P = 101.3, Rh = 0.55)
    ],
    (site = &quot;Test site&quot;,)
)

leaf =
    ModelList(
        energy_balance = Monteith(),
        photosynthesis = Fvcb(),
        stomatal_conductance = Medlyn(0.03, 12.0),
        status = (Ra_SW_f = [12.0,13.747], sky_fraction = 1.0, aPPFD = 1500.0, d = 0.03)
    )

run!(leaf, w)

# ---Using several meteo time-steps and several components---

leaf2 =
    ModelList(
        energy_balance = Monteith(),
        photosynthesis = Fvcb(),
        stomatal_conductance = Medlyn(0.03, 12.0),
        status = (Ra_SW_f = [12.0,13.747], sky_fraction = 1.0, aPPFD = 1500.0, d = 0.01)
    )

run!(Dict(:leaf1 =&gt; leaf, :leaf2 =&gt; leaf2), w)

# ---Using a model file---

model = read_model(joinpath(dirname(dirname(pathof(PlantBiophysics))),&quot;test&quot;,&quot;inputs&quot;,&quot;models&quot;,&quot;plant_coffee.yml&quot;))

# An example model file is available here:
# &quot;https://raw.githubusercontent.com/VEZY/PlantBiophysics/main/test/inputs/models/plant_coffee.yml&quot;

# Initialising the mandatory variables:
init_status!(model, Ra_SW_f = 13.747, sky_fraction = 1.0, aPPFD = 1500.0, Tₗ = 25.0, d = 0.03)

# NB: To know which variables has to be initialized according to the models used, you can use
# `to_initialize(ComponentModels)`, *e.g.*:
to_initialize(model[&quot;Leaf&quot;])

# Running a simulation for all component types in the same scene:
run!(model, meteo)

model[&quot;Leaf&quot;].status.Rn
model[&quot;Leaf&quot;].status.A
model[&quot;Leaf&quot;].status.Cᵢ

# ---Simulation on a full plant using an MTG---

using PlantBiophysics, MultiScaleTreeGraph, PlantGeom, GLMakie, Dates, PlantMeteo

file = joinpath(dirname(dirname(pathof(PlantBiophysics))), &quot;test&quot;, &quot;inputs&quot;, &quot;scene&quot;, &quot;opf&quot;, &quot;coffee.opf&quot;)
mtg = read_opf(file)

# Import the meteorology:
met_file = joinpath(dirname(dirname(pathof(PlantMeteo))), &quot;test&quot;, &quot;data&quot;, &quot;meteo.csv&quot;)

meteo = read_weather(
    met_file,
    :temperature =&gt; :T,
    :relativeHumidity =&gt; (x -&gt; x ./ 100) =&gt; :Rh,
    :wind =&gt; :Wind,
    :atmosphereCO2_ppm =&gt; :Cₐ,
    date_format = DateFormat(&quot;yyyy/mm/dd&quot;)
)

# Make the models:
models = Dict(
    &quot;Leaf&quot; =&gt;
        ModelList(
            energy_balance = Monteith(),
            photosynthesis = Fvcb(),
            stomatal_conductance = Medlyn(0.03, 12.0),
            status = (d = 0.03,)
        )
)

# List the MTG attributes:
names(mtg)
# We have the skyFraction already, but not Ra_SW_f and aPPFD, so we must compute them first.
# Ra_SW_f is the shortwave radiation (or global radiation), so it is the sum of Ra_PAR_f and Ra_NIR_f.
# aPPFD is the PAR in μmol m-2 s-1, so Ra_PAR_f * 4.57.

# We can compute them using the following code (transform! comes from MultiScaleTreeGraph.jl):
transform!(
    mtg,
    [:Ra_PAR_f, :Ra_NIR_f] =&gt; ((x, y) -&gt; x + y) =&gt; :Ra_SW_f,
    :Ra_PAR_f =&gt; (x -&gt; x * 4.57) =&gt; :aPPFD,
    ignore_nothing = true
)

# We can now initialize the models in the mtg:
init_mtg_models!(mtg, models, length(meteo))

# Making the simulation:
run!(mtg, meteo)

# Pull the leaf temperature of the first step:
transform!(
    mtg,
    :Tₗ =&gt; (x -&gt; x[1]) =&gt; :Tₗ_1,
    ignore_nothing = true
)

# Vizualise the output:
viz(mtg, color = :Tₗ_1)</code></pre><p><strong>References</strong></p><p>Duursma, R. A., et B. E. Medlyn. 2012. « MAESPA: a model to study interactions between water limitation, environmental drivers and vegetation function at tree and stand levels, with an example application to [CO2] × drought interactions ». Geoscientific Model Development 5 (4): 919‑40. https://doi.org/10.5194/gmd-5-919-2012.</p><p>Monteith, John L., et Mike H. Unsworth. 2013. « Chapter 13 - Steady-State Heat Balance: (i) Water Surfaces, Soil, and Vegetation ». In Principles of Environmental Physics (Fourth Edition), edited by John L. Monteith et Mike H. Unsworth, 217‑47. Boston: Academic Press.</p><p>Schymanski, Stanislaus J., et Dani Or. 2017. « Leaf-Scale Experiments Reveal an Important Omission in the Penman–Monteith Equation ». Hydrology and Earth System Sciences 21 (2): 685‑706. https://doi.org/10.5194/hess-21-685-2017.</p><p>Vezy, Rémi, Mathias Christina, Olivier Roupsard, Yann Nouvellon, Remko Duursma, Belinda Medlyn, Maxime Soma, et al. 2018. « Measuring and modelling energy partitioning in canopies of varying complexity using MAESPA model ». Agricultural and Forest Meteorology 253‑254 (printemps): 203‑17. https://doi.org/10.1016/j.agrformet.2018.02.005.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VirtualPlantLab/PlantSimEngine.jl/blob/v0.10.1/src/processes/process_generation.jl#L69-L262">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.AbstractLight_InterceptionModel" href="#PlantBiophysics.AbstractLight_InterceptionModel"><code>PlantBiophysics.AbstractLight_InterceptionModel</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>light_interception</code> process abstract model. </p><p>All models implemented to simulate the <code>light_interception</code> process must be a subtype of this type, <em>e.g.</em>  <code>struct MyLight_InterceptionModel &lt;: AbstractLight_InterceptionModel end</code>.</p><p>You can list all models implementing this process using <code>subtypes</code>:</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">subtypes(AbstractLight_InterceptionModel)</code></pre><p>Light interception process. Available as <code>object.light_interception</code>.</p><p>At the moment, two models are implemented in the package:</p><ul><li><code>Beer</code>: the Beer-Lambert law of ligth extinction</li><li><code>LightIgnore</code>: ignore the computation of light interception (this one is for backward</li></ul><p>compatibility with ARCHIMED-ϕ)</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantSimEngine, PlantBiophysics, PlantMeteo
m = ModelList(light_interception=Beer(0.5), status=(LAI=2.0,))

meteo = Atmosphere(T=20.0, Wind=1.0, P=101.3, Rh=0.65, Ri_PAR_f=300.0)

run!(m, meteo)

m[:aPPFD]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VirtualPlantLab/PlantSimEngine.jl/blob/v0.10.1/src/processes/process_generation.jl#L69-L102">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.AbstractPhotosynthesisModel" href="#PlantBiophysics.AbstractPhotosynthesisModel"><code>PlantBiophysics.AbstractPhotosynthesisModel</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>photosynthesis</code> process abstract model. </p><p>All models implemented to simulate the <code>photosynthesis</code> process must be a subtype of this type, <em>e.g.</em>  <code>struct MyPhotosynthesisModel &lt;: AbstractPhotosynthesisModel end</code>.</p><p>You can list all models implementing this process using <code>subtypes</code>:</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">subtypes(AbstractPhotosynthesisModel)</code></pre><p>Photosynthesis process to compute the CO₂ assimilation, and potentially hard-coupled with a stomatal conductance process.</p><p>The models used are defined by the types of the <code>photosynthesis</code> and <code>stomatal_conductance</code> fields of the <code>ModelList</code>. For exemple to use the implementation of the Farquhar–von Caemmerer–Berry (FvCB) model, use the type <code>Fvcb</code> (see example below).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantSimEngine, PlantMeteo, PlantBiophysics

meteo = Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)

# Using Fvcb model:
leaf =
    ModelList(
        photosynthesis = Fvcb(),
        stomatal_conductance = Medlyn(0.03, 12.0),
        status = (Tₗ = 25.0, aPPFD = 1000.0, Cₛ = 400.0, Dₗ = meteo.VPD)
    )

run!(leaf, meteo)

# ---Using several components---

leaf2 = copy(leaf)
leaf2.status.aPPFD = 800.0

run!([leaf,leaf2],meteo)

# ---Using several meteo time-steps---

w = Weather(
        [
            Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65),
            Atmosphere(T = 25.0, Wind = 1.5, P = 101.3, Rh = 0.55)
        ],
        (site = &quot;Test site,)
    )

run!(leaf, w)

# ---Using several meteo time-steps and several components---

run!(Dict(:leaf1 =&gt; leaf, :leaf2 =&gt; leaf2), w)

# Using a model file:

model = read_model(&quot;a-model-file.yml&quot;)

# Initialising the mandatory variables:
init_status!(model, Tₗ = 25.0, aPPFD = 1000.0, Cₛ = 400.0, Dₗ = meteo.VPD)

# Running a simulation for all component types in the same scene:
run!(model, meteo)
model[&quot;Leaf&quot;].status.A
</code></pre><p>Note that we use <code>VPD</code> as an approximation of <code>Dₗ</code> here because we don&#39;t have the leaf temperature (<em>i.e.</em> <code>Dₗ = VPD</code> when <code>Tₗ = T</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VirtualPlantLab/PlantSimEngine.jl/blob/v0.10.1/src/processes/process_generation.jl#L69-L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.AbstractStomatal_ConductanceModel" href="#PlantBiophysics.AbstractStomatal_ConductanceModel"><code>PlantBiophysics.AbstractStomatal_ConductanceModel</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>stomatal_conductance</code> process abstract model. </p><p>All models implemented to simulate the <code>stomatal_conductance</code> process must be a subtype of this type, <em>e.g.</em>  <code>struct MyStomatal_ConductanceModel &lt;: AbstractStomatal_ConductanceModel end</code>.</p><p>You can list all models implementing this process using <code>subtypes</code>:</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">subtypes(AbstractStomatal_ConductanceModel)</code></pre><p>Process for the stomatal conductance for CO₂ (mol m⁻² s⁻¹), it takes the form:</p><p><code>leaf.stomatal_conductance.g0 + gs_closure(leaf,meteo) * leaf.status.A</code></p><p>where gs<em>closure(leaf,meteo) computes the stomatal closure, and must be implemented for the type of `leaf.stomatal</em>conductance<code>. The stomatal conductance is not allowed to go below</code>leaf.stomatal<em>conductance.gs</em>min`.</p><p><strong>Arguments</strong></p><ul><li><code>Gs::Gsm</code>: a stomatal conductance model, usually the leaf model (<em>i.e.</em> leaf.stomatal_conductance)</li><li><code>models::ModelList</code>: A leaf struct holding the parameters for the model. See</li></ul><p><code>ModelList</code>, and <code>Medlyn</code> or <code>ConstantGs</code> for the conductance models.</p><ul><li><code>status::Status</code>: A status, usually the leaf status (<em>i.e.</em> leaf.status)</li><li><code>gs_mod</code>: the output from a <code>gs_closure</code> implementation (the conductance models</li></ul><p>generally only implement this function)</p><ul><li><code>meteo&lt;:PlantMeteo.AbstractAtmosphere</code>: meteo data, see <a href="https://palmstudio.github.io/PlantMeteo.jl/stable/#PlantMeteo.Atmosphere"><code>Atmosphere</code></a></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantMeteo, PlantSimEngine, PlantBiophysics
meteo = Atmosphere(T = 22.0, Wind = 0.8333, P = 101.325, Rh = 0.4490995)

# Using a constant value for Gs:

leaf =
    ModelList(
        stomatal_conductance = Medlyn(0.03,12.0), # Instance of a Medlyn type
        status = (A = 20.0, Cₛ = 380.0, Dₗ = meteo.VPD)
    )

# Computing the stomatal conductance using the Medlyn et al. (2011) model:
run!(leaf,meteo)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VirtualPlantLab/PlantSimEngine.jl/blob/v0.10.1/src/processes/process_generation.jl#L69-L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.Beer" href="#PlantBiophysics.Beer"><code>PlantBiophysics.Beer</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Beer(k)</code></pre><p>Beer-Lambert law for light interception.</p><p>Required inputs: <code>LAI</code> in m² m⁻². Required meteorology data: <code>Ri_PAR_f</code>, the incident flux of atmospheric radiation in the PAR, in W m[soil]⁻² (== J m[soil]⁻² s⁻¹).</p><p>Output: aPPFD, the absorbed Photosynthetic Photon Flux Density in μmol[PAR] m[leaf]⁻² s⁻¹.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/light/Beer.jl#LL1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.BeerShortwave" href="#PlantBiophysics.BeerShortwave"><code>PlantBiophysics.BeerShortwave</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">BeerShortwave(k, f)
BeerShortwave(k)</code></pre><p>The Beer-Lambert law for light interception for the shortwave radiation.</p><p><strong>Arguments</strong></p><ul><li><code>k_PAR</code>: extinction coefficient for the PAR</li><li><code>k_NIR</code>: extinction coefficient for the NIR, taken equal to the one for the PAR by default</li></ul><p><strong>Required inputs</strong></p><ul><li><code>LAI</code>: the leaf area index (m² m⁻²)</li><li><code>Ri_PAR_f</code>: (from meteorology) the incident flux of atmospheric radiation in the PAR, in W m[soil]⁻² (== J m[soil]⁻² s⁻¹).</li><li><code>Ri_NIR_f</code>: (from meteorology) the incident flux of atmospheric radiation in the NIR, in W m[soil]⁻² (== J m[soil]⁻² s⁻¹).</li></ul><p><strong>Outputs</strong></p><ul><li><code>aPPFD</code>: the absorbed Photosynthetic Photon Flux Density in μmol[PAR] m[leaf]⁻² s⁻¹.</li><li><code>Ra_PAR_f</code>: the absorbed PAR in W m[leaf]⁻².</li><li><code>Ra_NIR_f</code>: the absorbed NIR in W m[leaf]⁻².</li><li><code>Ra_SW_f</code>: the absorbed shortwave radiation in W m[leaf]⁻².</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantSimEngine, PlantBiophysics, PlantMeteo

m = ModelList(light_interception=BeerShortwave(0.5), status=(LAI=2.0,))
meteo = Atmosphere(T=20.0, Wind=1.0, P=101.3, Rh=0.65, Ri_PAR_f=300.0, Ri_NIR_f=280.0)

run!(m, meteo)

m[:aPPFD]
m[:Ra_SW_f]
m[:Ra_PAR_f]
m[:Ra_NIR_f]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/light/Beer_shortwave.jl#LL1-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.ConstantA" href="#PlantBiophysics.ConstantA"><code>PlantBiophysics.ConstantA</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Constant (forced) assimilation, given in <span>$μmol\ m^{-2}\ s^{-1}$</span>.</p><p>See also <a href="../models/photosynthesis/#ConstantAGs"><code>ConstantAGs</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">ConstantA(30.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/photosynthesis/constantA.jl#LL2-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.ConstantAGs" href="#PlantBiophysics.ConstantAGs"><code>PlantBiophysics.ConstantAGs</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Constant (forced) assimilation, given in <span>$μmol\ m^{-2}\ s^{-1}$</span>, coupled with a stomatal conductance model that helps computing Cᵢ.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">ConstantAGs(30.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/photosynthesis/constantAGs.jl#LL2-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.ConstantGs" href="#PlantBiophysics.ConstantGs"><code>PlantBiophysics.ConstantGs</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Constant stomatal conductance for CO₂ struct.</p><p><strong>Arguments</strong></p><ul><li><code>g0</code>: intercept (only used when calling from a photosynthesis model, <em>e.g.</em> Fvcb).</li><li><code>Gₛ</code>: stomatal conductance.</li></ul><p>Then used as follows: Gs = ConstantGs(0.0,0.1)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/conductances/stomatal/constantGs.jl#LL2-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.Fvcb" href="#PlantBiophysics.Fvcb"><code>PlantBiophysics.Fvcb</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Farquhar–von Caemmerer–Berry (FvCB) model for C3 photosynthesis (Farquhar et al., 1980; von Caemmerer and Farquhar, 1981) coupled with a conductance model.</p><p><strong>Parameters</strong></p><ul><li><code>Tᵣ</code>: the reference temperature (°C) at which other parameters were measured</li><li><code>VcMaxRef</code>: maximum rate of Rubisco activity (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>JMaxRef</code>: potential rate of electron transport (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>RdRef</code>: mitochondrial respiration in the light at reference temperature (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>TPURef</code>: triose phosphate utilization-limited photosynthesis rate (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>Eₐᵣ</code>: activation energy (<span>$J\ mol^{-1}$</span>), or the exponential rate of rise for Rd.</li><li><code>O₂</code>: intercellular dioxygen concentration (<span>$ppm$</span>)</li><li><code>Eₐⱼ</code>: activation energy (<span>$J\ mol^{-1}$</span>), or the exponential rate of rise for JMax.</li><li><code>Hdⱼ</code>: rate of decrease of the function above the optimum (also called EDVJ) for JMax.</li><li><code>Δₛⱼ</code>: entropy factor for JMax.</li><li><code>Eₐᵥ</code>: activation energy (<span>$J\ mol^{-1}$</span>), or the exponential rate of rise for VcMax.</li><li><code>Hdᵥ</code>: rate of decrease of the function above the optimum (also called EDVC) for VcMax.</li><li><code>Δₛᵥ</code>: entropy factor for VcMax.</li><li><code>α</code>: quantum yield of electron transport (<span>$mol_e\ mol^{-1}_{quanta}$</span>). See also eq. 4 of</li></ul><p>Medlyn et al. (2002), equation 9.16 from von Caemmerer et al. (2009) ((1-f)/2) and its implementation in <a href="#PlantBiophysics.get_J-NTuple{4, Any}"><code>get_J</code></a></p><ul><li><code>θ</code>: determines the curvature of the light response curve for <code>J~aPPFD</code>. See also eq. 4 of</li></ul><p>Medlyn et al. (2002) and its implementation in <a href="#PlantBiophysics.get_J-NTuple{4, Any}"><code>get_J</code></a></p><p><strong>Note on parameters</strong></p><p>The default values of the temperature correction parameters are taken from <a href="https://remkoduursma.github.io/plantecophys/">plantecophys</a>. If there is no negative effect of high temperatures on the reaction (Jmax or VcMax), then Δₛ can be set to 0.0.</p><p>θ is taken at 0.7 according to (Von Caemmerer, 2000) but it can be modified to 0.9 as in (Su et al., 2009). The larger it is, the lower the smoothing.</p><p>α is taken at 0.425 as proposed in von Caemmerer et al. (2009) eq. 9.16, where α = (1-f)/2.</p><p>Medlyn et al. (2002) found relatively low influence (&quot;a slight effect&quot;) of α and θ. They also say that Kc, Ko and Γ* &quot;are thought to be intrinsic properties of the Rubisco enzyme and are generally assumed constant among species&quot;.</p><p><strong>See also</strong></p><ul><li><a href="../models/photosynthesis/#FvcbRaw"><code>FvcbRaw</code></a> for non-coupled model, directly from Farquhar et al. (1980)</li><li><a href="../models/photosynthesis/#FvcbIter"><code>FvcbIter</code></a> for the coupled assimilation / conductance model with an iterative resolution</li><li><a href="#PlantBiophysics.get_J-NTuple{4, Any}"><code>get_J</code></a></li><li><a href="#PlantBiophysics.AbstractPhotosynthesisModel"><code>AbstractPhotosynthesisModel</code></a></li></ul><p><strong>References</strong></p><p>Caemmerer, S. von, et G. D. Farquhar. 1981. « Some Relationships between the Biochemistry of Photosynthesis and the Gas Exchange of Leaves ». Planta 153 (4): 376‑87. https://doi.org/10.1007/BF00384257.</p><p>Farquhar, G. D., S. von von Caemmerer, et J. A. Berry. 1980. « A biochemical model of photosynthetic CO2 assimilation in leaves of C3 species ». Planta 149 (1): 78‑90.</p><p>Medlyn, B. E., E. Dreyer, D. Ellsworth, M. Forstreuter, P. C. Harley, M. U. F. Kirschbaum, X. Le Roux, et al. 2002. « Temperature response of parameters of a biochemically based model of photosynthesis. II. A review of experimental data ». Plant, Cell &amp; Environment 25 (9): 1167‑79. https://doi.org/10.1046/j.1365-3040.2002.00891.x.</p><p>Su, Y., Zhu, G., Miao, Z., Feng, Q. and Chang, Z. 2009. « Estimation of parameters of a biochemically based model of photosynthesis using a genetic algorithm ». Plant, Cell &amp; Environment, 32: 1710-1723. https://doi.org/10.1111/j.1365-3040.2009.02036.x.</p><p>Von Caemmerer, Susanna. 2000. Biochemical models of leaf photosynthesis. Csiro publishing.</p><p>Duursma, R. A. 2015. « Plantecophys - An R Package for Analysing and Modelling Leaf Gas Exchange Data ». PLoS ONE 10(11): e0143346. https://doi:10.1371/journal.pone.0143346.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">Get the fieldnames:
fieldnames(Fvcb)
# Using default values for the model:
A = Fvcb()

A.Eₐᵥ</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/photosynthesis/FvCB.jl#LL40-L90">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.FvcbIter" href="#PlantBiophysics.FvcbIter"><code>PlantBiophysics.FvcbIter</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Farquhar–von Caemmerer–Berry (FvCB) model for C3 photosynthesis (Farquhar et al., 1980; von Caemmerer and Farquhar, 1981).</p><p>Iterative implementation, <em>i.e.</em> the assimilation is computed iteratively over Cᵢ.</p><p><strong>Parameters</strong></p><ul><li><code>Tᵣ</code>: the reference temperature (°C) at which other parameters were measured</li><li><code>VcMaxRef</code>: maximum rate of Rubisco activity (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>JMaxRef</code>: potential rate of electron transport (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>RdRef</code>: mitochondrial respiration in the light at reference temperature (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>TPURef</code>: triose phosphate utilization-limited photosynthesis rate (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>Eₐᵣ</code>: activation energy (<span>$J\ mol^{-1}$</span>), or the exponential rate of rise for Rd.</li><li><code>O₂</code>: intercellular dioxygen concentration (<span>$ppm$</span>)</li><li><code>Eₐⱼ</code>: activation energy (<span>$J\ mol^{-1}$</span>), or the exponential rate of rise for JMax.</li><li><code>Hdⱼ</code>: rate of decrease of the function above the optimum (also called EDVJ) for JMax.</li><li><code>Δₛⱼ</code>: entropy factor for JMax.</li><li><code>Eₐᵥ</code>: activation energy (<span>$J\ mol^{-1}$</span>), or the exponential rate of rise for VcMax.</li><li><code>Hdᵥ</code>: rate of decrease of the function above the optimum (also called EDVC) for VcMax.</li><li><code>Δₛᵥ</code>: entropy factor for VcMax.</li><li><code>α</code>: quantum yield of electron transport (<span>$mol_e\ mol^{-1}_{quanta}$</span>). See also eq. 4 of</li></ul><p>Medlyn et al. (2002), equation 9.16 from von Caemmerer et al. (2009) ((1-f)/2) and its implementation in <a href="#PlantBiophysics.get_J-NTuple{4, Any}"><code>get_J</code></a></p><ul><li><code>θ</code>: determines the curvature of the light response curve for <code>J~aPPFD</code>. See also eq. 4 of</li></ul><p>Medlyn et al. (2002) and its implementation in <a href="#PlantBiophysics.get_J-NTuple{4, Any}"><code>get_J</code></a></p><ul><li><code>iter_A_max::Int</code>: maximum number of iterations allowed for the iteration on the assimilation.</li><li><code>ΔT_A::T = 1</code>: threshold bellow which the assimilation is considered constant. Given in</li></ul><p>percent of change, <em>i.e.</em> 1% means that two successive assimilations with less than 1% difference in value are considered the same value.</p><p><strong>Note on parameters</strong></p><p>The default values of the temperature correction parameters are taken from <a href="https://remkoduursma.github.io/plantecophys/">plantecophys</a>. If there is no negative effect of high temperatures on the reaction (Jmax or VcMax), then Δₛ can be set to 0.0.</p><p>θ is taken at 0.7 according to (Von Caemmerer, 2000) but it can be modified to 0.9 as in (Su et al., 2009). The larger it is, the lower the smoothing.</p><p>α is taken at 0.425 as proposed in von Caemmerer et al. (2009) eq. 9.16, where α = (1-f)/2.</p><p>Medlyn et al. (2002) found relatively low influence (&quot;a slight effect&quot;) of α and θ. They also say that Kc, Ko and Γ* &quot;are thought to be intrinsic properties of the Rubisco enzyme and are generally assumed constant among species&quot;.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/photosynthesis/FvCBIter.jl#LL2-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.FvcbRaw" href="#PlantBiophysics.FvcbRaw"><code>PlantBiophysics.FvcbRaw</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Farquhar–von Caemmerer–Berry (FvCB) model for C3 photosynthesis (Farquhar et al., 1980; von Caemmerer and Farquhar, 1981). Direct implementation of the model.</p><p><strong>Parameters</strong></p><ul><li><code>Tᵣ</code>: the reference temperature (°C) at which other parameters were measured</li><li><code>VcMaxRef</code>: maximum rate of Rubisco activity (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>JMaxRef</code>: potential rate of electron transport (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>RdRef</code>: mitochondrial respiration in the light at reference temperature (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>TPURef</code>: triose phosphate utilization-limited photosynthesis rate (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>Eₐᵣ</code>: activation energy (<span>$J\ mol^{-1}$</span>), or the exponential rate of rise for Rd.</li><li><code>O₂</code>: intercellular dioxygen concentration (<span>$ppm$</span>)</li><li><code>Eₐⱼ</code>: activation energy (<span>$J\ mol^{-1}$</span>), or the exponential rate of rise for JMax.</li><li><code>Hdⱼ</code>: rate of decrease of the function above the optimum (also called EDVJ) for JMax.</li><li><code>Δₛⱼ</code>: entropy factor for JMax.</li><li><code>Eₐᵥ</code>: activation energy (<span>$J\ mol^{-1}$</span>), or the exponential rate of rise for VcMax.</li><li><code>Hdᵥ</code>: rate of decrease of the function above the optimum (also called EDVC) for VcMax.</li><li><code>Δₛᵥ</code>: entropy factor for VcMax.</li><li><code>α</code>: quantum yield of electron transport (<span>$mol_e\ mol^{-1}_{quanta}$</span>). See also eq. 4 of</li></ul><p>Medlyn et al. (2002), equation 9.16 from von Caemmerer et al. (2009) ((1-f)/2) and its implementation in <a href="#PlantBiophysics.get_J-NTuple{4, Any}"><code>get_J</code></a></p><ul><li><code>θ</code>: determines the curvature of the light response curve for <code>J~aPPFD</code>. See also eq. 4 of</li></ul><p>Medlyn et al. (2002) and its implementation in <a href="#PlantBiophysics.get_J-NTuple{4, Any}"><code>get_J</code></a></p><p><strong>See also</strong></p><ul><li><a href="../models/photosynthesis/#Fvcb"><code>Fvcb</code></a> for the coupled assimilation / conductance model</li><li><a href="../models/photosynthesis/#FvcbIter"><code>FvcbIter</code></a> for the coupled assimilation / conductance model with an iterative resolution</li><li><a href="#PlantBiophysics.get_J-NTuple{4, Any}"><code>get_J</code></a></li><li><a href="#PlantBiophysics.AbstractPhotosynthesisModel"><code>AbstractPhotosynthesisModel</code></a></li></ul><p><strong>References</strong></p><p>Caemmerer, S. von, et G. D. Farquhar. 1981. « Some Relationships between the Biochemistry of Photosynthesis and the Gas Exchange of Leaves ». Planta 153 (4): 376‑87. https://doi.org/10.1007/BF00384257.</p><p>Farquhar, G. D., S. von von Caemmerer, et J. A. Berry. 1980. « A biochemical model of photosynthetic CO2 assimilation in leaves of C3 species ». Planta 149 (1): 78‑90.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">Get the fieldnames:
fieldnames(FvcbRaw)
# Using default values for the model:
A = FvcbRaw()

A.Eₐᵥ</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/photosynthesis/FvCBRaw.jl#LL2-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.LightIgnore" href="#PlantBiophysics.LightIgnore"><code>PlantBiophysics.LightIgnore</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Ignore model for light interception, see <a href="https://archimed-platform.github.io/archimed-phys-user-doc/3-inputs/5-models/2-models_list/">here</a>. Make the mesh invisible, and not computed. Can save a lot of time for the computations when there are components types that are not visible anyway (e.g. inside others).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/light/Ignore.jl#LL1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.Medlyn" href="#PlantBiophysics.Medlyn"><code>PlantBiophysics.Medlyn</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Medlyn et al. (2011) stomatal conductance model for CO₂.</p><p><strong>Arguments</strong></p><ul><li><code>g0</code>: intercept.</li><li><code>g1</code>: slope.</li><li><code>gs_min = 0.001</code>: residual conductance. We consider the residual conductance being different   from <code>g0</code> because in practice <code>g0</code> can be negative when fitting real-world data.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantMeteo, PlantSimEngine, PlantBiophysics
meteo = Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)

leaf =
    ModelList(
        stomatal_conductance = Medlyn(0.03, 12.0),
        status = (A = A, Cₛ = 380.0, Dₗ = meteo.VPD)
    )
run!(leaf,meteo)</code></pre><p>Note that we use <code>VPD</code> as an approximation of <code>Dₗ</code> here because we don&#39;t have the leaf temperature (<em>i.e.</em> <code>Dₗ = VPD</code> when <code>Tₗ = T</code>).</p><p><strong>References</strong></p><p>Medlyn, Belinda E., Remko A. Duursma, Derek Eamus, David S. Ellsworth, I. Colin Prentice, Craig V. M. Barton, Kristine Y. Crous, Paolo De Angelis, Michael Freeman, et Lisa Wingate.</p><ol><li>« Reconciling the optimal and empirical approaches to modelling stomatal conductance ».</li></ol><p>Global Change Biology 17 (6): 2134‑44. https://doi.org/10.1111/j.1365-2486.2010.02375.x.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/conductances/stomatal/medlyn.jl#LL1-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.Monteith" href="#PlantBiophysics.Monteith"><code>PlantBiophysics.Monteith</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Struct to hold parameter and values for the energy model close to the one in Monteith and Unsworth (2013)</p><p><strong>Arguments</strong></p><ul><li><code>aₛₕ = 2</code>: number of faces of the object that exchange sensible heat fluxes</li><li><code>aₛᵥ = 1</code>: number of faces of the object that exchange latent heat fluxes (hypostomatous =&gt; 1)</li><li><code>ε = 0.955</code>: emissivity of the object</li><li><code>maxiter = 10</code>: maximal number of iterations allowed to close the energy balance</li><li><code>ΔT = 0.01</code> (°C): maximum difference in object temperature between two iterations to consider convergence</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">energy_model = Monteith() # a leaf in an illuminated chamber</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/energy/Monteith.jl#LL1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.OpticalProperties" href="#PlantBiophysics.OpticalProperties"><code>PlantBiophysics.OpticalProperties</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Optical properties abstract struct</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/light/Translucent.jl#LL1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.Translucent" href="#PlantBiophysics.Translucent"><code>PlantBiophysics.Translucent</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Translucent model for light interception, see <a href="https://archimed-platform.github.io/archimed-phys-user-doc//3-inputs/5-models/2-models_list/">here</a>. This model is not yet implemented in PlantBiophysics, so it takes the values from the MTG nodes, which means all nodes with the model should provide the necessary attributes:</p><ul><li><code>Ra_SW_f</code> the absorbed flux of atmospheric radiation in the short wave bandwidth (PAR+NIR), in W m[object]⁻² (== J m[object]⁻² s⁻¹).</li><li><code>Ra_PAR_f</code> the absorbed flux of atmospheric radiation in the PAR bandwidth, in W m[object]⁻² (== J m[object]⁻² s⁻¹).</li><li><code>sky_fraction</code> the sky fraction seen by the the node, in [0, 1].</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/light/Translucent.jl#LL18-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.σ" href="#PlantBiophysics.σ"><code>PlantBiophysics.σ</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">σ()</code></pre><p>σ, the scattering factor of a component. See <a href="https://archimed-platform.github.io/archimed-phys-user-doc/3-inputs/5-models/2-models_list/#translucent">here</a> for more details</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/light/Translucent.jl#LL6-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.Fvcb_net_assimiliation-NTuple{7, Any}" href="#PlantBiophysics.Fvcb_net_assimiliation-NTuple{7, Any}"><code>PlantBiophysics.Fvcb_net_assimiliation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Fvcb_net_assimiliation(Cᵢ,Vⱼ,Γˢ,VcMax,Km,Rd)</code></pre><p>Net assimilation following the Farquhar–von Caemmerer–Berry (FvCB) model for C3 photosynthesis (Farquhar et al., 1980; von Caemmerer and Farquhar, 1981)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/photosynthesis/FvCBIter.jl#LL210-L215">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.arrhenius" href="#PlantBiophysics.arrhenius"><code>PlantBiophysics.arrhenius</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">arrhenius(A,Eₐ,Tₖ,Tᵣₖ,R = PlantMeteo.Constants().R)</code></pre><p>The Arrhenius function for dependence of the rate constant of a chemical reaction.</p><p><strong>Arguments</strong></p><ul><li><code>A</code>: pre-exponential factor, a constant for each chemical reaction</li><li><code>Eₐ</code>: activation energy for the reaction (<span>$J\ mol^{-1}$</span>)</li><li><code>Tₖ</code>: temperature (Kelvin)</li><li><code>Tᵣₖ</code>: reference temperature (Kelvin) at which A was measured</li><li><code>R</code>: universal gas constant (<span>$J\ mol^{-1}\ K^{-1}$</span>)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantBiophysics, PlantMeteo
# Importing physical constants
constants = PlantMeteo.Constants()
# Using default values for the model:
A = Fvcb()

# Computing Jmax:
arrhenius(A.JMaxRef,A.Eₐⱼ,28.0-constants.K₀,A.Tᵣ-constants.K₀,constants.R)
# ! Warning: temperatures must be given in Kelvin

# Computing Vcmax:
arrhenius(A.VcMaxRef,A.Eₐᵥ,28.0-constants.K₀,A.Tᵣ-constants.K₀,constants.R)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/photosynthesis/temperature-dependence.jl#LL1-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.arrhenius" href="#PlantBiophysics.arrhenius"><code>PlantBiophysics.arrhenius</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">arrhenius(A,Eₐ,Tₖ,Tᵣₖ,Hd,Δₛ,R = Constants().R)</code></pre><p>The Arrhenius function for dependence of the rate constant of a chemical reaction, modified following equation (17) from Medlyn et al. (2002) to consider the negative effect of very high temperatures.</p><p><strong>Arguments</strong></p><ul><li><code>A</code>: the pre-exponential factor, a constant for each chemical reaction</li><li><code>Eₐ</code>: activation energy (<span>$J\ mol^{-1}$</span>), or the exponential rate of rise</li></ul><p>of the function (Ha in the equation of Medlyn et al. (2002))</p><ul><li><code>Tₖ</code>: current temperature (Kelvin)</li><li><code>Tᵣₖ</code>: reference temperature (Kelvin) at which A was measured</li><li><code>Hd</code>: rate of decrease of the function above the optimum (called EDVJ in</li></ul><p><a href="http://maespa.github.io/">MAESPA</a> and <a href="https://remkoduursma.github.io/plantecophys/">plantecophys</a>)</p><ul><li><code>Δₛ</code>: entropy factor</li><li><code>R</code>: is the universal gas constant (<span>$J\ mol^{-1}\ K^{-1}$</span>)</li></ul><p>References</p><p>Medlyn, B. E., E. Dreyer, D. Ellsworth, M. Forstreuter, P. C. Harley, M. U. F. Kirschbaum, X. Le Roux, et al. 2002. « Temperature response of parameters of a biochemically based model of photosynthesis. II. A review of experimental data ». Plant, Cell &amp; Environment 25 (9): 1167‑79. https://doi.org/10.1046/j.1365-3040.2002.00891.x.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantBiophysics, PlantMeteo
# Importing physical constants
constants = Constants()
# Using default values for the model:
A = Fvcb()

# Computing Jmax:
PlantBiophysics.arrhenius(A.JMaxRef,A.Eₐⱼ,28.0-constants.K₀,A.Tᵣ-constants.K₀,A.Hdⱼ,A.Δₛⱼ)
# ! Warning: temperatures must be given in Kelvin

# Computing Vcmax:
PlantBiophysics.arrhenius(A.VcMaxRef,A.Eₐᵥ,28.0-constants.K₀,A.Tᵣ-constants.K₀,A.Hdᵥ,A.Δₛᵥ)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/photosynthesis/temperature-dependence.jl#LL36-L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.black_body-Tuple{Any, Any, Any}" href="#PlantBiophysics.black_body-Tuple{Any, Any, Any}"><code>PlantBiophysics.black_body</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">black_body(T, K₀, σ)
black_body(T)</code></pre><p>Thermal infrared, <em>i.e.</em> longwave radiation emitted from a black body at temperature T.</p><ul><li><code>T</code>: temperature of the object in Celsius degree</li><li><code>K₀</code>: absolute zero (°C)</li><li><code>σ</code> (<span>$W\ m^{-2}\ K^{-4}$</span>) <a href="https://en.wikipedia.org/wiki/Stefan%E2%80%93Boltzmann_law">Stefan-Boltzmann constant</a></li></ul><p><strong>Note</strong></p><p><code>K₀</code> and <code>σ</code> are taken from <code>PlantMeteo.Constants</code> if not provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/energy/longwave_energy.jl#LL1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.gbh_to_gbw" href="#PlantBiophysics.gbh_to_gbw"><code>PlantBiophysics.gbh_to_gbw</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gbh_to_gbw(gbh, Gbₕ_to_Gbₕ₂ₒ = PlantMeteo.Constants().Gbₕ_to_Gbₕ₂ₒ)
gbw_to_gbh(gbh, Gbₕ_to_Gbₕ₂ₒ = PlantMeteo.Constants().Gbₕ_to_Gbₕ₂ₒ)</code></pre><p>Boundary layer conductance for water vapor from boundary layer conductance for heat.</p><p><strong>Arguments</strong></p><ul><li><code>gbh</code> (m s-1): boundary layer conductance for heat under mixed convection.</li><li><code>Gbₕ_to_Gbₕ₂ₒ</code>: conversion factor.</li></ul><p><strong>Note</strong></p><p>Gbₕ is the sum of free and forced convection. See <a href="#PlantBiophysics.gbₕ_free"><code>gbₕ_free</code></a> and <a href="#PlantBiophysics.gbₕ_forced-Tuple{Any, Any}"><code>gbₕ_forced</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/conversions.jl#LL69-L83">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.gbₕ_forced-Tuple{Any, Any}" href="#PlantBiophysics.gbₕ_forced-Tuple{Any, Any}"><code>PlantBiophysics.gbₕ_forced</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gbₕ_forced(Wind,d)</code></pre><p>Boundary layer conductance for heat under <strong>forced</strong> convection (m s-1). See eq. E1 from Leuning et al. (1995) for more details.</p><p><strong>Arguments</strong></p><ul><li><code>Wind</code> (m s-1): wind speed</li><li><code>d</code> (m): characteristic dimension, <em>e.g.</em> leaf width (see eq. 10.9 from Monteith and Unsworth, 2013).</li></ul><p><strong>Notes</strong></p><p><code>d</code> is the minimal dimension of the surface of an object in contact with the air.</p><p><strong>References</strong></p><p>Leuning, R., F. M. Kelliher, DGG de Pury, et E.-D. SCHULZE. 1995. « Leaf nitrogen, photosynthesis, conductance and transpiration: scaling from leaves to canopies ». Plant, Cell &amp; Environment 18 (10): 1183‑1200.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/conductances/boundary/gb.jl#LL45-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.gbₕ_free" href="#PlantBiophysics.gbₕ_free"><code>PlantBiophysics.gbₕ_free</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gbₕ_free(Tₐ,Tₗ,d,Dₕ₀)
gbₕ_free(Tₐ,Tₗ,d)</code></pre><p>Leaf boundary layer conductance for heat under <strong>free</strong> convection (m s-1).</p><p><strong>Arguments</strong></p><ul><li><code>Tₐ</code> (°C): air temperature</li><li><code>Tₗ</code> (°C): leaf temperature</li><li><code>d</code> (m): characteristic dimension, <em>e.g.</em> leaf width (see eq. 10.9 from Monteith and Unsworth, 2013).</li><li><code>Dₕ₀ = 21.5e-6</code>: molecular diffusivity for heat at base temperature. Use value from</li></ul><p><code>PlantMeteo.Constants</code> if not provided.</p><p><strong>Note</strong></p><p><code>R</code> and <code>Dₕ₀</code> can be found using <code>PlantMeteo.Constants</code>. To transform in <span>$mol\ m^{-2}\ s^{-1}$</span>, use <a href="#PlantBiophysics.ms_to_mol-NTuple{5, Any}"><code>ms_to_mol</code></a>.</p><p><strong>References</strong></p><p>Leuning, R., F. M. Kelliher, DGG de Pury, et E.-D. SCHULZE. 1995. « Leaf nitrogen, photosynthesis, conductance and transpiration: scaling from leaves to canopies ». Plant, Cell &amp; Environment 18 (10): 1183‑1200.</p><p>Monteith, John, et Mike Unsworth. 2013. Principles of environmental physics: plants, animals, and the atmosphere. Academic Press. Paragraph 10.1.3, eq. 10.9.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/conductances/boundary/gb.jl#LL1-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.get_Cᵢᵥ-NTuple{7, Any}" href="#PlantBiophysics.get_Cᵢᵥ-NTuple{7, Any}"><code>PlantBiophysics.get_Cᵢᵥ</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Analytic resolution of Cᵢ when the RuBisCo activity is limiting (<span>$μmol\ mol^{-1}$</span>)</p><p><strong>Arguments</strong></p><ul><li><code>VcMAX</code>: maximum rate of RuBisCo activity(<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>Γˢ</code>: CO2 compensation point <span>$Γ^⋆$</span> (<span>$μmol\ mol^{-1}$</span>)</li><li><code>Cₛ</code>: Air CO₂ concentration at the leaf surface (<span>$μmol\ mol^{-1}$</span>)</li><li><code>Rd</code>: day respiration (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>g0</code>: residual stomatal conductance (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>st_closure</code>: stomatal conductance term computed from a given implementation of a Gs model,</li></ul><p>e.g. <a href="../models/gs/#Medlyn"><code>Medlyn</code></a>.</p><ul><li><code>Km</code>: effective Michaelis–Menten coefficient for CO2 (<span>$μ mol\ mol^{-1}$</span>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/photosynthesis/FvCB.jl#LL387-L400">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.get_Cᵢⱼ-NTuple{6, Any}" href="#PlantBiophysics.get_Cᵢⱼ-NTuple{6, Any}"><code>PlantBiophysics.get_Cᵢⱼ</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Analytic resolution of Cᵢ when the rate of electron transport is limiting (<span>$μmol\ mol^{-1}$</span>)</p><p><strong>Arguments</strong></p><ul><li><code>Vⱼ</code>: RuBP regeneration (J/4.0, <span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>Γˢ</code>: CO2 compensation point <span>$Γ^⋆$</span> (<span>$μmol\ mol^{-1}$</span>)</li><li><code>Cₛ</code>: Air CO₂ concentration at the leaf surface (<span>$μmol\ mol^{-1}$</span>)</li><li><code>Rd</code>: day respiration (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>g0</code>: residual stomatal conductance (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>st_closure</code>: stomatal conductance term computed from a given implementation of a Gs model,</li></ul><p>e.g. <a href="../models/gs/#Medlyn"><code>Medlyn</code></a>.</p><p><strong>References</strong></p><p>Duursma, R. A., et B. E. Medlyn. 2012. « MAESPA: a model to study interactions between water limitation, environmental drivers and vegetation function at tree and stand levels, with an example application to [CO2] × drought interactions ». Geoscientific Model Development 5 (4): 919‑40. https://doi.org/10.5194/gmd-5-919-2012.</p><p>Wang and Leuning, 1998</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/photosynthesis/FvCB.jl#LL354-L376">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.get_Dₕ" href="#PlantBiophysics.get_Dₕ"><code>PlantBiophysics.get_Dₕ</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_Dₕ(T,Dₕ₀)
get_Dₕ(T)</code></pre><p>Dₕ -molecular diffusivity for heat at base temperature- from Dₕ₀ (corrected by temperature). See Monteith and Unsworth (2013, eq. 3.10).</p><p><strong>Arguments</strong></p><ul><li><code>Tₐ</code> (°C): temperature</li><li><code>Dₕ₀</code>: molecular diffusivity for heat at base temperature. Use value from <code>PlantMeteo.Constants</code></li></ul><p>if not provided.</p><p><strong>References</strong></p><p>Monteith, John, et Mike Unsworth. 2013. Principles of environmental physics: plants, animals, and the atmosphere. Academic Press. Paragraph 10.1.3.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/conductances/boundary/gb.jl#LL71-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.get_J-NTuple{4, Any}" href="#PlantBiophysics.get_J-NTuple{4, Any}"><code>PlantBiophysics.get_J</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Rate of electron transport J (<span>$μmol\ m^{-2}\ s^{-1}$</span>), computed using the smaller root of the quadratic equation (eq. 4 from Medlyn et al., 2002):</p><pre><code class="nohighlight hljs">θ * J² - (α * aPPFD + JMax) * J + α * aPPFD * JMax</code></pre><p>NB: we use the smaller root because considering the range of values for θ and α (quite stable), and aPPFD and JMax, the function always tends to JMax with high aPPFD with the smaller root (behavior we are searching), and the opposite with the larger root.</p><p><strong>Returns</strong></p><p>A tuple with (A, Gₛ, Cᵢ):</p><ul><li>A: carbon assimilation (μmol m-2 s-1)</li><li>Gₛ: stomatal conductance (mol m-2 s-1)</li><li>Cᵢ: intercellular CO₂ concentration (ppm)</li></ul><p><strong>Arguments</strong></p><ul><li><code>aPPFD</code>: absorbed photon irradiance (<span>$μmol_{quanta}\ m^{-2}\ s^{-1}$</span>)</li><li><code>α</code>: quantum yield of electron transport (<span>$mol_e\ mol^{-1}_{quanta}$</span>)</li><li><code>JMax</code>: maximum rate of electron transport (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>θ</code>: determines the shape of the non-rectangular hyperbola (-)</li></ul><p><strong>References</strong></p><p>Medlyn, B. E., E. Dreyer, D. Ellsworth, M. Forstreuter, P. C. Harley, M. U. F. Kirschbaum, X. Le Roux, et al. 2002. « Temperature response of parameters of a biochemically based model of photosynthesis. II. A review of experimental data ». Plant, Cell &amp; Environment 25 (9): 1167‑79. https://doi.org/10.1046/j.1365-3040.2002.00891.x.</p><p>Von Caemmerer, Susanna. 2000. Biochemical models of leaf photosynthesis. Csiro publishing.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs"># Using default values for the model:
julia&gt; A = Fvcb()
Fvcb{Float64}(25.0, 200.0, 250.0, 0.6, 9999.0, 46390.0, 210.0, 29680.0, 200000.0, 631.88, 58550.0, 200000.0, 629.26, 0.425, 0.7)

julia&gt; PlantBiophysics.get_J(1500, A.JMaxRef, A.α, A.θ)
216.5715752671342</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/photosynthesis/FvCB.jl#LL306-L349">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.get_km" href="#PlantBiophysics.get_km"><code>PlantBiophysics.get_km</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Compute the effective Michaelis–Menten coefficient for CO2 <span>$Km$</span> (<span>$μ mol\ mol^{-1}$</span>) according to Medlyn et al. (2002), equations (5) and (6).</p><p><strong>References</strong></p><p>Medlyn, B. E., E. Dreyer, D. Ellsworth, M. Forstreuter, P. C. Harley, M. U. F. Kirschbaum, X. Le Roux, et al. 2002. « Temperature response of parameters of a biochemically based model of photosynthesis. II. A review of experimental data ». Plant, Cell &amp; Environment 25 (9): 1167‑79. https://doi.org/10.1046/j.1365-3040.2002.00891.x.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># computing the temperature dependence of γˢ:
get_km(28,25,210.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/photosynthesis/temperature-dependence.jl#LL142-L161">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.get_model-Tuple{Any, Any}" href="#PlantBiophysics.get_model-Tuple{Any, Any}"><code>PlantBiophysics.get_model</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_model(x)</code></pre><p>Return the model (the actual struct) given its name passed as a String.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/io/read_model.jl#LL91-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.get_process-Tuple{Any}" href="#PlantBiophysics.get_process-Tuple{Any}"><code>PlantBiophysics.get_process</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_process(x)</code></pre><p>Return the process type (the actual struct) given its name passed as a String.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/io/read_model.jl#LL66-L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.grey_body-NTuple{4, Any}" href="#PlantBiophysics.grey_body-NTuple{4, Any}"><code>PlantBiophysics.grey_body</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Thermal infrared, <em>i.e.</em> longwave radiation emitted from an object at temperature T.</p><ul><li><code>T</code>: temperature of the object in Celsius degree</li><li><code>ε</code> object <a href="https://en.wikipedia.org/wiki/Emissivity">emissivity</a> (not to confuse with ε the</li></ul><p>ratio of molecular weights from <code>PlantMeteo.Constants</code>). A typical value for a leaf is 0.955.</p><ul><li><code>K₀</code>: absolute zero (°C)</li><li><code>σ</code> (<span>$W\ m^{-2}\ K^{-4}$</span>) <a href="https://en.wikipedia.org/wiki/Stefan%E2%80%93Boltzmann_law">Stefan-Boltzmann constant</a></li></ul><p><strong>Note</strong></p><p><code>K₀</code> and <code>σ</code> are taken from <code>PlantMeteo.Constants</code> if not provided.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Thermal infrared radiation of water at 25 °C:
grey_body(25.0, 0.96)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/energy/longwave_energy.jl#LL27-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.gs_closure" href="#PlantBiophysics.gs_closure"><code>PlantBiophysics.gs_closure</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gs_closure(::Medlyn, models, status, meteo, constants=nothing, extra=nothing)</code></pre><p>Stomatal closure for CO₂ according to Medlyn et al. (2011). Carefull, this is just a part of the computation of the stomatal conductance.</p><p>The result of this function is then used as:</p><pre><code class="nohighlight hljs">gs_mod = gs_closure(leaf,meteo)

# And then stomatal conductance (μmol m-2 s-1) calling [`stomatal_conductance`](@ref):
Gₛ = leaf.stomatal_conductance.g0 + gs_mod * leaf.status.A</code></pre><p><strong>Arguments</strong></p><ul><li><code>::Medlyn</code>: an instance of the <code>Medlyn</code> model type</li><li><code>models::ModelList</code>: A <code>ModelList</code> struct holding the parameters for the models.</li><li><code>status</code>: A status struct holding the variables for the models.</li><li><code>meteo</code>: meteorology structure, see <a href="https://palmstudio.github.io/PlantMeteo.jl/stable/#PlantMeteo.Atmosphere"><code>Atmosphere</code></a>. Is not used in this model.</li><li><code>constants</code>: A constants struct holding the constants for the models. Is not used in this model.</li><li><code>extra</code>: A struct holding the extra variables for the models. Is not used in this model.</li></ul><p><strong>Details</strong></p><p>Use <code>variables()</code> on Medlyn to get the variables that must be instantiated in the <code>ModelList</code> struct.</p><p><strong>Notes</strong></p><ul><li><code>Cₛ</code> is used instead of <code>Cₐ</code> because Gₛ is between the surface and the intercellular space. The conductance</li></ul><p>between the atmosphere and the surface is accounted for using the boundary layer conductance (<code>Gbc</code> in <a href="../models/energy_balance/#Monteith"><code>Monteith</code></a>). Medlyn et al. (2011) uses <code>Cₐ</code> in their paper because they relate their models to the measurements made at leaf level, with a well-mixed chamber where<code>Cₛ ≈ Cₐ</code>.</p><ul><li><code>Dₗ</code> is forced to be &gt;= 1e-9 because it is used in a squared root. It is prefectly acceptable to</li></ul><p>get a negative Dₗ when leaves are re-hydrating from air. Cloud forests are the perfect example. See <em>e.g.</em>: Guzmán‐Delgado, P, Laca, E, Zwieniecki, MA. Unravelling foliar water uptake pathways: The contribution of stomata and the cuticle. Plant Cell Environ. 2021; 1– 13. https://doi.org/10.1111/pce.14041</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">meteo = Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)

leaf =
    ModelList(
        stomatal_conductance = Medlyn(0.03, 12.0),
        status = (Cₛ = 380.0, Dₗ = meteo.VPD)
    )

gs_mod = gs_closure(leaf, meteo)

A = 20 # example assimilation (μmol m-2 s-1)
Gs = leaf.stomatal_conductance.g0 + gs_mod * A

# Or more directly using `run!()`:

leaf =
    ModelList(
        stomatal_conductance = Medlyn(0.03, 12.0),
        status = (A = A, Cₛ = 380.0, Dₗ = meteo.VPD)
    )
run!(leaf,meteo)</code></pre><p>Note that we use <code>VPD</code> as an approximation of <code>Dₗ</code> here because we don&#39;t have the leaf temperature (<em>i.e.</em> <code>Dₗ = VPD</code> when <code>Tₗ = T</code>).</p><p><strong>References</strong></p><p>Medlyn, Belinda E., Remko A. Duursma, Derek Eamus, David S. Ellsworth, I. Colin Prentice, Craig V. M. Barton, Kristine Y. Crous, Paolo De Angelis, Michael Freeman, et Lisa Wingate.</p><ol><li>« Reconciling the optimal and empirical approaches to modelling stomatal conductance ».</li></ol><p>Global Change Biology 17 (6): 2134‑44. https://doi.org/10.1111/j.1365-2486.2010.02375.x.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/conductances/stomatal/medlyn.jl#LL59-L132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.gs_closure" href="#PlantBiophysics.gs_closure"><code>PlantBiophysics.gs_closure</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Constant stomatal closure. Usually called from a photosynthesis model.</p><p><strong>Note</strong></p><p><code>meteo</code> is just declared here for compatibility with other formats of calls.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/conductances/stomatal/constantGs.jl#LL34-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.gsc_to_gsw" href="#PlantBiophysics.gsc_to_gsw"><code>PlantBiophysics.gsc_to_gsw</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gsc_to_gsw(Gₛ, Gsc_to_Gsw = PlantMeteo.Constants().Gsc_to_Gsw)</code></pre><p>Conversion of a stomatal conductance for CO₂ into stomatal conductance for H₂O.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/conversions.jl#LL93-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.gsw_to_gsc" href="#PlantBiophysics.gsw_to_gsc"><code>PlantBiophysics.gsw_to_gsc</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gsw_to_gsc(Gₛ, Gsc_to_Gsw = PlantMeteo.Constants().Gsc_to_Gsw)</code></pre><p>Conversion of a stomatal conductance for H₂O into stomatal conductance for CO₂.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/conversions.jl#LL102-L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.instantiate-NTuple{4, Any}" href="#PlantBiophysics.instantiate-NTuple{4, Any}"><code>PlantBiophysics.instantiate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">instantiate(x)</code></pre><p>Instantiate a model given its parameter names, considering that parameter names can be different compared to the model fields (used to insure compatibility with Archimed).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/io/read_model.jl#LL119-L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.is_model-Tuple{Any}" href="#PlantBiophysics.is_model-Tuple{Any}"><code>PlantBiophysics.is_model</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">is_model(model)</code></pre><p>Check if a model object has the&quot;Group&quot; and &quot;Type&quot; keys as the first level of a Dict type object. But the function is generic as long as the input struct has a <code>keys()</code> method.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">models = read_model(&quot;path_to_a_model_file.yaml&quot;)
is_model(models)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/io/read_model.jl#LL206-L218">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.latent_heat-NTuple{8, Any}" href="#PlantBiophysics.latent_heat-NTuple{8, Any}"><code>PlantBiophysics.latent_heat</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">latent_heat(Rn, VPD, γˢ, Rbₕ, Δ, ρ, aₛₕ, Cₚ)
latent_heat(Rn, VPD, γˢ, Rbₕ, Δ, ρ, aₛₕ)</code></pre><p>λE -the latent heat flux (W m-2)- using the Monteith and Unsworth (2013) definition corrected by Schymanski et al. (2017), eq.22.</p><ul><li><code>Rn</code> (W m-2): net radiation. Carefull: not the isothermal net radiation</li><li><code>VPD</code> (kPa): air vapor pressure deficit</li><li><code>γˢ</code> (kPa K−1): apparent value of psychrometer constant (see <code>PlantMeteo.γ_star</code>)</li><li><code>Rbₕ</code> (s m-1): resistance for heat transfer by convection, i.e. resistance to sensible heat</li><li><code>Δ</code> (KPa K-1): rate of change of saturation vapor pressure with temperature (see <code>PlantMeteo.e_sat_slope</code>)</li><li><code>ρ</code> (kg m-3): air density of moist air.</li><li><code>aₛₕ</code> (1,2): number of sides that exchange energy for heat (2 for leaves)</li><li><code>Cₚ</code> (J K-1 kg-1): specific heat of air for constant pressure</li></ul><p><strong>References</strong></p><p>Monteith, J. and Unsworth, M., 2013. Principles of environmental physics: plants, animals, and the atmosphere. Academic Press. See eq. 13.33.</p><p>Schymanski et al. (2017), Leaf-scale experiments reveal an important omission in the Penman–Monteith equation, Hydrology and Earth System Sciences. DOI: https://doi.org/10.5194/hess-21-685-2017. See equ. 22.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">Tₐ = 20.0 ; P = 100.0 ;
ρ = air_density(Tₐ, P) # in kg m-3
Δ = e_sat_slope(Tₐ)

latent_heat(300.0, 2.0, 0.1461683, 50.0, Δ, ρ, 2.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/energy/Monteith.jl#LL233-L265">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.mol_to_ms-NTuple{5, Any}" href="#PlantBiophysics.mol_to_ms-NTuple{5, Any}"><code>PlantBiophysics.mol_to_ms</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ms_to_mol(G,T,P,R,K₀)
ms_to_mol(G,T,P)</code></pre><p>Conversion of a conductance <code>G</code> from <span>$mol\ m^{-2}\ s^{-1}$</span> to <span>$m\ s^{-1}$</span>.</p><p><strong>Arguments</strong></p><ul><li><code>G</code> (<span>$m\ s^{-1}$</span>): conductance</li><li><code>T</code> (°C): air temperature</li><li><code>P</code> (kPa): air pressure</li><li><code>R</code> (<span>$J\ mol^{-1}\ K^{-1}$</span>): universal gas constant.</li><li><code>K₀</code> (°C): absolute zero</li></ul><p><strong>See also</strong></p><p><a href="#PlantBiophysics.ms_to_mol-NTuple{5, Any}"><code>ms_to_mol</code></a> for the inverse process.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/conversions.jl#LL28-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.ms_to_mol-NTuple{5, Any}" href="#PlantBiophysics.ms_to_mol-NTuple{5, Any}"><code>PlantBiophysics.ms_to_mol</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ms_to_mol(G,T,P,R,K₀)
ms_to_mol(G,T,P)</code></pre><p>Conversion of a conductance <code>G</code> from <span>$m\ s^{-1}$</span> to <span>$mol\ m^{-2}\ s^{-1}$</span>.</p><p><strong>Arguments</strong></p><ul><li><code>G</code> (<span>$m\ s^{-1}$</span>): conductance</li><li><code>T</code> (°C): air temperature</li><li><code>P</code> (kPa): air pressure</li><li><code>R</code> (<span>$J\ mol^{-1}\ K^{-1}$</span>): universal gas constant.</li><li><code>K₀</code> (°C): absolute zero</li></ul><p><strong>See also</strong></p><p><a href="#PlantBiophysics.mol_to_ms-NTuple{5, Any}"><code>mol_to_ms</code></a> for the inverse process.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/conversions.jl#LL1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.net_longwave_radiation-NTuple{7, Any}" href="#PlantBiophysics.net_longwave_radiation-NTuple{7, Any}"><code>PlantBiophysics.net_longwave_radiation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">net_longwave_radiation(T₁,T₂,ε₁,ε₂,F₁,K₀,σ)
net_longwave_radiation(T₁,T₂,ε₁,ε₂,F₁)</code></pre><p>Net longwave radiation fluxes (<em>i.e.</em> thermal radiation, W m-2) between an object and another. The object of interest is at temperature T₁ and has an emissivity ε₁, and the object with which it exchanges energy is at temperature T₂ and has an emissivity ε₂.</p><p>If the result is positive, then the object of interest gain energy.</p><p><strong>Arguments</strong></p><ul><li><code>T₁</code> (Celsius degree): temperature of the target object (object 1)</li><li><code>T₂</code> (Celsius degree): temperature of the object with which there is potential exchange (object 2)</li><li><code>ε₁</code>: object 1 emissivity</li><li><code>ε₂</code>: object 2 emissivity</li><li><code>F₁</code>: view factor (0-1), <em>i.e.</em> visible fraction of object 2 from object 1 (see note)</li><li><code>K₀</code>: absolute zero (°C)</li><li><code>σ</code> (<span>$W\ m^{-2}\ K^{-4}$</span>) <a href="https://en.wikipedia.org/wiki/Stefan%E2%80%93Boltzmann_law">Stefan-Boltzmann constant</a></li></ul><p><strong>Note</strong></p><p><code>F₁</code>, the view factor (also called shape factor) is a coefficient applied to the semi-hemisphere field of view of object 1 that &quot;sees&quot; object 2. E.g. a leaf can be viewed as a plane. If one side of the leaf sees only object 2 in its field of view (e.g. the sky), then <code>F₁ = 1</code>. Then the net longwave radiation flux for this part of the leaf is multiplied by its actual surface to get the exchange. Note that we apply reciprocity between the two objects for the view factor (they have the same value), <em>i.e.</em>: A₁F₁₂ = A₂F₂₁.</p><p>Then, if we take a leaf as object 1, and the sky as object 2, the visible fraction of sky viewed by the leaf would be:</p><ul><li><code>0.5</code> if the leaf is on top of the canopy, <em>i.e.</em> the upper side of the leaf sees the sky,</li></ul><p>the side bellow sees other leaves and the soil.</p><ul><li>between 0 and 0.5 if it is within the canopy and partly shaded by other objects.</li></ul><p>Note that <code>A₁</code> for a leaf is twice its common used leaf area, because <code>A₁</code> is the <strong>total</strong> leaf area of the object that exchange energy.</p><pre><code class="language-julia hljs"># Net thermal radiation fluxes between a leaf and the sky considering the leaf at the top of
# the canopy:
Tₗ = 25.0 ; Tₐ = 20.0
ε₁ = 0.955 ; ε₂ = 1.0
Ra_LW_f = net_longwave_radiation(Tₗ,Tₐ,ε₁,ε₂,1.0)
Ra_LW_f

# Ra_LW_f is the net longwave radiation flux between the leaf and the atmosphere per surface area.
# To get the actual net longwave radiation flux we need to multiply by the surface of the
# leaf, e.g. for a leaf of 2cm²:
leaf_area = 2e-4 # in m²
Ra_LW_f * leaf_area

# The leaf lose ~0.0055 W towards the atmosphere.</code></pre><p><strong>References</strong></p><p>Cengel, Y, et Transfer Mass Heat. 2003. A practical approach. New York, NY, USA: McGraw-Hill.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/energy/longwave_energy.jl#LL57-L116">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.read_licor6400-Tuple{Any}" href="#PlantBiophysics.read_licor6400-Tuple{Any}"><code>PlantBiophysics.read_licor6400</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_licor6400(file; abs=0.85)</code></pre><p>Import Licor6400 data (such as Medlyn 2001 data) with the units and names corresponding to the ones used in PlantBiophysics.jl.</p><p><strong>Arguments</strong></p><ul><li><code>file</code>: a string or a vector of strings containing the path to the file(s) to read.</li><li><code>abs=0.85</code>: the absorptance of the leaf. Default is 0.85 (von Caemmerer et al., 2009).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/io/read_licor6400.jl#LL1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.read_model-Tuple{Any}" href="#PlantBiophysics.read_model-Tuple{Any}"><code>PlantBiophysics.read_model</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_model(file)</code></pre><p>Read a model file. The model file holds the choice and the parameterization of the models.</p><p><strong>Arguments</strong></p><ul><li><code>file::String</code>: path to a model file</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">file = joinpath(dirname(dirname(pathof(PlantBiophysics))), &quot;test&quot;, &quot;inputs&quot;, &quot;models&quot;, &quot;plant_coffee.yml&quot;)
models = read_model(file)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/io/read_model.jl#LL3-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.read_walz-Tuple{Any}" href="#PlantBiophysics.read_walz-Tuple{Any}"><code>PlantBiophysics.read_walz</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_walz(file; abs=0.85)</code></pre><p>Import a Walz GFS-3000 output file, perform variables conversion and rename according to package conventions.</p><p><strong>Arguments</strong></p><ul><li><code>file</code>: a string or a vector of strings containing the path to the file(s) to read.</li><li><code>abs=0.85</code>: the absorptance of the leaf. Default is 0.85 (von Caemmerer et al., 2009).</li></ul><p><strong>Returns</strong></p><p>A DataFrame containing the data read and transformed from the file(s). The units are the same than in the Walz output file,  except for:</p><ul><li>Dₗ: kPa</li><li>Rh: fraction (0-1)</li><li>VPD: kPa</li><li>Gₛ: mol[CO₂] m⁻² s⁻¹</li></ul><p><strong>Examples</strong></p><p>Reading one file:</p><pre><code class="language-julia hljs">file = joinpath(dirname(dirname(pathof(PlantBiophysics))),&quot;test&quot;,&quot;inputs&quot;,&quot;data&quot;,&quot;P1F20129.csv&quot;)
read_walz(file)</code></pre><p>We can also read multiple files at once:</p><pre><code class="language-julia hljs">files = readdir(joinpath(dirname(dirname(pathof(PlantBiophysics))),&quot;test&quot;,&quot;inputs&quot;,&quot;data&quot;), join = true)
df = read_walz(files)</code></pre><p>In this case, the source of the data is added as the <code>source</code> columns into the DataFrame:</p><pre><code class="language-julia hljs">df.source</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/io/read_walz.jl#LL1-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.sensible_heat-NTuple{8, Any}" href="#PlantBiophysics.sensible_heat-NTuple{8, Any}"><code>PlantBiophysics.sensible_heat</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">sensible_heat(Rn, VPD, γˢ, Rbₕ, Δ, ρ, aₛₕ, Cₚ)
sensible_heat(Rn, VPD, γˢ, Rbₕ, Δ, ρ, aₛₕ)</code></pre><p>H -the sensible heat flux (W m-2)- using the Monteith and Unsworth (2013) definition corrected by Schymanski et al. (2017), eq.22.</p><ul><li><code>Rn</code> (W m-2): net radiation. Carefull: not the isothermal net radiation</li><li><code>VPD</code> (kPa): air vapor pressure deficit</li><li><code>γˢ</code> (kPa K−1): apparent value of psychrometer constant (see <code>PlantMeteo.γ_star</code>)</li><li><code>Rbₕ</code> (s m-1): resistance for heat transfer by convection, i.e. resistance to sensible heat</li><li><code>Δ</code> (KPa K-1): rate of change of saturation vapor pressure with temperature (see <code>PlantMeteo.e_sat_slope</code>)</li><li><code>ρ</code> (kg m-3): air density of moist air.</li><li><code>aₛₕ</code> (1,2): number of sides that exchange energy for heat (2 for leaves)</li><li><code>Cₚ</code> (J K-1 kg-1): specific heat of air for constant pressure</li></ul><p><strong>References</strong></p><p>Monteith, J. and Unsworth, M., 2013. Principles of environmental physics: plants, animals, and the atmosphere. Academic Press. See eq. 13.33.</p><p>Schymanski et al. (2017), Leaf-scale experiments reveal an important omission in the Penman–Monteith equation, Hydrology and Earth System Sciences. DOI: https://doi.org/10.5194/hess-21-685-2017. See equ. 22.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">Tₐ = 20.0 ; P = 100.0 ;
ρ = air_density(Tₐ, P) # in kg m-3
Δ = PlantMeteo.e_sat_slope(Tₐ)

sensible_heat(300.0, 2.0, 0.1461683, 50.0, Δ, ρ, 2.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/energy/Monteith.jl#LL275-L307">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.Γ_star" href="#PlantBiophysics.Γ_star"><code>PlantBiophysics.Γ_star</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Γ_star(Tₖ,Tᵣₖ,R = PlantMeteo.Constants().R)</code></pre><p>CO₂ compensation point <span>$Γ^⋆$</span> (<span>$μ mol\ mol^{-1}$</span>) according to equation (12) from Medlyn et al. (2002).</p><blockquote><p><span>$Γ^⋆$</span> is the [CO₂] at which oxygenation proceeds at</p></blockquote><p>twice the rate of carboxylation causing photosynthetic uptake of CO2 to be exactly compensated by photorespiratory CO₂ release (Sharkey et al., 2007).</p><p><strong>Notes</strong></p><p>Could be replaced by equation (38) from Farquhar et al. (1980), but Medlyn et al. (2002) states that <span>$Γ^⋆$</span> as a relatively low effect on the model outputs.</p><p><strong>Arguments</strong></p><ul><li><code>Tₖ</code> (Kelvin): current temperature</li><li><code>Tᵣₖ</code> (Kelvin): reference temperature at which A was measured</li><li><code>R</code> (<span>$J\ mol^{-1}\ K^{-1}$</span>): is the universal gas constant</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantBiophysics, PlantMeteo
# Importing the physical constants:
constants = Constants()
# computing the temperature dependence of γˢ:
Γ_star(28-constants.K₀,25-constants.K₀,constants.R)</code></pre><p><strong>References</strong></p><p>Farquhar, G. D., S. von von Caemmerer, et J. A. Berry. 1980. « A biochemical model of photosynthetic CO2 assimilation in leaves of C3 species ». Planta 149 (1): 78‑90.</p><p>Medlyn, B. E., E. Dreyer, D. Ellsworth, M. Forstreuter, P. C. Harley, M. U. F. Kirschbaum, X. Le Roux, et al. 2002. « Temperature response of parameters of a biochemically based model of photosynthesis. II. A review of experimental data ». Plant, Cell &amp; Environment 25 (9): 1167‑79. https://doi.org/10.1046/j.1365-3040.2002.00891.x.</p><p>Sharkey, Thomas D., Carl J. Bernacchi, Graham D. Farquhar, et Eric L. Singsaas. 2007. « Fitting Photosynthetic Carbon Dioxide Response Curves for C3 Leaves ». Plant, Cell &amp; Environment 30 (9): 1035‑40. https://doi.org/10.1111/j.1365-3040.2007.01710.x.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/photosynthesis/temperature-dependence.jl#LL92-L137">source</a></section></article><h2 id="Un-exported-functions"><a class="docs-heading-anchor" href="#Un-exported-functions">Un-exported functions</a><a id="Un-exported-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Un-exported-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.f_ms_to_mol-NTuple{4, Any}" href="#PlantBiophysics.f_ms_to_mol-NTuple{4, Any}"><code>PlantBiophysics.f_ms_to_mol</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Conversion factor between conductance in <span>$m\ s^{-1}$</span> to <span>$mol\ m^{-2}\ s^{-1}$</span>.</p><p><strong>Arguments</strong></p><ul><li><code>T</code> (°C): air temperature</li><li><code>P</code> (kPa): air pressure</li><li><code>R</code> (<span>$J\ mol^{-1}\ K^{-1}$</span>): universal gas constant.</li><li><code>K₀</code> (°C): absolute zero</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/conversions.jl#LL55-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.locf!-Tuple{Any}" href="#PlantBiophysics.locf!-Tuple{Any}"><code>PlantBiophysics.locf!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">locf!(var)</code></pre><p>Last observation carried forward (LOCF) iterates forwards <code>var</code> and fills missing data with the last existing observation.</p><p>This function is heavily inspired (<em>i.e.</em> copied) by the function <code>locf</code> in the package <code>Impute</code> (MIT licence). See <a href="https://github.com/invenia/Impute.jl/blob/9230661ae5f3dc828fea58b32970c874574cb654/src/imputors/locf.jl#LL44-L64">here</a> for more details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/io/read_walz.jl#LL79-L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.max_root-Tuple{Any, Any, Any}" href="#PlantBiophysics.max_root-Tuple{Any, Any, Any}"><code>PlantBiophysics.max_root</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Maximum value between two roots of a quadratic equation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/photosynthesis/FvCB.jl#LL409-L411">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.negative_root-Tuple{Any, Any, Any}" href="#PlantBiophysics.negative_root-Tuple{Any, Any, Any}"><code>PlantBiophysics.negative_root</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Negative root of a quadratic equation, but returns 0 if Δ is negative. Careful, this is not right mathematically, but biologically OK because used in the computation of Cᵢ (gives A = 0 in this case).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/photosynthesis/FvCB.jl#LL430-L434">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.positive_root-Tuple{Any, Any, Any}" href="#PlantBiophysics.positive_root-Tuple{Any, Any, Any}"><code>PlantBiophysics.positive_root</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Positive root of a quadratic equation, but returns 0 if Δ is negative. Careful, this is not right mathematically, but biologically OK because used in the computation of Cᵢ (gives A = 0 in this case).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/photosynthesis/FvCB.jl#LL420-L424">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.γ_star-NTuple{6, Any}" href="#PlantBiophysics.γ_star-NTuple{6, Any}"><code>PlantBiophysics.γ_star</code></a> — <span class="docstring-category">Method</span></header><section><div><p>γ<em>star(γ, a</em>sh, a_s, rbv, Rsᵥ, Rbₕ)</p><p>γ∗, the apparent value of psychrometer constant (kPa K−1).</p><p><strong>Arguments</strong></p><ul><li><code>γ</code> (kPa K−1): psychrometer constant</li><li><code>aₛₕ</code> (1,2): number of faces exchanging heat fluxes (see Schymanski et al., 2017)</li><li><code>aₛᵥ</code> (1,2): number of faces exchanging water fluxes (see Schymanski et al., 2017)</li><li><code>Rbᵥ</code> (s m-1): boundary layer resistance to water vapor</li><li><code>Rsᵥ</code> (s m-1): stomatal resistance to water vapor</li><li><code>Rbₕ</code> (s m-1): boundary layer resistance to heat</li></ul><p><strong>Note</strong></p><p>Using the corrigendum from Schymanski et al. (2017) in here so the definition of <a href="#PlantBiophysics.latent_heat-NTuple{8, Any}"><code>latent_heat</code></a> remains generic.</p><p>Not to be confused with <a href="#PlantBiophysics.Γ_star"><code>Γ_star</code></a> the CO₂ compensation point.</p><p><strong>References</strong></p><p>Monteith, John L., et Mike H. Unsworth. 2013. « Chapter 13 - Steady-State Heat Balance: (i) Water Surfaces, Soil, and Vegetation ». In Principles of Environmental Physics (Fourth Edition), edited by John L. Monteith et Mike H. Unsworth, 217‑47. Boston: Academic Press.</p><p>Schymanski, Stanislaus J., et Dani Or. 2017. Leaf-Scale Experiments Reveal an Important Omission in the Penman–Monteith Equation ». Hydrology and Earth System Sciences 21 (2): 685‑706. https://doi.org/10.5194/hess-21-685-2017.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/γ_star.jl#LL1-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantBiophysics.λE_to_E" href="#PlantBiophysics.λE_to_E"><code>PlantBiophysics.λE_to_E</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">λE_to_E(λE, λ, Mₕ₂ₒ=PlantMeteo.Constants().Mₕ₂ₒ)
E_to_λE(E, λ, Mₕ₂ₒ=PlantMeteo.Constants().Mₕ₂ₒ)</code></pre><p>Conversion from latent heat (W m-2) to evaporation (mol[H₂O] m-2 s-1) or the opposite (<code>E_to_λE</code>).</p><p><strong>Arguments</strong></p><ul><li><code>λE</code>: latent heat flux (W m-2)</li><li><code>E</code>: water evaporation (mol[H₂O] m-2 s-1)</li><li><code>λ</code> (J kg-1): latent heat of vaporization</li><li><code>Mₕ₂ₒ = 18.0e-3</code> (kg mol-1): Molar mass for water.</li></ul><p><strong>Note</strong></p><p><code>λ</code> can be computed using:</p><pre><code class="nohighlight hljs">λ = latent_heat_vaporization(T, constants.λ₀)</code></pre><p>It is also directly available from the <a href="https://palmstudio.github.io/PlantMeteo.jl/stable/#PlantMeteo.Atmosphere"><code>Atmosphere</code></a> structure, and by extention in <a href="https://palmstudio.github.io/PlantMeteo.jl/stable/#PlantMeteo.Weather"><code>Weather</code></a>.</p><p>To convert E from mol[H₂O] m-2 s-1 to mm s-1 you can simply do:</p><pre><code class="nohighlight hljs">E_mms = E_mol / constants.Mₕ₂ₒ</code></pre><p>mm[H₂O] s-1 is equivalent to kg[H₂O] m-2 s-1, wich is equivalent to l[H₂O] m-2 s-1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/conversions.jl#LL112-L140">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantSimEngine.fit-Tuple{Type{Beer}, Any}" href="#PlantSimEngine.fit-Tuple{Type{Beer}, Any}"><code>PlantSimEngine.fit</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit(::Type{Beer}, df; J_to_umol=PlantMeteo.Constants().J_to_umol)</code></pre><p>Optimize <code>k</code>, the coefficient of the Beer-Lambert law of light extinction.</p><p><strong>Arguments</strong></p><ul><li>df: a DataFrame with columns Ri<em>PAR</em>f (Incoming light flux in the PAR, W m⁻²), </li></ul><p>aPPFD (μmol m⁻² s⁻¹) and LAI (m² m⁻²), where each row is an observation. The column names should match exactly.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantSimEngine, PlantBiophysics, DataFrames, PlantMeteo

# Defining dummy data:
df = DataFrame(
    Ri_PAR_f = [200.0, 250.0, 300.0], 
    aPPFD = [548.4, 685.5, 822.6], 
    LAI = [1.0, 1.0, 1.0],
    T = [20.0, 20.0, 20.0],
    Rh = [0.5, 0.5, 0.5],
    Wind = [10.0, 10.0, 10.0],
)

# Fit the parameters values:
k = fit(Beer, df)

# Re-simulating aPPFD using the newly fitted parameters:
w = Weather(df)
leaf = ModelList(
        Beer(k.k),
        status = (LAI = df.LAI,)
    )
run!(leaf, w)

leaf</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/fitting/fit_Beer.jl#LL1-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantSimEngine.fit-Union{Tuple{T}, Tuple{T, Any}} where T&lt;:Type{Medlyn}" href="#PlantSimEngine.fit-Union{Tuple{T}, Tuple{T, Any}} where T&lt;:Type{Medlyn}"><code>PlantSimEngine.fit</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit(::Type{Medlyn}, df)</code></pre><p>Optimize the parameters of the <a href="../models/gs/#Medlyn"><code>Medlyn</code></a> model. Note that here Gₛ is stomatal conductance for CO2, not H2O.</p><p>Careful, g0 and g1 are fitted on CO₂ stomatal conductance, and so are given for CO₂, not H₂O. If you want to compare the values with the ones usually given in the literature, you need to multiply g0 and g1 by 1.57.</p><p><strong>Arguments</strong></p><ul><li>df: a DataFrame with columns A, Dₗ, Cₐ and Gₛ, where each row is an observation. The column</li></ul><p>names should match exactly.</p><p>Note that Dₗ is the leaf to air vapour pressure deficit, computed as follows:</p><pre><code class="language-julia hljs">Dₗ = PlantMeteo.e_sat(Tₗ) - PlantMeteo.e_sat(T) * Rh</code></pre><p>with Tₗ the leaf temperature, T the air temperature and Rh the air relative humidity. If Tₗ is not available, you can use Tₗ = T as a crude approximation, which gives Dₗ = VPD.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantBiophysics, PlantMeteo, Plots, DataFrames

file = joinpath(dirname(dirname(pathof(PlantBiophysics))),&quot;test&quot;,&quot;inputs&quot;,&quot;data&quot;,&quot;P1F20129.csv&quot;)
df = read_walz(file)
# Removing the CO2 and ligth Curve, we fit the parameters on the Rh curve:
filter!(x -&gt; x.curve != &quot;ligth Curve&quot; &amp;&amp; x.curve != &quot;CO2 Curve&quot;, df)

# Fit the parameters values:
g0, g1 = fit(Medlyn, df)

# Re-simulating Gₛ using the newly fitted parameters:
w = Weather(select(df, :T, :P, :Rh, :Cₐ, :VPD, :T =&gt; (x -&gt; 10) =&gt; :Wind))
leaf = ModelList(
        stomatal_conductance = Medlyn(g0, g1),
        status = (A = df.A, Cₛ = df.Cₐ, Dₗ = df.Dₗ)
    )
run!(leaf, w)

# Visualising the results:
gsAvpd = PlantBiophysics.GsADₗ(g0, g1, df.Gₛ, df.Dₗ, df.A, df.Cₐ, leaf[:Gₛ])
plot(gsAvpd,leg=:bottomright)
# As in [`Medlyn`](@ref) reference paper, linear regression is also plotted.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/fitting/fit_Medlyn.jl#LL1-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantSimEngine.fit-Union{Tuple{T}, Tuple{T, Any}} where T&lt;:Union{Type{Fvcb}, Type{FvcbIter}, Type{FvcbRaw}}" href="#PlantSimEngine.fit-Union{Tuple{T}, Tuple{T, Any}} where T&lt;:Union{Type{Fvcb}, Type{FvcbIter}, Type{FvcbRaw}}"><code>PlantSimEngine.fit</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit(
    ::Type{Fvcb}, df; 
    Tᵣ = nothing, 
    VcMaxRef = 0.0, JMaxRef = 0.0, RdRef = 0.0, TPURef = 0.0, 
    VcMaxRef_bound=[0.0, Inf], JMaxRef_bound=[0.0, Inf], RdRef_bound=[0.0, Inf], TPURef_bound=[0.0, Inf],
    verbose = true,
    Eₐᵣ=46390.0, O₂=210.0, Eₐⱼ=29680.0, Hdⱼ=200000.0, Δₛⱼ=631.88, Eₐᵥ=58550.0, Hdᵥ=200000.0, Δₛᵥ=629.26, α=0.425, θ=0.7
)</code></pre><p>Optimize the parameters of the <a href="../models/photosynthesis/#Fvcb"><code>Fvcb</code></a> model. Also works for <a href="../models/photosynthesis/#FvcbIter"><code>FvcbIter</code></a>.</p><p><strong>Arguments</strong></p><ul><li>df: a DataFrame with columns A, aPPFD, Tₗ and Cᵢ, where each row is an observation. The column</li></ul><p>names should match exactly</p><ul><li>Tᵣ: reference temperature for the optimized parameter values. If not provided, use the average Tₗ.</li><li>VcMaxRef, JMaxRef, RdRef, TPURef: initialisation values for the parameter optimisation</li><li>VcMaxRef<em>bound, JMaxRef</em>bound, RdRef<em>bound, TPURef</em>bound: boundary values for the parameter optimisation</li><li>verbose: if true, print the optimisation results</li><li>Eₐᵣ, O₂, Eₐⱼ, Hdⱼ, Δₛⱼ, Eₐᵥ, Hdᵥ, Δₛᵥ, α, θ: parameters for the FvCB model</li></ul><p>FvCB model parameters:</p><p><strong>Parameters</strong></p><ul><li><code>Tᵣ</code>: the reference temperature (°C) at which other parameters were measured</li><li><code>VcMaxRef</code>: maximum rate of Rubisco activity (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>JMaxRef</code>: potential rate of electron transport (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>RdRef</code>: mitochondrial respiration in the light at reference temperature (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>TPURef</code>: triose phosphate utilization-limited photosynthesis rate (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>Eₐᵣ</code>: activation energy (<span>$J\ mol^{-1}$</span>), or the exponential rate of rise for Rd.</li><li><code>O₂</code>: intercellular dioxygen concentration (<span>$ppm$</span>)</li><li><code>Eₐⱼ</code>: activation energy (<span>$J\ mol^{-1}$</span>), or the exponential rate of rise for JMax.</li><li><code>Hdⱼ</code>: rate of decrease of the function above the optimum (also called EDVJ) for JMax.</li><li><code>Δₛⱼ</code>: entropy factor for JMax.</li><li><code>Eₐᵥ</code>: activation energy (<span>$J\ mol^{-1}$</span>), or the exponential rate of rise for VcMax.</li><li><code>Hdᵥ</code>: rate of decrease of the function above the optimum (also called EDVC) for VcMax.</li><li><code>Δₛᵥ</code>: entropy factor for VcMax.</li><li><code>α</code>: quantum yield of electron transport (<span>$mol_e\ mol^{-1}_{quanta}$</span>). See also eq. 4 of</li></ul><p>Medlyn et al. (2002), equation 9.16 from von Caemmerer et al. (2009) ((1-f)/2) and its implementation in <a href="#PlantBiophysics.get_J-NTuple{4, Any}"><code>get_J</code></a></p><ul><li><code>θ</code>: determines the curvature of the light response curve for <code>J~aPPFD</code>. See also eq. 4 of</li></ul><p>Medlyn et al. (2002) and its implementation in <a href="#PlantBiophysics.get_J-NTuple{4, Any}"><code>get_J</code></a></p><p>Note that boundary values are set to [0.0, Inf] by default. You should adapt them to your use case. Note that no  boundary can be set using [-Inf, Inf].</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantBiophysics, PlantSimEngine, PlantMeteo, Plots, DataFrames

file = joinpath(dirname(dirname(pathof(PlantBiophysics))),&quot;test&quot;,&quot;inputs&quot;,&quot;data&quot;,&quot;P1F20129.csv&quot;)
df = read_walz(file)
# Removing the Rh and light curves for the fitting because temperature varies
filter!(x -&gt; x.curve != &quot;Rh Curve&quot; &amp;&amp; x.curve != &quot;ligth Curve&quot;, df)

# Fit the parameter values:
VcMaxRef, JMaxRef, RdRef, TPURef = fit(Fvcb, df; Tᵣ = 25.0)
# Note that Tᵣ was set to 25 °C in our response curve. You should adapt its value to what you
# had during the response curves

# Checking the results:
filter!(x -&gt; x.curve == &quot;CO2 Curve&quot;, df)

# Sort the DataFrame by :Cᵢ to get ordered data point
sort!(df, :Cᵢ)

# Re-simulating A using the newly fitted parameters:
leaf =
    ModelList(
        photosynthesis = FvcbRaw(VcMaxRef = VcMaxRef, JMaxRef = JMaxRef, RdRef = RdRef, TPURef = TPURef),
        status = (Tₗ = df.Tₗ, aPPFD = df.aPPFD, Cᵢ = df.Cᵢ)
    )
run!(leaf)
df_sim = DataFrame(leaf)

# Visualising the results:
ACi_struct = PlantBiophysics.ACi(VcMaxRef, JMaxRef, RdRef, df.A, df_sim.A, df[:,:Cᵢ], df_sim.Cᵢ)
plot(ACi_struct,leg=:bottomright)

# Note that we can also simulate the results using the full photosynthesis model too (Fvcb):
# Adding the windspeed to simulate the boundary-layer conductance (we put a high value):
df[!, :Wind] .= 10.0

leaf = ModelList(
        photosynthesis = Fvcb(VcMaxRef = VcMaxRef, JMaxRef = JMaxRef, RdRef = RdRef, Tᵣ = 25.0, TPURef = TPURef),
        # stomatal_conductance = ConstantGs(0.0, df[i,:Gₛ]),
        stomatal_conductance = Medlyn(0.03, 12.),
        status = (Tₗ = df.Tₗ, aPPFD = df.aPPFD, Cₛ = df.Cₐ, Dₗ = 0.1)
    )

w = Weather(select(df, :T, :P, :Rh, :Cₐ, :T =&gt; (x -&gt; 10) =&gt; :Wind))
run!(leaf, w)
df_sim2 = DataFrame(leaf)

# And finally we plot the results:
ACi_struct_full = PlantBiophysics.ACi(VcMaxRef, JMaxRef, RdRef, df.A, df_sim2.A, df[:,:Cᵢ], df_sim2.Cᵢ)
plot(ACi_struct_full,leg=:bottomright)
# Note that the results differ a bit because there are more variables that are re-simulated (e.g. Cᵢ)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/fitting/fit_FvCB.jl#LL1-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantSimEngine.run!" href="#PlantSimEngine.run!"><code>PlantSimEngine.run!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">run!(object, meteo, constants = Constants())</code></pre><p>Computes the light interception of an object using the Beer-Lambert law.</p><p><strong>Arguments</strong></p><ul><li><code>::Beer</code>: a Beer model, from the model list (<em>i.e.</em> m.light_interception)</li><li><code>models</code>: A <code>ModelList</code> struct holding the parameters for the model with</li></ul><p>initialisations for <code>LAI</code> (m² m⁻²): the leaf area index.</p><ul><li><code>status</code>: the status of the model, usually the model list status (<em>i.e.</em> m.status)</li><li><code>meteo</code>: meteorology structure, see <a href="https://palmstudio.github.io/PlantMeteo.jl/stable/#PlantMeteo.Atmosphere"><code>Atmosphere</code></a></li><li><code>constants = PlantMeteo.Constants()</code>: physical constants. See <code>PlantMeteo.Constants</code> for more details</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantSimEngine, PlantBiophysics, PlantMeteo
m = ModelList(light_interception=Beer(0.5), status=(LAI=2.0,))

meteo = Atmosphere(T=20.0, Wind=1.0, P=101.3, Rh=0.65, Ri_PAR_f=300.0)

run!(m, meteo)

m[:aPPFD]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/light/Beer.jl#LL16-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantSimEngine.run!" href="#PlantSimEngine.run!"><code>PlantSimEngine.run!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">run!(::Monteith, models, status, meteo, constants=Constants())</code></pre><p>Leaf energy balance according to Monteith and Unsworth (2013), and corrigendum from Schymanski et al. (2017). The computation is close to the one from the MAESPA model (Duursma et al., 2012, Vezy et al., 2018) here. The leaf temperature is computed iteratively to close the energy balance using the mass flux (~ Rn - λE).</p><p><strong>Arguments</strong></p><ul><li><code>::Monteith</code>: a Monteith model, usually from a model list (<em>i.e.</em> m.energy_balance)</li><li><code>models</code>: A <code>ModelList</code> struct holding the parameters for the model with</li></ul><p>initialisations for:     - <code>Ra_SW_f</code> (W m-2): net shortwave radiation (PAR + NIR). Often computed from a light interception model     - <code>sky_fraction</code> (0-2): view factor between the object and the sky for both faces (see details).     - <code>d</code> (m): characteristic dimension, <em>e.g.</em> leaf width (see eq. 10.9 from Monteith and Unsworth, 2013).</p><ul><li><code>status</code>: the status of the model, usually the model list status (<em>i.e.</em> leaf.status)</li><li><code>meteo</code>: meteorology structure, see <a href="https://palmstudio.github.io/PlantMeteo.jl/stable/#PlantMeteo.Atmosphere"><code>Atmosphere</code></a></li><li><code>constants = PlantMeteo.Constants()</code>: physical constants. See <code>PlantMeteo.Constants</code> for more details</li></ul><p><strong>Details</strong></p><p>The sky_fraction in the variables is equal to 2 if all the leaf is viewing is sky (e.g. in a controlled chamber), 1 if the leaf is <em>e.g.</em> up on the canopy where the upper side of the leaf sees the sky, and the side bellow sees soil + other leaves that are all considered at the same temperature than the leaf, or less than 1 if it is partly shaded.</p><p><strong>Notes</strong></p><p>If you want the algorithm to print a message whenever it does not reach convergence, use the debugging mode by executing this in the REPL: <code>ENV[&quot;JULIA_DEBUG&quot;] = PlantBiophysics</code>.</p><p>More information <a href="https://docs.julialang.org/en/v1/stdlib/Logging/#Environment-variables">here</a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">meteo = Atmosphere(T = 22.0, Wind = 0.8333, P = 101.325, Rh = 0.4490995)

# Using a constant value for Gs:
leaf = ModelList(
    energy_balance = Monteith(),
    photosynthesis = Fvcb(),
    stomatal_conductance = ConstantGs(0.0, 0.0011),
    status = (Ra_SW_f = 13.747, sky_fraction = 1.0, d = 0.03)
)

run!(leaf,meteo)
leaf.status.Rn
julia&gt; 12.902547446281233

# Using the model from Medlyn et al. (2011) for Gs:
leaf = ModelList(
    energy_balance = Monteith(),
    photosynthesis = Fvcb(),
    stomatal_conductance = Medlyn(0.03, 12.0),
    status = (Ra_SW_f = 13.747, sky_fraction = 1.0, aPPFD = 1500.0, d = 0.03)
)

run!(leaf,meteo)
leaf[:Rn]
leaf[:Ra_LW_f]
leaf[:A]

DataFrame(leaf)</code></pre><p><strong>References</strong></p><p>Duursma, R. A., et B. E. Medlyn. 2012. « MAESPA: a model to study interactions between water limitation, environmental drivers and vegetation function at tree and stand levels, with an example application to [CO2] × drought interactions ». Geoscientific Model Development 5 (4): 919‑40. https://doi.org/10.5194/gmd-5-919-2012.</p><p>Monteith, John L., et Mike H. Unsworth. 2013. « Chapter 13 - Steady-State Heat Balance: (i) Water Surfaces, Soil, and Vegetation ». In Principles of Environmental Physics (Fourth Edition), edited by John L. Monteith et Mike H. Unsworth, 217‑47. Boston: Academic Press.</p><p>Schymanski, Stanislaus J., et Dani Or. 2017. « Leaf-Scale Experiments Reveal an Important Omission in the Penman–Monteith Equation ». Hydrology and Earth System Sciences 21 (2): 685‑706. https://doi.org/10.5194/hess-21-685-2017.</p><p>Vezy, Rémi, Mathias Christina, Olivier Roupsard, Yann Nouvellon, Remko Duursma, Belinda Medlyn, Maxime Soma, et al. 2018. « Measuring and modelling energy partitioning in canopies of varying complexity using MAESPA model ». Agricultural and Forest Meteorology 253‑254 (printemps): 203‑17. https://doi.org/10.1016/j.agrformet.2018.02.005.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/energy/Monteith.jl#LL50-L136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantSimEngine.run!" href="#PlantSimEngine.run!"><code>PlantSimEngine.run!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">run!(::Fvcb, models, status, meteo, constants=Constants())</code></pre><p>Coupled photosynthesis and conductance model using the Farquhar–von Caemmerer–Berry (FvCB) model for C3 photosynthesis (Farquhar et al., 1980; von Caemmerer and Farquhar, 1981) that models the assimilation as the most limiting factor between three processes:</p><ul><li>RuBisCo-limited photosynthesis, when the kinetics of the RuBisCo enzyme for fixing</li></ul><p>CO₂ is at its maximum (RuBisCo = Ribulose-1,5-bisphosphate carboxylase-oxygenase). It happens mostly when the CO₂ concentration in the stomata is too low. The main parameter is VcMaxRef, the maximum rate of RuBisCo activity at reference temperature. See <a href="#PlantBiophysics.get_Cᵢᵥ-NTuple{7, Any}"><code>get_Cᵢᵥ</code></a> for the computation.</p><ul><li>RuBP-limited photosynthesis, when the rate of RuBP (ribulose-1,5-bisphosphate) regeneration</li></ul><p>associated with electron transport rates on the thylakoid membrane (RuBP) is limiting. It happens mostly when light is limiting, or when CO₂ concentration is rather high. It is parameterized using <code>JMaxRef</code>, the potential rate of electron transport. See <a href="#PlantBiophysics.get_Cᵢⱼ-NTuple{6, Any}"><code>get_Cᵢⱼ</code></a> for the computation.</p><ul><li>TPU-limited photosynthesis, when the rate at which inorganic phosphate is released for</li></ul><p>regenerating ATP from ADP during the utilization of triose phosphate (TPU) is limiting. It happens at very high assimilation rate, when neither light or CO₂ are limiting factors. The parameter is <code>TPURef</code>.</p><p>The computation in this function is made following Farquhar &amp; Wong (1984), Leuning et al. (1995), and the MAESPA model (Duursma et al., 2012).</p><p>The resolution is analytical as first presented in Baldocchi (1994), and needs Cₛ as input.</p><p>Triose phosphate utilization (TPU) limitation is taken into account as proposed in Lombardozzi (2018) (<em>i.e.</em> <code>Aₚ = 3 * TPURef</code>, making the assumption that glycolate recycling is set to <code>0</code>). <code>TPURef</code> is set at <code>9999.0</code> by default, meaning there is no limitation of photosynthesis by TPU. Note that <code>TPURef</code> can be (badly) approximated using the simple equation <code>TPURef = 0.167 * VcMaxRef</code> as presented in Lombardozzi (2018).</p><p>If you prefer to use Gbc, you can use the iterative implementation of the Fvcb model <a href="../models/photosynthesis/#FvcbIter"><code>FvcbIter</code></a></p><p>If you want a version that is de-coupled from the stomatal conductance use <a href="../models/photosynthesis/#FvcbRaw"><code>FvcbRaw</code></a>, but you&#39;ll need Cᵢ as input of the model.</p><p><strong>Returns</strong></p><p>Modify the first argument in place for A, Gₛ and Cᵢ:</p><ul><li>A: carbon assimilation (μmol[CO₂] m-2 s-1)</li><li>Gₛ: stomatal conductance for CO₂ (mol[CO₂] m-2 s-1)</li><li>Cᵢ: intercellular CO₂ concentration (ppm)</li></ul><p><strong>Arguments</strong></p><ul><li><code>::Fvcb</code>: the Farquhar–von Caemmerer–Berry (FvCB) model</li><li><code>models</code>: a <code>ModelList</code> struct holding the parameters for the model with</li></ul><p>initialisations for:     - <code>Tₗ</code> (°C): leaf temperature     - <code>aPPFD</code> (μmol m-2 s-1): absorbed Photosynthetic Photon Flux Density     - <code>Cₛ</code> (ppm): Air CO₂ concentration at the leaf surface     - <code>Dₗ</code> (kPa): vapour pressure difference between the surface and the saturated     air vapour pressure in case you&#39;re using the stomatal conductance model of <a href="../models/gs/#Medlyn"><code>Medlyn</code></a>.</p><ul><li><code>status</code>: A status, usually the leaf status (<em>i.e.</em> leaf.status)</li><li><code>meteo</code>: meteorology structure, see <a href="https://palmstudio.github.io/PlantMeteo.jl/stable/#PlantMeteo.Atmosphere"><code>Atmosphere</code></a></li><li><code>constants = PlantMeteo.Constants()</code>: physical constants. See <code>PlantMeteo.Constants</code> for more details</li></ul><p><strong>Note</strong></p><p><code>Tₗ</code>, <code>aPPFD</code>, <code>Cₛ</code> (and <code>Dₗ</code> if you use <a href="../models/gs/#Medlyn"><code>Medlyn</code></a>) must be initialized by providing them as keyword arguments (see examples). If in doubt, it is simpler to compute the energy balance of the leaf with the photosynthesis to get those variables. See <a href="#PlantBiophysics.AbstractEnergy_BalanceModel"><code>AbstractEnergy_BalanceModel</code></a> for more details.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantBiophysics, PlantMeteo
meteo = Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)

leaf =
    ModelList(
        photosynthesis = Fvcb(),
        stomatal_conductance = Medlyn(0.03, 12.0),
        status = (Tₗ = 25.0, aPPFD = 1000.0, Cₛ = 400.0, Dₗ = meteo.VPD)
    )
# NB: we need to initalise Tₗ, aPPFD and Cₛ.
# NB2: we provide the name of the process before the model but it is not mandatory.

run!(leaf,meteo,PlantMeteo.Constants())
leaf.status.A
leaf.status.Cᵢ</code></pre><p>Note that we use <code>VPD</code> as an approximation of <code>Dₗ</code> here because we don&#39;t have the leaf temperature (<em>i.e.</em> <code>Dₗ = VPD</code> when <code>Tₗ = T</code>).</p><p><strong>References</strong></p><p>Baldocchi, Dennis. 1994. « An analytical solution for coupled leaf photosynthesis and stomatal conductance models ». Tree Physiology 14 (7-8‑9): 1069‑79. https://doi.org/10.1093/treephys/14.7-8-9.1069.</p><p>Duursma, R. A., et B. E. Medlyn. 2012. « MAESPA: a model to study interactions between water limitation, environmental drivers and vegetation function at tree and stand levels, with an example application to [CO2] × drought interactions ». Geoscientific Model Development 5 (4): 919‑40. https://doi.org/10.5194/gmd-5-919-2012.</p><p>Farquhar, G. D., S. von von Caemmerer, et J. A. Berry. 1980. « A biochemical model of photosynthetic CO2 assimilation in leaves of C3 species ». Planta 149 (1): 78‑90.</p><p>Leuning, R., F. M. Kelliher, DGG de Pury, et E.D. Schulze. 1995. « Leaf nitrogen, photosynthesis, conductance and transpiration: scaling from leaves to canopies ». Plant, Cell &amp; Environment 18 (10): 1183‑1200.</p><p>Lombardozzi, L. D. et al. 2018.« Triose phosphate limitation in photosynthesis models reduces leaf photosynthesis and global terrestrial carbon storage ». Environmental Research Letters 13.7: 1748-9326. https://doi.org/10.1088/1748-9326/aacf68.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/photosynthesis/FvCB.jl#LL130-L243">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantSimEngine.run!" href="#PlantSimEngine.run!"><code>PlantSimEngine.run!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">run!(::FvcbRaw, models, status, meteo=nothing, constants=Constants())</code></pre><p>Direct implementation of the photosynthesis model for C3 photosynthesis from Farquhar–von Caemmerer–Berry (Farquhar et al., 1980; von Caemmerer and Farquhar, 1981).</p><p><strong>Returns</strong></p><p>Modify the first argument in place for A, the carbon assimilation (μmol[CO₂] m-2 s-1).</p><p><strong>Arguments</strong></p><ul><li><code>::FvcbRaw</code>: the Farquhar–von Caemmerer–Berry (FvCB) model (not coupled)</li><li><code>models</code>: a <code>ModelList</code> struct holding the parameters for the model with</li></ul><p>initialisations for:     - <code>Tₗ</code> (°C): leaf temperature     - <code>aPPFD</code> (μmol m-2 s-1): absorbed Photosynthetic Photon Flux Density     - <code>Cₛ</code> (ppm): Air CO₂ concentration at the leaf surface     - <code>Dₗ</code> (kPa): vapour pressure difference between the surface and the saturated     air vapour pressure in case you&#39;re using the stomatal conductance model of <a href="../models/gs/#Medlyn"><code>Medlyn</code></a>.</p><ul><li><code>status</code>: A status, usually the leaf status (<em>i.e.</em> leaf.status)</li><li><code>constants = PlantMeteo.Constants()</code>: physical constants. See <code>PlantMeteo.Constants</code> for more details</li></ul><p><strong>Note</strong></p><p><code>Tₗ</code>, <code>aPPFD</code>, <code>Cₛ</code> (and <code>Dₗ</code> if you use <a href="../models/gs/#Medlyn"><code>Medlyn</code></a>) must be initialized by providing them as keyword arguments (see examples). If in doubt, it is simpler to compute the energy balance of the leaf with the photosynthesis to get those variables. See <a href="#PlantBiophysics.AbstractEnergy_BalanceModel"><code>AbstractEnergy_BalanceModel</code></a> for more details.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantSimEngine
leaf = ModelList(photosynthesis = FvcbRaw(), status = (Tₗ = 25.0, aPPFD = 1000.0, Cᵢ = 400.0))
# NB: we need Tₗ, aPPFD and Cᵢ as inputs (see [`inputs`](@ref))

run!(leaf)
leaf.status.A
leaf.status.Cᵢ

# using several time-steps:
leaf =
    ModelList(
        photosynthesis = FvcbRaw(),
        status = (Tₗ = [20., 25.0], aPPFD = 1000.0, Cᵢ = [380.,400.0])
    )
# NB: we need Tₗ, aPPFD and Cᵢ as inputs (see [`inputs`](@ref))

run!(leaf)
DataFrame(leaf) # fetch the leaf status as a DataFrame</code></pre><p><strong>References</strong></p><p>Baldocchi, Dennis. 1994. « An analytical solution for coupled leaf photosynthesis and stomatal conductance models ». Tree Physiology 14 (7-8‑9): 1069‑79. https://doi.org/10.1093/treephys/14.7-8-9.1069.</p><p>Duursma, R. A., et B. E. Medlyn. 2012. « MAESPA: a model to study interactions between water limitation, environmental drivers and vegetation function at tree and stand levels, with an example application to [CO2] × drought interactions ». Geoscientific Model Development 5 (4): 919‑40. https://doi.org/10.5194/gmd-5-919-2012.</p><p>Farquhar, G. D., S. von von Caemmerer, et J. A. Berry. 1980. « A biochemical model of photosynthetic CO2 assimilation in leaves of C3 species ». Planta 149 (1): 78‑90.</p><p>Leuning, R., F. M. Kelliher, DGG de Pury, et E.D. Schulze. 1995. « Leaf nitrogen, photosynthesis, conductance and transpiration: scaling from leaves to canopies ». Plant, Cell &amp; Environment 18 (10): 1183‑1200.</p><p>Lombardozzi, L. D. et al. 2018.« Triose phosphate limitation in photosynthesis models reduces leaf photosynthesis and global terrestrial carbon storage ». Environmental Research Letters 13.7: 1748-9326. https://doi.org/10.1088/1748-9326/aacf68.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/photosynthesis/FvCBRaw.jl#LL70-L144">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantSimEngine.run!" href="#PlantSimEngine.run!"><code>PlantSimEngine.run!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">run!(::ConstantA; models, status, meteo, constants=Constants())</code></pre><p>Constant photosynthesis (forcing the value).</p><p><strong>Returns</strong></p><p>Modify the leaf status in place for A with a constant value:</p><ul><li>A: carbon assimilation, set to leaf.photosynthesis.A (μmol[CO₂] m-2 s-1)</li></ul><p><strong>Arguments</strong></p><ul><li><code>::ConstantA</code>: a constant assimilation model</li><li><code>models</code>: a <code>ModelList</code> struct holding the parameters for the model.</li><li><code>status</code>: A status, usually the leaf status (<em>i.e.</em> leaf.status)</li><li><code>meteo</code>: meteorology structure, see <a href="https://palmstudio.github.io/PlantMeteo.jl/stable/#PlantMeteo.Atmosphere"><code>Atmosphere</code></a></li><li><code>constants = PlantMeteo.Constants()</code>: physical constants. See <code>PlantMeteo.Constants</code> for more details</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">meteo = Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)
leaf = ModelList(photosynthesis = ConstantA(26.0))

run!(leaf,meteo,Constants())

leaf.status.A</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/photosynthesis/constantA.jl#LL28-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantSimEngine.run!" href="#PlantSimEngine.run!"><code>PlantSimEngine.run!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">run!(::LightIgnore, models::ModelList, status, meteo,constants = Constants())</code></pre><p>Method for when light interception should be explicitely ignored (do nothing).</p><p><strong>Arguments</strong></p><ul><li><code>::LightIgnore</code>: an <code>Ignore</code> model.</li><li><code>models</code>: a <code>ModelList</code> struct with a missing energy model.</li><li><code>status</code>: the status of the model, usually the one from the models (<em>i.e.</em> models.status)</li><li><code>meteo</code>: meteorology structure, see <a href="https://palmstudio.github.io/PlantMeteo.jl/stable/#PlantMeteo.Atmosphere"><code>Atmosphere</code></a></li><li><code>constants = PlantMeteo.Constants()</code>: physical constants. See <code>PlantMeteo.Constants</code> for more details</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/light/Ignore.jl#LL8-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantSimEngine.run!" href="#PlantSimEngine.run!"><code>PlantSimEngine.run!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">run!(::ConstantAGs, models, status, meteo, constants=Constants())</code></pre><p>Constant photosynthesis coupled with a stomatal conductance model.</p><p><strong>Returns</strong></p><p>Modify the leaf status in place for A, Gₛ and Cᵢ:</p><ul><li>A: carbon assimilation, set to leaf.photosynthesis.A (μmol[CO₂] m-2 s-1)</li><li>Gₛ: stomatal conductance for CO₂ (mol[CO₂] m-2 s-1)</li><li>Cᵢ: intercellular CO₂ concentration (ppm)</li></ul><p><strong>Arguments</strong></p><ul><li><code>::ConstantAGs</code>: a constant assimilation model coupled to a stomatal conductance model</li><li><code>models</code>: a <code>ModelList</code> struct holding the parameters for the model with</li></ul><p>initialisations for:     - <code>Cₛ</code> (mol m-2 s-1): surface CO₂ concentration.     - any other value needed by the stomatal conductance model.</p><ul><li><code>status</code>: A status, usually the leaf status (<em>i.e.</em> leaf.status)</li><li><code>meteo</code>: meteorology structure, see <a href="https://palmstudio.github.io/PlantMeteo.jl/stable/#PlantMeteo.Atmosphere"><code>Atmosphere</code></a></li><li><code>constants = PlantMeteo.Constants()</code>: physical constants. See <code>PlantMeteo.Constants</code> for more details</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantBiophysics, PlantMeteo
meteo = Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)
leaf = ModelList(
    photosynthesis = ConstantAGs(),
    stomatal_conductance = Medlyn(0.03, 12.0),
    status = (Cₛ = 400.0, Dₗ = 2.0)
)

run!(leaf,meteo,PlantMeteo.Constants())

status(leaf, :A)
status(leaf, :Cᵢ)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/photosynthesis/constantAGs.jl#LL26-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantSimEngine.run!" href="#PlantSimEngine.run!"><code>PlantSimEngine.run!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">run!(::FvcbIter, models, status, meteo, constants=Constants())</code></pre><p>Photosynthesis using the Farquhar–von Caemmerer–Berry (FvCB) model for C3 photosynthesis  (Farquhar et al., 1980; von Caemmerer and Farquhar, 1981). Computation is made following Farquhar &amp; Wong (1984), Leuning et al. (1995), and the Archimed model.</p><p>Iterative implementation, i.e. the assimilation is computed iteratively over Cᵢ. For the analytical resolution, see <a href="../models/photosynthesis/#Fvcb"><code>Fvcb</code></a>.</p><p><strong>Returns</strong></p><p>Modify the first argument in place for A, Gₛ and Cᵢ:</p><ul><li>A: carbon assimilation (μmol[CO₂] m-2 s-1)</li><li>Gₛ: stomatal conductance for CO₂ (mol[CO₂] m-2 s-1)</li><li>Cᵢ: intercellular CO₂ concentration (ppm)</li></ul><p><strong>Arguments</strong></p><ul><li><code>::FvcbIter</code>: Farquhar–von Caemmerer–Berry (FvCB) model with iterative resolution.</li><li><code>models</code>: a <code>ModelList</code> struct holding the parameters for the model with</li></ul><p>initialisations for:     - <code>Tₗ</code> (°C): leaf temperature     - <code>aPPFD</code> (μmol m-2 s-1): absorbed Photosynthetic Photon Flux Density     - <code>Gbc</code> (mol m-2 s-1): boundary conductance for CO₂     - <code>Dₗ</code> (kPa): is the difference between the vapour pressure at the leaf surface and the     saturated air vapour pressure in case you&#39;re using the stomatal conductance model of <a href="../models/gs/#Medlyn"><code>Medlyn</code></a>.</p><ul><li><code>status</code>: A status, usually the leaf status (<em>i.e.</em> leaf.status)</li><li><code>meteo</code>: meteorology structure, see <a href="https://palmstudio.github.io/PlantMeteo.jl/stable/#PlantMeteo.Atmosphere"><code>Atmosphere</code></a></li><li><code>constants = PlantMeteo.Constants()</code>: physical constants. See <code>PlantMeteo.Constants</code> for more details</li></ul><p><strong>Note</strong></p><p><code>Tₗ</code>, <code>aPPFD</code>, <code>Gbc</code> (and <code>Dₗ</code> if you use <a href="../models/gs/#Medlyn"><code>Medlyn</code></a>) must be initialized by providing them as keyword arguments (see examples). If in doubt, it is simpler to compute the energy balance of the leaf with the photosynthesis to get those variables. See <a href="#PlantBiophysics.AbstractEnergy_BalanceModel"><code>AbstractEnergy_BalanceModel</code></a> for more details.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantBiophysics, PlantMeteo
meteo = Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)

leaf =
    ModelList(
        photosynthesis = FvcbIter(),
        stomatal_conductance = Medlyn(0.03, 12.0),
        status = (Tₗ = 25.0, aPPFD = 1000.0, Gbc = 0.67, Dₗ = meteo.VPD)
    )
# NB: we need  to initalise Tₗ, aPPFD and Gbc.

run!(leaf,meteo,PlantMeteo.Constants())
leaf.status.A
leaf.status.Cᵢ</code></pre><p>Note that we use <code>VPD</code> as an approximation of <code>Dₗ</code> here because we don&#39;t have the leaf temperature (<em>i.e.</em> <code>Dₗ = VPD</code> when <code>Tₗ = T</code>).</p><p><strong>References</strong></p><p>Baldocchi, Dennis. 1994. « An analytical solution for coupled leaf photosynthesis and stomatal conductance models ». Tree Physiology 14 (7-8‑9): 1069‑79. https://doi.org/10.1093/treephys/14.7-8-9.1069.</p><p>Farquhar, G. D., S. von von Caemmerer, et J. A. Berry. 1980. « A biochemical model of photosynthetic CO2 assimilation in leaves of C3 species ». Planta 149 (1): 78‑90.</p><p>Leuning, R., F. M. Kelliher, DGG de Pury, et E.D. Schulze. 1995. Leaf nitrogen, photosynthesis, conductance and transpiration: scaling from leaves to canopies ». Plant, Cell &amp; Environment 18 (10): 1183‑1200.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/photosynthesis/FvCBIter.jl#LL67-L140">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PlantSimEngine.run!-Tuple{ConstantGs, Any, Any, Any}" href="#PlantSimEngine.run!-Tuple{ConstantGs, Any, Any, Any}"><code>PlantSimEngine.run!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Constant stomatal conductance for CO₂ (mol m-2 s-1).</p><p><strong>Note</strong></p><p><code>meteo</code> or <code>gs_mod</code> are just declared here for compatibility with the call from photosynthesis (need a constant way of calling the functions).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/144506f12e11633f224fef168425b4c127c59921/src/processes/conductances/stomatal/constantGs.jl#LL45-L52">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../extending/implement_a_process/">« Implement a process</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Thursday 11 July 2024 15:02">Thursday 11 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
