<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · PlantBiophysics.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://VEZY.github.io/PlantBiophysics.jl/functions/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="PlantBiophysics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">PlantBiophysics.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../getting_started/get_started/">TL;DR</a></li><li><a class="tocitem" href="../getting_started/first_fit/">Parameter fitting</a></li></ul></li><li><a class="tocitem" href="../concepts/package_design/">Design</a></li><li><a class="tocitem" href="../variables/">Variables</a></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../models/photosynthesis/">Photosynthesis</a></li><li><a class="tocitem" href="../models/gs/">Stomatal conductance</a></li><li><a class="tocitem" href="../models/energy_balance/">Energy balance</a></li><li><a class="tocitem" href="../models/light/">Light interception</a></li></ul></li><li><a class="tocitem" href="../climate/microclimate/">Micro-climate</a></li><li><a class="tocitem" href="../fitting/parameter_fitting/">Tutorial: Parameter fitting</a></li><li><span class="tocitem">Tutorial: Simulation</span><ul><li><a class="tocitem" href="../simulation/first_simulation/">Simple Simulation</a></li><li><a class="tocitem" href="../simulation/several_simulation/">Several time steps</a></li><li><a class="tocitem" href="../simulation/several_objects_simulation/">Several objects</a></li><li><a class="tocitem" href="../simulation/mtg_simulation/">Whole-plant simulation</a></li></ul></li><li><a class="tocitem" href="../simulation/uncertainty_propagation/">Tutorial: Uncertainty propagation</a></li><li><span class="tocitem">Extending PlantBiophysics</span><ul><li><a class="tocitem" href="../extending/implement_a_model/">Implement a model</a></li><li><a class="tocitem" href="../extending/implement_a_process/">Implement a process</a></li></ul></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#API-documentation"><span>API documentation</span></a></li><li><a class="tocitem" href="#Un-exported-functions"><span>Un-exported functions</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/VEZY/PlantBiophysics.jl/blob/master/docs/src/functions.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h1><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#DataFrames.DataFrame-Tuple{T} where T&lt;:Union{AbstractArray{&lt;:ModelList}, ModelList}"><code>DataFrames.DataFrame</code></a></li><li><a href="#DataFrames.DataFrame-Union{Tuple{ModelList{T, S}}, Tuple{S}, Tuple{T}} where {T, S&lt;:Status}"><code>DataFrames.DataFrame</code></a></li><li><a href="#DataFrames.DataFrame-Tuple{T} where T&lt;:ModelList"><code>DataFrames.DataFrame</code></a></li><li><a href="#DataFrames.DataFrame-Union{Tuple{ModelList{T, S}}, Tuple{S}, Tuple{T}} where {T, S&lt;:TimeSteps}"><code>DataFrames.DataFrame</code></a></li><li><a href="#DataFrames.DataFrame-Tuple{Weather}"><code>DataFrames.DataFrame</code></a></li><li><a href="#PlantBiophysics.AbstractAModel"><code>PlantBiophysics.AbstractAModel</code></a></li><li><a href="#PlantBiophysics.AbstractAtmosphere"><code>PlantBiophysics.AbstractAtmosphere</code></a></li><li><a href="#PlantBiophysics.AbstractEnergyModel"><code>PlantBiophysics.AbstractEnergyModel</code></a></li><li><a href="#PlantBiophysics.AbstractGsModel"><code>PlantBiophysics.AbstractGsModel</code></a></li><li><a href="#PlantBiophysics.AbstractLightModel"><code>PlantBiophysics.AbstractLightModel</code></a></li><li><a href="#PlantBiophysics.AbstractModel"><code>PlantBiophysics.AbstractModel</code></a></li><li><a href="#PlantBiophysics.AbstractStatus"><code>PlantBiophysics.AbstractStatus</code></a></li><li><a href="#PlantBiophysics.Atmosphere"><code>PlantBiophysics.Atmosphere</code></a></li><li><a href="#PlantBiophysics.Beer"><code>PlantBiophysics.Beer</code></a></li><li><a href="#PlantBiophysics.ConstantA"><code>PlantBiophysics.ConstantA</code></a></li><li><a href="#PlantBiophysics.ConstantAGs"><code>PlantBiophysics.ConstantAGs</code></a></li><li><a href="#PlantBiophysics.ConstantGs"><code>PlantBiophysics.ConstantGs</code></a></li><li><a href="#PlantBiophysics.Constants"><code>PlantBiophysics.Constants</code></a></li><li><a href="#PlantBiophysics.Fvcb"><code>PlantBiophysics.Fvcb</code></a></li><li><a href="#PlantBiophysics.FvcbIter"><code>PlantBiophysics.FvcbIter</code></a></li><li><a href="#PlantBiophysics.FvcbRaw"><code>PlantBiophysics.FvcbRaw</code></a></li><li><a href="#PlantBiophysics.Ignore"><code>PlantBiophysics.Ignore</code></a></li><li><a href="#PlantBiophysics.Medlyn"><code>PlantBiophysics.Medlyn</code></a></li><li><a href="#PlantBiophysics.ModelList"><code>PlantBiophysics.ModelList</code></a></li><li><a href="#PlantBiophysics.Monteith"><code>PlantBiophysics.Monteith</code></a></li><li><a href="#PlantBiophysics.OpticalProperties"><code>PlantBiophysics.OpticalProperties</code></a></li><li><a href="#PlantBiophysics.Status"><code>PlantBiophysics.Status</code></a></li><li><a href="#PlantBiophysics.TimeSteps"><code>PlantBiophysics.TimeSteps</code></a></li><li><a href="#PlantBiophysics.Translucent"><code>PlantBiophysics.Translucent</code></a></li><li><a href="#PlantBiophysics.Weather"><code>PlantBiophysics.Weather</code></a></li><li><a href="#PlantBiophysics.σ"><code>PlantBiophysics.σ</code></a></li><li><a href="#Base.copy-Tuple{T} where T&lt;:(AbstractArray{&lt;:ModelList})"><code>Base.copy</code></a></li><li><a href="#Base.copy-Tuple{T} where T&lt;:ModelList"><code>Base.copy</code></a></li><li><a href="#Base.copy-Tuple{T} where T&lt;:(AbstractDict{N, &lt;:ModelList} where N)"><code>Base.copy</code></a></li><li><a href="#Base.getindex-Union{Tuple{T}, Tuple{T, Any}} where T&lt;:ModelList"><code>Base.getindex</code></a></li><li><a href="#PlantBiophysics.EF-Tuple{Any, Any}"><code>PlantBiophysics.EF</code></a></li><li><a href="#PlantBiophysics.Fvcb_net_assimiliation-NTuple{6, Any}"><code>PlantBiophysics.Fvcb_net_assimiliation</code></a></li><li><a href="#PlantBiophysics.NRMSE-Tuple{Any, Any}"><code>PlantBiophysics.NRMSE</code></a></li><li><a href="#PlantBiophysics.RMSE-Tuple{Any, Any}"><code>PlantBiophysics.RMSE</code></a></li><li><a href="#PlantBiophysics.air_density-NTuple{4, Any}"><code>PlantBiophysics.air_density</code></a></li><li><a href="#PlantBiophysics.arrhenius"><code>PlantBiophysics.arrhenius</code></a></li><li><a href="#PlantBiophysics.arrhenius"><code>PlantBiophysics.arrhenius</code></a></li><li><a href="#PlantBiophysics.atmosphere_emissivity-Tuple{Any, Any, Any}"><code>PlantBiophysics.atmosphere_emissivity</code></a></li><li><a href="#PlantBiophysics.black_body-Tuple{Any, Any, Any}"><code>PlantBiophysics.black_body</code></a></li><li><a href="#PlantBiophysics.check_status_wheather-Union{Tuple{T}, Tuple{T, Weather}} where T&lt;:TimeSteps"><code>PlantBiophysics.check_status_wheather</code></a></li><li><a href="#PlantBiophysics.compute_date!-Tuple{Any, Any, Any}"><code>PlantBiophysics.compute_date!</code></a></li><li><a href="#PlantBiophysics.compute_duration!-Tuple{Any, Any}"><code>PlantBiophysics.compute_duration!</code></a></li><li><a href="#PlantBiophysics.convert_status-Union{Tuple{T}, Tuple{Type{T}, Any}} where T"><code>PlantBiophysics.convert_status</code></a></li><li><a href="#PlantBiophysics.convert_vars-Tuple{Dict{DataType, DataType}, Any}"><code>PlantBiophysics.convert_vars</code></a></li><li><a href="#PlantBiophysics.dep-Tuple{}"><code>PlantBiophysics.dep</code></a></li><li><a href="#PlantBiophysics.diff_vars-Tuple{Any, Any}"><code>PlantBiophysics.diff_vars</code></a></li><li><a href="#PlantBiophysics.dr-Tuple{Any, Any}"><code>PlantBiophysics.dr</code></a></li><li><a href="#PlantBiophysics.e_sat-Tuple{Any}"><code>PlantBiophysics.e_sat</code></a></li><li><a href="#PlantBiophysics.e_sat_slope-Tuple{Any}"><code>PlantBiophysics.e_sat_slope</code></a></li><li><a href="#PlantBiophysics.energy_balance"><code>PlantBiophysics.energy_balance</code></a></li><li><a href="#PlantBiophysics.energy_balance!"><code>PlantBiophysics.energy_balance!</code></a></li><li><a href="#PlantBiophysics.energy_balance!_"><code>PlantBiophysics.energy_balance!_</code></a></li><li><a href="#PlantBiophysics.energy_balance!_"><code>PlantBiophysics.energy_balance!_</code></a></li><li><a href="#PlantBiophysics.energy_balance!_"><code>PlantBiophysics.energy_balance!_</code></a></li><li><a href="#PlantBiophysics.f_ms_to_mol-NTuple{4, Any}"><code>PlantBiophysics.f_ms_to_mol</code></a></li><li><a href="#PlantBiophysics.fit-Union{Tuple{T}, Tuple{T, Any}} where T&lt;:Union{Type{Fvcb}, Type{FvcbIter}, Type{FvcbRaw}}"><code>PlantBiophysics.fit</code></a></li><li><a href="#PlantBiophysics.fit"><code>PlantBiophysics.fit</code></a></li><li><a href="#PlantBiophysics.fit-Union{Tuple{T}, Tuple{T, Any}} where T&lt;:Type{Medlyn}"><code>PlantBiophysics.fit</code></a></li><li><a href="#PlantBiophysics.gbh_to_gbw"><code>PlantBiophysics.gbh_to_gbw</code></a></li><li><a href="#PlantBiophysics.gbₕ_forced-Tuple{Any, Any}"><code>PlantBiophysics.gbₕ_forced</code></a></li><li><a href="#PlantBiophysics.gbₕ_free"><code>PlantBiophysics.gbₕ_free</code></a></li><li><a href="#PlantBiophysics.get_Cᵢᵥ-NTuple{7, Any}"><code>PlantBiophysics.get_Cᵢᵥ</code></a></li><li><a href="#PlantBiophysics.get_Cᵢⱼ-NTuple{6, Any}"><code>PlantBiophysics.get_Cᵢⱼ</code></a></li><li><a href="#PlantBiophysics.get_Dₕ"><code>PlantBiophysics.get_Dₕ</code></a></li><li><a href="#PlantBiophysics.get_J-NTuple{4, Any}"><code>PlantBiophysics.get_J</code></a></li><li><a href="#PlantBiophysics.get_attr_i-Union{Tuple{T}, Tuple{Any, Any, T}} where T&lt;:Nothing"><code>PlantBiophysics.get_attr_i</code></a></li><li><a href="#PlantBiophysics.get_km"><code>PlantBiophysics.get_km</code></a></li><li><a href="#PlantBiophysics.get_model-Tuple{Any, Any}"><code>PlantBiophysics.get_model</code></a></li><li><a href="#PlantBiophysics.get_process-Tuple{Any}"><code>PlantBiophysics.get_process</code></a></li><li><a href="#PlantBiophysics.grey_body-NTuple{4, Any}"><code>PlantBiophysics.grey_body</code></a></li><li><a href="#PlantBiophysics.gs_closure"><code>PlantBiophysics.gs_closure</code></a></li><li><a href="#PlantBiophysics.gs_closure-Tuple{Medlyn, Any, Any, Any}"><code>PlantBiophysics.gs_closure</code></a></li><li><a href="#PlantBiophysics.gsc_to_gsw"><code>PlantBiophysics.gsc_to_gsw</code></a></li><li><a href="#PlantBiophysics.gsw_to_gsc"><code>PlantBiophysics.gsw_to_gsc</code></a></li><li><a href="#PlantBiophysics.homogeneous_type_steps"><code>PlantBiophysics.homogeneous_type_steps</code></a></li><li><a href="#PlantBiophysics.init_mtg_models!"><code>PlantBiophysics.init_mtg_models!</code></a></li><li><a href="#PlantBiophysics.init_status!-Tuple{Dict{String, ModelList}}"><code>PlantBiophysics.init_status!</code></a></li><li><a href="#PlantBiophysics.init_variables-Tuple{T} where T&lt;:AbstractModel"><code>PlantBiophysics.init_variables</code></a></li><li><a href="#PlantBiophysics.init_variables_manual-Tuple{Any, Any}"><code>PlantBiophysics.init_variables_manual</code></a></li><li><a href="#PlantBiophysics.inputs-Tuple{T} where T&lt;:AbstractModel"><code>PlantBiophysics.inputs</code></a></li><li><a href="#PlantBiophysics.instantiate-NTuple{4, Any}"><code>PlantBiophysics.instantiate</code></a></li><li><a href="#PlantBiophysics.is_initialized-Tuple{T} where T&lt;:ModelList"><code>PlantBiophysics.is_initialized</code></a></li><li><a href="#PlantBiophysics.is_model-Tuple{Any}"><code>PlantBiophysics.is_model</code></a></li><li><a href="#PlantBiophysics.latent_heat-NTuple{8, Any}"><code>PlantBiophysics.latent_heat</code></a></li><li><a href="#PlantBiophysics.latent_heat_vaporization-Tuple{Any, Any}"><code>PlantBiophysics.latent_heat_vaporization</code></a></li><li><a href="#PlantBiophysics.light_interception"><code>PlantBiophysics.light_interception</code></a></li><li><a href="#PlantBiophysics.light_interception!"><code>PlantBiophysics.light_interception!</code></a></li><li><a href="#PlantBiophysics.light_interception!_-Tuple{Beer, Any, Any, Any, Any}"><code>PlantBiophysics.light_interception!_</code></a></li><li><a href="#PlantBiophysics.locf!-Tuple{Any}"><code>PlantBiophysics.locf!</code></a></li><li><a href="#PlantBiophysics.max_root-Tuple{Any, Any, Any}"><code>PlantBiophysics.max_root</code></a></li><li><a href="#PlantBiophysics.merge_status-Tuple{Any, Any}"><code>PlantBiophysics.merge_status</code></a></li><li><a href="#PlantBiophysics.mol_to_ms-NTuple{5, Any}"><code>PlantBiophysics.mol_to_ms</code></a></li><li><a href="#PlantBiophysics.ms_to_mol-NTuple{5, Any}"><code>PlantBiophysics.ms_to_mol</code></a></li><li><a href="#PlantBiophysics.negative_root-Tuple{Any, Any, Any}"><code>PlantBiophysics.negative_root</code></a></li><li><a href="#PlantBiophysics.net_longwave_radiation-NTuple{7, Any}"><code>PlantBiophysics.net_longwave_radiation</code></a></li><li><a href="#PlantBiophysics.outputs-Tuple{T} where T&lt;:AbstractModel"><code>PlantBiophysics.outputs</code></a></li><li><a href="#PlantBiophysics.photosynthesis"><code>PlantBiophysics.photosynthesis</code></a></li><li><a href="#PlantBiophysics.photosynthesis!"><code>PlantBiophysics.photosynthesis!</code></a></li><li><a href="#PlantBiophysics.photosynthesis!_"><code>PlantBiophysics.photosynthesis!_</code></a></li><li><a href="#PlantBiophysics.photosynthesis!_"><code>PlantBiophysics.photosynthesis!_</code></a></li><li><a href="#PlantBiophysics.photosynthesis!_"><code>PlantBiophysics.photosynthesis!_</code></a></li><li><a href="#PlantBiophysics.photosynthesis!_"><code>PlantBiophysics.photosynthesis!_</code></a></li><li><a href="#PlantBiophysics.photosynthesis!_"><code>PlantBiophysics.photosynthesis!_</code></a></li><li><a href="#PlantBiophysics.positive_root-Tuple{Any, Any, Any}"><code>PlantBiophysics.positive_root</code></a></li><li><a href="#PlantBiophysics.pre_allocate_attr!-Tuple{Any, Any}"><code>PlantBiophysics.pre_allocate_attr!</code></a></li><li><a href="#PlantBiophysics.psychrometer_constant-NTuple{4, Any}"><code>PlantBiophysics.psychrometer_constant</code></a></li><li><a href="#PlantBiophysics.pull_status!-Tuple{Any}"><code>PlantBiophysics.pull_status!</code></a></li><li><a href="#PlantBiophysics.pull_status_step!-Tuple{Any, Any}"><code>PlantBiophysics.pull_status_step!</code></a></li><li><a href="#PlantBiophysics.read_licor6400-Tuple{Any}"><code>PlantBiophysics.read_licor6400</code></a></li><li><a href="#PlantBiophysics.read_model-Tuple{Any}"><code>PlantBiophysics.read_model</code></a></li><li><a href="#PlantBiophysics.read_walz-Tuple{Any}"><code>PlantBiophysics.read_walz</code></a></li><li><a href="#PlantBiophysics.read_weather-Tuple{Any, Vararg{Any}}"><code>PlantBiophysics.read_weather</code></a></li><li><a href="#PlantBiophysics.rh_from_e-Tuple{Any, Any}"><code>PlantBiophysics.rh_from_e</code></a></li><li><a href="#PlantBiophysics.rh_from_vpd-Tuple{Any, Any}"><code>PlantBiophysics.rh_from_vpd</code></a></li><li><a href="#PlantBiophysics.sensible_heat-NTuple{8, Any}"><code>PlantBiophysics.sensible_heat</code></a></li><li><a href="#PlantBiophysics.status-Tuple{Any}"><code>PlantBiophysics.status</code></a></li><li><a href="#PlantBiophysics.stomatal_conductance"><code>PlantBiophysics.stomatal_conductance</code></a></li><li><a href="#PlantBiophysics.stomatal_conductance!"><code>PlantBiophysics.stomatal_conductance!</code></a></li><li><a href="#PlantBiophysics.stomatal_conductance!_-Tuple{ConstantGs, Any, Any, Any}"><code>PlantBiophysics.stomatal_conductance!_</code></a></li><li><a href="#PlantBiophysics.to_initialize-Tuple{ModelList}"><code>PlantBiophysics.to_initialize</code></a></li><li><a href="#PlantBiophysics.update_mtg_models!-Tuple{MultiScaleTreeGraph.Node, Any, Any, Symbol}"><code>PlantBiophysics.update_mtg_models!</code></a></li><li><a href="#PlantBiophysics.vapor_pressure-Tuple{Any, Any}"><code>PlantBiophysics.vapor_pressure</code></a></li><li><a href="#PlantBiophysics.variables-Tuple{}"><code>PlantBiophysics.variables</code></a></li><li><a href="#PlantBiophysics.variables-Union{Tuple{T}, Tuple{T, Vararg{Any}}} where T&lt;:Union{Missing, AbstractModel}"><code>PlantBiophysics.variables</code></a></li><li><a href="#PlantBiophysics.variables_typed-Tuple{T} where T&lt;:AbstractModel"><code>PlantBiophysics.variables_typed</code></a></li><li><a href="#PlantBiophysics.vars_not_init_-Union{Tuple{T}, Tuple{T, Any}} where T&lt;:Status"><code>PlantBiophysics.vars_not_init_</code></a></li><li><a href="#PlantBiophysics.vpd-Tuple{Any, Any}"><code>PlantBiophysics.vpd</code></a></li><li><a href="#PlantBiophysics.Γ_star"><code>PlantBiophysics.Γ_star</code></a></li><li><a href="#PlantBiophysics.γ_star-NTuple{6, Any}"><code>PlantBiophysics.γ_star</code></a></li><li><a href="#PlantBiophysics.λE_to_E"><code>PlantBiophysics.λE_to_E</code></a></li><li><a href="#PlantBiophysics.@gen_process_methods-Tuple{Any}"><code>PlantBiophysics.@gen_process_methods</code></a></li></ul><h2 id="API-documentation"><a class="docs-heading-anchor" href="#API-documentation">API documentation</a><a id="API-documentation-1"></a><a class="docs-heading-anchor-permalink" href="#API-documentation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="DataFrames.DataFrame-Tuple{T} where T&lt;:ModelList" href="#DataFrames.DataFrame-Tuple{T} where T&lt;:ModelList"><code>DataFrames.DataFrame</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">DataFrame(components::T) where {T&lt;:ModelList}</code></pre><p>Generic implementation of <code>DataFrame</code> for a single <code>ModelList</code> model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/dataframe.jl#LL31-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DataFrames.DataFrame-Tuple{T} where T&lt;:Union{AbstractArray{&lt;:ModelList}, ModelList}" href="#DataFrames.DataFrame-Tuple{T} where T&lt;:Union{AbstractArray{&lt;:ModelList}, ModelList}"><code>DataFrames.DataFrame</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">DataFrame(components &lt;: AbstractArray{&lt;:ModelList})
DataFrame(components &lt;: AbstractDict{N,&lt;:ModelList})</code></pre><p>Fetch the data from a <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a> (or an Array/Dict of) status into a DataFrame.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/dataframe.jl#LL1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DataFrames.DataFrame-Tuple{Weather}" href="#DataFrames.DataFrame-Tuple{Weather}"><code>DataFrames.DataFrame</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">DataFrame(data::Weather)</code></pre><p>Transform a Weather type into a DataFrame.</p><p>See also <a href="#PlantBiophysics.Weather"><code>Weather</code></a> to make the reverse.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/climate/weather.jl#LL96-L102">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DataFrames.DataFrame-Union{Tuple{ModelList{T, S}}, Tuple{S}, Tuple{T}} where {T, S&lt;:Status}" href="#DataFrames.DataFrame-Union{Tuple{ModelList{T, S}}, Tuple{S}, Tuple{T}} where {T, S&lt;:Status}"><code>DataFrames.DataFrame</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">DataFrame(components::ModelList{T,S}) where {T,S&lt;:AbstractDict}</code></pre><p>Implementation of <code>DataFrame</code> for a <code>ModelList</code> model with one time step.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/dataframe.jl#LL54-L58">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DataFrames.DataFrame-Union{Tuple{ModelList{T, S}}, Tuple{S}, Tuple{T}} where {T, S&lt;:TimeSteps}" href="#DataFrames.DataFrame-Union{Tuple{ModelList{T, S}}, Tuple{S}, Tuple{T}} where {T, S&lt;:TimeSteps}"><code>DataFrames.DataFrame</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">DataFrame(components::ModelList{T,&lt;:TimeSteps})</code></pre><p>Implementation of <code>DataFrame</code> for a <code>ModelList</code> model with several time steps.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/dataframe.jl#LL45-L49">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.AbstractAModel" href="#PlantBiophysics.AbstractAModel"><code>PlantBiophysics.AbstractAModel</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Assimilation (photosynthesis) abstract model. All photosynthesis models must be a subtype of this type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/photosynthesis.jl#LL1-L4">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.AbstractEnergyModel" href="#PlantBiophysics.AbstractEnergyModel"><code>PlantBiophysics.AbstractEnergyModel</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Energy balance abstract struct. All energy balance models must be a subtype of this type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/energy/energy_balance.jl#LL1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.AbstractGsModel" href="#PlantBiophysics.AbstractGsModel"><code>PlantBiophysics.AbstractGsModel</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Stomatal conductance abstract model. All stomatal conductance models must be a subtype of this type.</p><p>An AbstractGsModel subtype struct must implement at least a g0 field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/conductances/stomatal/stomatal_conductance.jl#LL1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.AbstractLightModel" href="#PlantBiophysics.AbstractLightModel"><code>PlantBiophysics.AbstractLightModel</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Light interception abstract struct. All light interception models must be a subtype of this.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/light/light_interception.jl#LL1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.AbstractModel" href="#PlantBiophysics.AbstractModel"><code>PlantBiophysics.AbstractModel</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Abstract model type. All models are subtypes of this one, see <em>e.g.</em> <a href="#PlantBiophysics.AbstractAModel"><code>AbstractAModel</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/Abstract_model_structs.jl#LL1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.Atmosphere" href="#PlantBiophysics.Atmosphere"><code>PlantBiophysics.Atmosphere</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Atmosphere structure to hold all values related to the meteorology / atmosphere.</p><p><strong>Arguments</strong></p><ul><li><code>date = Dates.now()</code>: the date of the record.</li><li><code>duration = 1.0</code> (seconds): the duration of the time-step.</li><li><code>T</code> (°C): air temperature</li><li><code>Wind</code> (m s-1): wind speed</li><li><code>P = 101.325</code> (kPa): air pressure. The default value is at 1 atm, <em>i.e.</em> the mean sea-level</li></ul><p>atmospheric pressure on Earth.</p><ul><li><code>Rh = rh_from_vpd(VPD,eₛ)</code> (0-1): relative humidity</li><li><code>Cₐ</code> (ppm): air CO₂ concentration</li><li><code>e = vapor_pressure(T,Rh)</code> (kPa): vapor pressure</li><li><code>eₛ = e_sat(T)</code> (kPa): saturated vapor pressure</li><li><code>VPD = eₛ - e</code> (kPa): vapor pressure deficit</li><li><code>ρ = air_density(T, P, constants.Rd, constants.K₀)</code> (kg m-3): air density</li><li><code>λ = latent_heat_vaporization(T, constants.λ₀)</code> (J kg-1): latent heat of vaporization</li><li><code>γ = psychrometer_constant(P, λ, constants.Cₚ, constants.ε)</code> (kPa K−1): psychrometer &quot;constant&quot;</li><li><code>ε = atmosphere_emissivity(T,e,constants.K₀)</code> (0-1): atmosphere emissivity</li><li><code>Δ = e_sat_slope(meteo.T)</code> (0-1): slope of the saturation vapor pressure at air temperature</li><li><code>clearness::A = 9999.9</code> (0-1): Sky clearness</li><li><code>Ri_SW_f::A = 9999.9</code> (W m-2): Incoming short wave radiation flux</li><li><code>Ri_PAR_f::A = 9999.9</code> (W m-2): Incoming PAR flux</li><li><code>Ri_NIR_f::A = 9999.9</code> (W m-2): Incoming NIR flux</li><li><code>Ri_TIR_f::A = 9999.9</code> (W m-2): Incoming TIR flux</li><li><code>Ri_custom_f::A = 9999.9</code> (W m-2): Incoming radiation flux for a custom waveband</li></ul><p><strong>Notes</strong></p><p>The structure can be built using only <code>T</code>, <code>Rh</code>, <code>Wind</code> and <code>P</code>. All other variables are optional and either let at their default value or automatically computed using the functions given in <code>Arguments</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/climate/atmosphere.jl#LL8-L46">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.Beer" href="#PlantBiophysics.Beer"><code>PlantBiophysics.Beer</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Beer(k)</code></pre><p>Beer-Lambert law for light interception.</p><p>Required inputs: <code>LAI</code> in m² m⁻². Required meteorology data: <code>Ri_PAR_f</code>, the incident flux of atmospheric radiation in the PAR, in W m[soil]⁻² (== J m[soil]⁻² s⁻¹).</p><p>Output: PPFD, the absorbed Photosynthetic Photon Flux Density in μmol[PAR] m[leaf]⁻² s⁻¹.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/light/Beer.jl#LL1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.ConstantA" href="#PlantBiophysics.ConstantA"><code>PlantBiophysics.ConstantA</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Constant (forced) assimilation, given in <span>$μmol\ m^{-2}\ s^{-1}$</span>.</p><p>See also <a href="#PlantBiophysics.ConstantAGs"><code>ConstantAGs</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">ConstantA(30.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/constantA.jl#LL2-L13">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.ConstantAGs" href="#PlantBiophysics.ConstantAGs"><code>PlantBiophysics.ConstantAGs</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Constant (forced) assimilation, given in <span>$μmol\ m^{-2}\ s^{-1}$</span>, coupled with a stomatal conductance model that helps computing Cᵢ.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">ConstantAGs(30.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/constantAGs.jl#LL2-L11">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.ConstantGs" href="#PlantBiophysics.ConstantGs"><code>PlantBiophysics.ConstantGs</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Constant stomatal conductance for CO₂ struct.</p><p><strong>Arguments</strong></p><ul><li><code>g0</code>: intercept (only used when calling from a photosynthesis model, <em>e.g.</em> Fvcb).</li><li><code>Gₛ</code>: stomatal conductance.</li></ul><p>Then used as follows: Gs = ConstantGs(0.0,0.1)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/conductances/stomatal/constantGs.jl#LL2-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.Constants" href="#PlantBiophysics.Constants"><code>PlantBiophysics.Constants</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Physical constants</p><p>The definition and default values are:</p><ul><li><code>K₀ = -273.15</code>: absolute zero (°C)</li><li><code>R = 8.314</code>: universal gas constant (<span>$J\ mol^{-1}\ K^{-1}$</span>).</li><li><code>Rd = 287.0586</code>: gas constant of dry air (<span>$J\ kg^{-1}\ K^{-1}$</span>).</li><li><code>Dₕ₀ = 21.5e-6</code>: molecular diffusivity for heat at base temperature, applied in the integrated form of the   Fick’s Law of diffusion (<span>$m^2\ s^{-1}$</span>). See eq. 3.10 from Monteith and Unsworth (2013).</li><li><code>Cₚ = 1013.0</code>: Specific heat of air at constant pressure (<span>$J\ K^{-1}\ kg^{-1}$</span>), also   known as efficiency of impaction of particles. See Allen et al. (1998), or Monteith and   Unsworth (2013). NB: bigleaf R package uses 1004.834 intead.</li><li><code>ε = 0.622</code>: ratio of molecular weights of water vapor and air. See Monteith and   Unsworth (2013).</li><li><code>λ₀ = 2.501</code>: latent heat of vaporization for water at 0 degree (<span>$J\ kg^{-1}$</span>).</li><li><code>σ = 5.670373e-08</code> <a href="https://en.wikipedia.org/wiki/Stefan%E2%80%93Boltzmann_law">Stefan-Boltzmann constant</a>   in (<span>$W\ m^{-2}\ K^{-4}$</span>).</li><li><code>Gbₕ_to_Gbₕ₂ₒ = 1.075</code>: conversion coefficient from conductance to heat to conductance to water   vapor.</li><li><code>Gsc_to_Gsw = 1.57</code>: conversion coefficient from stomatal conductance to CO₂ to conductance to water   vapor.</li><li><code>Gbc_to_Gbₕ = 1.32</code>: conversion coefficient from boundary layer conductance to CO₂ to heat.</li><li><code>Mₕ₂ₒ = 18.0e-3</code> (kg mol-1): Molar mass for water.</li></ul><p><strong>References</strong></p><p>Allen, Richard G., Luis S. Pereira, Dirk Raes, et Martin J Fao Smith. 1998. « Crop evapotranspiration-Guidelines for computing crop water requirements-FAO Irrigation and drainage paper 56 » 300 (9): D05109.</p><p>Monteith, John, et Mike Unsworth. 2013. Principles of environmental physics: plants, animals, and the atmosphere. Academic Press.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/constants.jl#LL1-L34">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.Fvcb" href="#PlantBiophysics.Fvcb"><code>PlantBiophysics.Fvcb</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Farquhar–von Caemmerer–Berry (FvCB) model for C3 photosynthesis (Farquhar et al., 1980; von Caemmerer and Farquhar, 1981) coupled with a conductance model.</p><p>The definition:</p><ul><li><code>Tᵣ</code>: the reference temperature (°C) at which other parameters were measured</li><li><code>VcMaxRef</code>: maximum rate of Rubisco activity (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>JMaxRef</code>: potential rate of electron transport (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>RdRef</code>: mitochondrial respiration in the light at reference temperature (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>TPURef</code>: triose phosphate utilization-limited photosynthesis rate (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>Eₐᵣ</code>: activation energy (<span>$J\ mol^{-1}$</span>), or the exponential rate of rise for Rd.</li><li><code>O₂</code>: intercellular dioxygen concentration (<span>$ppm$</span>)</li><li><code>Eₐⱼ</code>: activation energy (<span>$J\ mol^{-1}$</span>), or the exponential rate of rise for JMax.</li><li><code>Hdⱼ</code>: rate of decrease of the function above the optimum (also called EDVJ) for JMax.</li><li><code>Δₛⱼ</code>: entropy factor for JMax.</li><li><code>Eₐᵥ</code>: activation energy (<span>$J\ mol^{-1}$</span>), or the exponential rate of rise for VcMax.</li><li><code>Hdᵥ</code>: rate of decrease of the function above the optimum (also called EDVC) for VcMax.</li><li><code>Δₛᵥ</code>: entropy factor for VcMax.</li><li><code>α</code>: quantum yield of electron transport (<span>$mol_e\ mol^{-1}_{quanta}$</span>). See also eq. 4 of</li></ul><p>Medlyn et al. (2002) and its implementation in <a href="#PlantBiophysics.get_J-NTuple{4, Any}"><code>get_J</code></a></p><ul><li><code>θ</code>: determines the curvature of the light response curve for <code>J~PPFD</code>. See also eq. 4 of</li></ul><p>Medlyn et al. (2002) and its implementation in <a href="#PlantBiophysics.get_J-NTuple{4, Any}"><code>get_J</code></a></p><p>The default values of the temperature correction parameters are taken from <a href="https://remkoduursma.github.io/plantecophys/">plantecophys</a>. If there is no negative effect of high temperatures on the reaction (Jmax or VcMax), then Δₛ can be set to 0.0.</p><p>θ is taken at 0.7 according to (Von Caemmerer, 2000) but it can be modified to 0.9 as in (Su et al., 2009). The larger it is, the lower the smoothing.</p><p>α is taken at 0.24 as in the R package <code>plantecophys</code> (Duursma, 2015).</p><p><strong>Note</strong></p><p>Medlyn et al. (2002) found relatively low influence (&quot;a slight effect&quot;) of α and θ. They also say that Kc, Ko and Γ* &quot;are thought to be intrinsic properties of the Rubisco enzyme and are generally assumed constant among species&quot;.</p><p><strong>See also</strong></p><ul><li><a href="#PlantBiophysics.FvcbRaw"><code>FvcbRaw</code></a> for non-coupled model, directly from Farquhar et al. (1980)</li><li><a href="#PlantBiophysics.FvcbIter"><code>FvcbIter</code></a> for the coupled assimilation / conductance model with an iterative resolution</li><li><a href="#PlantBiophysics.get_J-NTuple{4, Any}"><code>get_J</code></a></li><li><a href="#PlantBiophysics.photosynthesis"><code>photosynthesis</code></a></li></ul><p><strong>References</strong></p><p>Caemmerer, S. von, et G. D. Farquhar. 1981. « Some Relationships between the Biochemistry of Photosynthesis and the Gas Exchange of Leaves ». Planta 153 (4): 376‑87. https://doi.org/10.1007/BF00384257.</p><p>Farquhar, G. D., S. von von Caemmerer, et J. A. Berry. 1980. « A biochemical model of photosynthetic CO2 assimilation in leaves of C3 species ». Planta 149 (1): 78‑90.</p><p>Medlyn, B. E., E. Dreyer, D. Ellsworth, M. Forstreuter, P. C. Harley, M. U. F. Kirschbaum, X. Le Roux, et al. 2002. « Temperature response of parameters of a biochemically based model of photosynthesis. II. A review of experimental data ». Plant, Cell &amp; Environment 25 (9): 1167‑79. https://doi.org/10.1046/j.1365-3040.2002.00891.x.</p><p>Su, Y., Zhu, G., Miao, Z., Feng, Q. and Chang, Z. 2009. « Estimation of parameters of a biochemically based model of photosynthesis using a genetic algorithm ». Plant, Cell &amp; Environment, 32: 1710-1723. https://doi.org/10.1111/j.1365-3040.2009.02036.x.</p><p>Von Caemmerer, Susanna. 2000. Biochemical models of leaf photosynthesis. Csiro publishing.</p><p>Duursma, R. A. 2015. « Plantecophys - An R Package for Analysing and Modelling Leaf Gas Exchange Data ». PLoS ONE 10(11): e0143346. https://doi:10.1371/journal.pone.0143346.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">Get the fieldnames:
fieldnames(Fvcb)
# Using default values for the model:
A = Fvcb()

A.Eₐᵥ</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/FvCB.jl#LL2-L82">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.FvcbIter" href="#PlantBiophysics.FvcbIter"><code>PlantBiophysics.FvcbIter</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Farquhar–von Caemmerer–Berry (FvCB) model for C3 photosynthesis (Farquhar et al., 1980; von Caemmerer and Farquhar, 1981).</p><p>Iterative implementation, i.e. the assimilation is computed iteratively over Cᵢ.</p><p>For more details on arguments, see <a href="#PlantBiophysics.Fvcb"><code>Fvcb</code></a>. This structure has several more parameters:</p><ul><li><code>iter_A_max::Int</code>: maximum number of iterations allowed for the iteration on the assimilation.</li><li><code>ΔT_A::T = 1</code>: threshold bellow which the assimilation is considered constant. Given in</li></ul><p>percent of change, <em>i.e.</em> 1% means that two successive assimilations with less than 1% difference in value are considered the same value.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/FvCBIter.jl#LL2-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.FvcbRaw" href="#PlantBiophysics.FvcbRaw"><code>PlantBiophysics.FvcbRaw</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Farquhar–von Caemmerer–Berry (FvCB) model for C3 photosynthesis (Farquhar et al., 1980; von Caemmerer and Farquhar, 1981). Direct implementation of the model.</p><p>See <a href="#PlantBiophysics.Fvcb"><code>Fvcb</code></a> for more details.</p><p><strong>See also</strong></p><ul><li><a href="#PlantBiophysics.Fvcb"><code>Fvcb</code></a> for the coupled assimilation / conductance model</li><li><a href="#PlantBiophysics.FvcbIter"><code>FvcbIter</code></a> for the coupled assimilation / conductance model with an iterative resolution</li><li><a href="#PlantBiophysics.get_J-NTuple{4, Any}"><code>get_J</code></a></li><li><a href="#PlantBiophysics.photosynthesis"><code>photosynthesis</code></a></li></ul><p><strong>References</strong></p><p>Caemmerer, S. von, et G. D. Farquhar. 1981. « Some Relationships between the Biochemistry of Photosynthesis and the Gas Exchange of Leaves ». Planta 153 (4): 376‑87. https://doi.org/10.1007/BF00384257.</p><p>Farquhar, G. D., S. von von Caemmerer, et J. A. Berry. 1980. « A biochemical model of photosynthetic CO2 assimilation in leaves of C3 species ». Planta 149 (1): 78‑90.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">Get the fieldnames:
fieldnames(FvcbRaw)
# Using default values for the model:
A = FvcbRaw()

A.Eₐᵥ</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/FvCBRaw.jl#LL2-L34">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.Ignore" href="#PlantBiophysics.Ignore"><code>PlantBiophysics.Ignore</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Ignore model for light interception, see <a href="https://archimed-platform.github.io/archimed-phys-user-doc/3-inputs/5-models/2-models_list/">here</a>. Make the mesh invisible, and not computed. Can save a lot of time for the computations when there are components types that are not visible anyway (e.g. inside others).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/light/Ignore.jl#LL1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.Medlyn" href="#PlantBiophysics.Medlyn"><code>PlantBiophysics.Medlyn</code></a> — <span class="docstring-category">Type</span></header><section><div><p>struct to hold the parameters for Medlyn et al. (2011) stomatal conductance model for CO₂.</p><p><strong>Arguments</strong></p><ul><li><code>g0</code>: intercept.</li><li><code>g1</code>: slope.</li><li><code>gs_min = 0.001</code>: residual conductance. We consider the residual conductance being different   from <code>g0</code> because in practice <code>g0</code> can be negative when fitting real-world data.</li></ul><p><strong>Usage</strong></p><p>Then used for example as follows:</p><pre><code class="language-julia hljs">Gs = Medlyn(0.03,0.1)
gs_mod = stomatal_conductance(Gs,(Cₛ = 400.0, VPD = 1.5))
Gₛ = Gs.g0 + gs_mod * A</code></pre><p><strong>Examples</strong></p><pre><code class="language-julia hljs">meteo = Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)

leaf =
    ModelList(
        stomatal_conductance = Medlyn(0.03, 12.0),
        status = (A = A, Cₛ = 380.0, Dₗ = meteo.VPD)
    )
stomatal_conductance(leaf,meteo)</code></pre><p><strong>References</strong></p><p>Medlyn, Belinda E., Remko A. Duursma, Derek Eamus, David S. Ellsworth, I. Colin Prentice, Craig V. M. Barton, Kristine Y. Crous, Paolo De Angelis, Michael Freeman, et Lisa Wingate.</p><ol><li>« Reconciling the optimal and empirical approaches to modelling stomatal conductance ».</li></ol><p>Global Change Biology 17 (6): 2134‑44. https://doi.org/10.1111/j.1365-2486.2010.02375.x.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/conductances/stomatal/medlyn.jl#LL1-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.ModelList" href="#PlantBiophysics.ModelList"><code>PlantBiophysics.ModelList</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ModelList(models::M, status::S)
ModelList(;
    status=MutableNamedTuple(),
    status_type=MutableNamedTuple,
    type_promotion=nothing,
    variables_check=true,
    kwargs...
)</code></pre><p>A structure used to list the models for a simulation (<code>models</code>), and the associated initialized variables (<code>status</code>).</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The status field depends on the input models. You can get the variables needed by a model using <a href="#PlantBiophysics.variables-Tuple{}"><code>variables</code></a> on the instantiation of a model. You can also use <a href="#PlantBiophysics.inputs-Tuple{T} where T&lt;:AbstractModel"><code>inputs</code></a> and <a href="#PlantBiophysics.outputs-Tuple{T} where T&lt;:AbstractModel"><code>outputs</code></a> instead.</p></div></div><p><strong>Arguments</strong></p><pre><code class="nohighlight hljs">- `models`: a list of models to be used in the simulation. Usually a `NamedTuple`, but
can be any other structure that implements `getproperty`.
- `status`: a structure containing the initializations for the variables for the models.
- `status_type`: the type of the status structure. `MutableNamedTuple` by default.
- `type_promotion`: optional type conversion for the variables with default values.
`nothing` by default, *i.e.* no conversion. Note that conversion is not applied to the
variables input by the user as `kwargs` (need to do it manually).
Should be provided as a Dict with current type as keys and new type as values.
- `variables_check=true`: check that all needed variables are initialized by the user.
- `kwargs`: the models, named after the process they simulate.</code></pre><p><strong>Examples</strong></p><p>A leaf with a width of 0.03 m, that uses the Monteith and Unsworth (2013) model for energy balance, the Farquhar et al. (1980) model for photosynthesis, and a constant stomatal conductance for CO₂ of 0.0011 with no residual conductance.</p><pre><code class="language- hljs">using PlantBiophysics</code></pre><pre><code class="language- hljs">leaf = ModelList(
    energy_balance = Monteith(),
    photosynthesis = Fvcb(),
    stomatal_conductance = ConstantGs(0.0, 0.0011)
)</code></pre><p>No variables were given as keyword arguments, that means that the status of the leaf is not set yet, and all variables are initialized to <code>typemin(Type)</code>, <em>i.e.</em> <code>-Inf</code> for floating point numbers. This component cannot be simulated yet.</p><p>To know which variables we need to initialize for a simulation, we use <a href="#PlantBiophysics.to_initialize-Tuple{ModelList}"><code>to_initialize</code></a>:</p><pre><code class="language- hljs">to_initialize(leaf)</code></pre><p>The meaning and units of the variables can be found on the documentation of each model, <em>e.g.</em> <a href="https://vezy.github.io/PlantBiophysics.jl/stable/models/photosynthesis/">here for photosynthesis</a>.</p><p>We can now provide values for these variables:</p><pre><code class="language- hljs">leaf = ModelList(
    energy_balance = Monteith(),
    photosynthesis = Fvcb(),
    stomatal_conductance = ConstantGs(0.0, 0.0011),
    status = (Rₛ = 13.747, sky_fraction = 1.0, d = 0.03, PPFD = 1500)
)</code></pre><p>We can now simulate the leaf, <em>e.g.</em> for the energy_balance (coupled to photosynthesis and stomatal conductance):</p><pre><code class="language- hljs">meteo = Atmosphere(T = 22.0, Wind = 0.8333, P = 101.325, Rh = 0.4490995)

energy_balance!(leaf,meteo)

DataFrame(leaf)</code></pre><p>If we want to use special types for the variables, we can use the <code>type_promotion</code> argument:</p><pre><code class="language- hljs">leaf = ModelList(
    energy_balance = Monteith(),
    photosynthesis = Fvcb(),
    stomatal_conductance = ConstantGs(0.0, 0.0011),
    status = (Rₛ = 13.747, sky_fraction = 1.0, d = 0.03, PPFD = 1500),
    type_promotion = Dict(Float64 =&gt; Float32)
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/component_models/ModelList.jl#LL2-L98">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.Monteith" href="#PlantBiophysics.Monteith"><code>PlantBiophysics.Monteith</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Struct to hold parameter and values for the energy model close to the one in Monteith and Unsworth (2013)</p><p><strong>Arguments</strong></p><ul><li><code>aₛₕ = 2</code>: number of faces of the object that exchange sensible heat fluxes</li><li><code>aₛᵥ = 1</code>: number of faces of the object that exchange latent heat fluxes (hypostomatous =&gt; 1)</li><li><code>ε = 0.955</code>: emissivity of the object</li><li><code>maxiter = 10</code>: maximal number of iterations allowed to close the energy balance</li><li><code>ΔT = 0.01</code> (°C): maximum difference in object temperature between two iterations to consider convergence</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">energy_model = Monteith() # a leaf in an illuminated chamber</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/energy/Monteith.jl#LL1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.OpticalProperties" href="#PlantBiophysics.OpticalProperties"><code>PlantBiophysics.OpticalProperties</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Optical properties abstract struct</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/light/Translucent.jl#LL1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.Status" href="#PlantBiophysics.Status"><code>PlantBiophysics.Status</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Status(vars)</code></pre><p>Status type used to store the values of the variables during simulation. It is mainly used as the structure to store the variables in the status field of a <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a>.</p><p><strong>See also</strong></p><p><a href="#PlantBiophysics.TimeSteps"><code>TimeSteps</code></a> for several time steps.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># A leaf with one value for all variables will make a status with one time step:
leaf = ModelList(
    photosynthesis = Fvcb(),
    stomatal_conductance = Medlyn(0.03, 12.0),
    status=(Tₗ=25.0, PPFD=1000.0, Cₛ=400.0, Dₗ=1.0)
)

# Indexing the model list with a symbol will return the value of the variable:
leaf[:Tₗ]

# Indexing the model list with an integer will always return the first time step, as there
is only one, and because we want a similar interface with TimeSteps:
leaf[1]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/component_models/Status.jl#LL7-L34">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.TimeSteps" href="#PlantBiophysics.TimeSteps"><code>PlantBiophysics.TimeSteps</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">TimeSteps(vars)</code></pre><p>TimeSteps is the same than <a href="#PlantBiophysics.Status"><code>Status</code></a> but for simulation with several time steps. It is used to store the values of the variables during a simulation, and is mainly used as the structure in the status field of the <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a> type.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># A leaf with several values for at least one of its variable will make a status with
# several time steps:
leaf = ModelList(
    photosynthesis = Fvcb(),
    stomatal_conductance = Medlyn(0.03, 12.0),
    status=(Tₗ=[25.0, 26.0], PPFD=1000.0, Cₛ=400.0, Dₗ=1.0)
)

# Indexing the model list with an integer will return the first time step:
leaf[1]

# Indexing the model list with a symbol will return the variable with all time steps:
leaf[:Tₗ]

# If you need the value for one variable at one time step, prefer using this (5x faster):
leaf[1].Tₗ

# Rather than this (5x slower):
leaf[:Tₗ][1]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/component_models/Status.jl#LL72-L102">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.Translucent" href="#PlantBiophysics.Translucent"><code>PlantBiophysics.Translucent</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Translucent model for light interception, see <a href="https://archimed-platform.github.io/archimed-phys-user-doc//3-inputs/5-models/2-models_list/">here</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/light/Translucent.jl#LL18-L20">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.Weather" href="#PlantBiophysics.Weather"><code>PlantBiophysics.Weather</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Weather(D &lt;: AbstractArray{&lt;:AbstractAtmosphere}[, S])
Weather(df::DataFrame[, mt])</code></pre><p>Defines the weather, <em>i.e.</em> the local conditions of the Atmosphere for one or more time-steps. Each time-step is described using the <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a> structure.</p><p>The simplest way to instantiate a <code>Weather</code> is to use a <code>DataFrame</code> as input.</p><p>The <code>DataFrame</code> should be formated such as each row is an observation for a given time-step and each column is a variable. The column names should match exactly the field names of the <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a> structure, <code>i.e.</code>:</p><pre><code class="language- hljs">fieldnames(Atmosphere)</code></pre><p><strong>See also</strong></p><ul><li>the <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a> structure</li><li>the <a href="#PlantBiophysics.read_weather-Tuple{Any, Vararg{Any}}"><code>read_weather</code></a> function to read Archimed-formatted meteorology data.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Example of weather data defined by hand (cumbersome):
w = Weather(
    [
        Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65),
        Atmosphere(T = 23.0, Wind = 1.5, P = 101.3, Rh = 0.60),
        Atmosphere(T = 25.0, Wind = 3.0, P = 101.3, Rh = 0.55)
    ],
    (
        site = &quot;Test site&quot;,
        important_metadata = &quot;this is important and will be attached to our weather data&quot;
    )
)

# Example using a DataFrame, that you would usually import from a file:
using CSV, DataFrames
file = joinpath(dirname(dirname(pathof(PlantBiophysics))),&quot;test&quot;,&quot;inputs&quot;,&quot;meteo.csv&quot;)
df = CSV.read(file, DataFrame; header=5, datarow = 6)
# Select and rename the variables:
select!(df, :date, :VPD, :temperature =&gt; :T, :relativeHumidity =&gt; :Rh, :wind =&gt; :Wind, :atmosphereCO2_ppm =&gt; :Cₐ)
df[!,:duration] .= 1800 # Add the time-step duration, 30min

# Make the weather, and add some metadata:
Weather(df, (site = &quot;Aquiares&quot;, file = file))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/climate/weather.jl#LL1-L50">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.σ" href="#PlantBiophysics.σ"><code>PlantBiophysics.σ</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">σ()</code></pre><p>σ, the scattering factor of a component. See <a href="https://archimed-platform.github.io/archimed-phys-user-doc/3-inputs/5-models/2-models_list/#translucent">here</a> for more details</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/light/Translucent.jl#LL6-L11">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.copy-Tuple{T} where T&lt;:(AbstractArray{&lt;:ModelList})" href="#Base.copy-Tuple{T} where T&lt;:(AbstractArray{&lt;:ModelList})"><code>Base.copy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Base.copy(l::AbstractArray{&lt;:ModelList})</code></pre><p>Copy an array-alike of <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/component_models/copy.jl#LL4-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.copy-Tuple{T} where T&lt;:(AbstractDict{N, &lt;:ModelList} where N)" href="#Base.copy-Tuple{T} where T&lt;:(AbstractDict{N, &lt;:ModelList} where N)"><code>Base.copy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Base.copy(l::AbstractDict{N,&lt;:ModelList} where N)</code></pre><p>Copy a Dict-alike <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/component_models/copy.jl#LL13-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.copy-Tuple{T} where T&lt;:ModelList" href="#Base.copy-Tuple{T} where T&lt;:ModelList"><code>Base.copy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Base.copy(l::ModelList)
Base.copy(l::ModelList, status)</code></pre><p>Copy a <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a>, eventually with new values for the status.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/component_models/ModelList.jl#LL178-L183">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.getindex-Union{Tuple{T}, Tuple{T, Any}} where T&lt;:ModelList" href="#Base.getindex-Union{Tuple{T}, Tuple{T, Any}} where T&lt;:ModelList"><code>Base.getindex</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">getindex(component&lt;:ModelList, key::Symbol)
getindex(component&lt;:ModelList, key)</code></pre><p>Indexing a component models structure:     - with an integer, will return the status at the ith time-step     - with anything else (Symbol, String) will return the required variable from the status</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">lm = ModelList(
    energy_balance = Monteith(),
    photosynthesis = Fvcb(),
    stomatal_conductance = ConstantGs(0.0, 0.0011),
    status = (Cᵢ = 380.0, Tₗ = [20.0, 25.0])
)

lm[:Tₗ] # Returns the value of the Tₗ variable
lm[2]  # Returns the status at the second time-step
lm[2][:Tₗ] # Returns the value of Tₗ at the second time-step
lm[:Tₗ][2] # Equivalent of the above</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/component_models/get_status.jl#LL32-L55">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.EF-Tuple{Any, Any}" href="#PlantBiophysics.EF-Tuple{Any, Any}"><code>PlantBiophysics.EF</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">EF(obs,sim)

Returns the Efficiency Factor between observations `obs` and simulations `sim` using NSE (Nash-Sutcliffe efficiency) model.
More information can be found at https://en.wikipedia.org/wiki/Nash%E2%80%93Sutcliffe_model_efficiency_coefficient.

The closer to 1 the better.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/evaluation/statistics.jl#LL25-L32">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.Fvcb_net_assimiliation-NTuple{6, Any}" href="#PlantBiophysics.Fvcb_net_assimiliation-NTuple{6, Any}"><code>PlantBiophysics.Fvcb_net_assimiliation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Fvcb_net_assimiliation(Cᵢ,Vⱼ,Γˢ,VcMax,Km,Rd)</code></pre><p>Net assimilation following the Farquhar–von Caemmerer–Berry (FvCB) model for C3 photosynthesis (Farquhar et al., 1980; von Caemmerer and Farquhar, 1981)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/FvCBIter.jl#LL197-L202">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.RMSE-Tuple{Any, Any}" href="#PlantBiophysics.RMSE-Tuple{Any, Any}"><code>PlantBiophysics.RMSE</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">RMSE(obs,sim)

Returns the Root Mean Squared Error between observations `obs` and simulations `sim`.

The closer to 0 the better.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/evaluation/statistics.jl#LL2-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.air_density-NTuple{4, Any}" href="#PlantBiophysics.air_density-NTuple{4, Any}"><code>PlantBiophysics.air_density</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">air_density(Tₐ, P)
air_density(Tₐ, P, Rd, K₀)</code></pre><p>ρ, the air density (kg m-3).</p><p><strong>Arguments</strong></p><ul><li><code>Tₐ</code> (Celsius degree): air temperature</li><li><code>P</code> (kPa): air pressure</li><li><code>Rd</code> (J kg-1 K-1): gas constant of dry air (see Foken p. 245, or R bigleaf package).</li><li><code>K₀</code> (Celsius degree): temperature in Celsius degree at 0 Kelvin</li></ul><p><strong>Note</strong></p><p>Rd and K₀ are Taken from <a href="#PlantBiophysics.Constants"><code>Constants</code></a> if not provided.</p><p><strong>References</strong></p><p>Foken, T, 2008: Micrometeorology. Springer, Berlin, Germany.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/climate/variables_computations.jl#LL31-L51">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.arrhenius" href="#PlantBiophysics.arrhenius"><code>PlantBiophysics.arrhenius</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">arrhenius(A,Eₐ,Tₖ,Tᵣₖ,R = Constants().R)</code></pre><p>The Arrhenius function for dependence of the rate constant of a chemical reaction.</p><p><strong>Arguments</strong></p><ul><li><code>A</code>: pre-exponential factor, a constant for each chemical reaction</li><li><code>Eₐ</code>: activation energy for the reaction (<span>$J\ mol^{-1}$</span>)</li><li><code>Tₖ</code>: temperature (Kelvin)</li><li><code>Tᵣₖ</code>: reference temperature (Kelvin) at which A was measured</li><li><code>R</code>: universal gas constant (<span>$J\ mol^{-1}\ K^{-1}$</span>)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Importing physical constants
constants = Constants()
# Using default values for the model:
A = Fvcb()

# Computing Jmax:
arrhenius(A.JMaxRef,A.Eₐⱼ,28.0-constants.K₀,A.Tᵣ-constants.K₀,constants.R)
# ! Warning: temperatures must be given in Kelvin

# Computing Vcmax:
arrhenius(A.VcMaxRef,A.Eₐᵥ,28.0-constants.K₀,A.Tᵣ-constants.K₀,constants.R)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/temperature-dependence.jl#LL1-L29">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.arrhenius" href="#PlantBiophysics.arrhenius"><code>PlantBiophysics.arrhenius</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">arrhenius(A,Eₐ,Tₖ,Tᵣₖ,Hd,Δₛ,R = Constants().R)</code></pre><p>The Arrhenius function for dependence of the rate constant of a chemical reaction, modified following equation (17) from Medlyn et al. (2002) to consider the negative effect of very high temperatures.</p><p><strong>Arguments</strong></p><ul><li><code>A</code>: the pre-exponential factor, a constant for each chemical reaction</li><li><code>Eₐ</code>: activation energy (<span>$J\ mol^{-1}$</span>), or the exponential rate of rise</li></ul><p>of the function (Ha in the equation of Medlyn et al. (2002))</p><ul><li><code>Tₖ</code>: current temperature (Kelvin)</li><li><code>Tᵣₖ</code>: reference temperature (Kelvin) at which A was measured</li><li><code>Hd</code>: rate of decrease of the function above the optimum (called EDVJ in</li></ul><p><a href="http://maespa.github.io/">MAESPA</a> and <a href="https://remkoduursma.github.io/plantecophys/">plantecophys</a>)</p><ul><li><code>Δₛ</code>: entropy factor</li><li><code>R</code>: is the universal gas constant (<span>$J\ mol^{-1}\ K^{-1}$</span>)</li></ul><p>References</p><p>Medlyn, B. E., E. Dreyer, D. Ellsworth, M. Forstreuter, P. C. Harley, M. U. F. Kirschbaum, X. Le Roux, et al. 2002. « Temperature response of parameters of a biochemically based model of photosynthesis. II. A review of experimental data ». Plant, Cell &amp; Environment 25 (9): 1167‑79. https://doi.org/10.1046/j.1365-3040.2002.00891.x.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Importing physical constants
constants = Constants()
# Using default values for the model:
A = Fvcb()

# Computing Jmax:
PlantBiophysics.arrhenius(A.JMaxRef,A.Eₐⱼ,28.0-constants.K₀,A.Tᵣ-constants.K₀,A.Hdⱼ,A.Δₛⱼ)
# ! Warning: temperatures must be given in Kelvin

# Computing Vcmax:
PlantBiophysics.arrhenius(A.VcMaxRef,A.Eₐᵥ,28.0-constants.K₀,A.Tᵣ-constants.K₀,A.Hdᵥ,A.Δₛᵥ)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/temperature-dependence.jl#LL35-L78">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.black_body-Tuple{Any, Any, Any}" href="#PlantBiophysics.black_body-Tuple{Any, Any, Any}"><code>PlantBiophysics.black_body</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">black_body(T, K₀, σ)
black_body(T)</code></pre><p>Thermal infrared, <em>i.e.</em> longwave radiation emitted from a black body at temperature T.</p><ul><li><code>T</code>: temperature of the object in Celsius degree</li><li><code>K₀</code>: absolute zero (°C)</li><li><code>σ</code> (<span>$W\ m^{-2}\ K^{-4}$</span>) <a href="https://en.wikipedia.org/wiki/Stefan%E2%80%93Boltzmann_law">Stefan-Boltzmann constant</a></li></ul><p><strong>Note</strong></p><p><code>K₀</code> and <code>σ</code> are taken from <a href="#PlantBiophysics.Constants"><code>Constants</code></a> if not provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/energy/longwave_energy.jl#LL1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.dep-Tuple{}" href="#PlantBiophysics.dep-Tuple{}"><code>PlantBiophysics.dep</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dep(models::ModelList; verbose::Bool=true)</code></pre><p>Get the model dependency tree given a ModelList. If one tree is returned, then all models are coupled. If several trees are returned, then only the models inside each tree are coupled, and the models in different trees are not coupled.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/models_dependency.jl#LL27-L33">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.dr-Tuple{Any, Any}" href="#PlantBiophysics.dr-Tuple{Any, Any}"><code>PlantBiophysics.dr</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dr(obs,sim)

Returns the Willmott’s refined index of agreement dᵣ.
Willmot et al. 2011. A refined index of model performance. https://rmets.onlinelibrary.wiley.com/doi/10.1002/joc.2419

The closer to 1 the better.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/evaluation/statistics.jl#LL39-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.e_sat-Tuple{Any}" href="#PlantBiophysics.e_sat-Tuple{Any}"><code>PlantBiophysics.e_sat</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">e_sat(T)</code></pre><p>Saturated water vapour pressure (es, in kPa) at given temperature <code>T</code> (°C). See Jones (1992) p. 110 for the equation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/climate/variables_computations.jl#LL11-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.e_sat_slope-Tuple{Any}" href="#PlantBiophysics.e_sat_slope-Tuple{Any}"><code>PlantBiophysics.e_sat_slope</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">e_sat_slope(T)</code></pre><p>Slope of the vapor pressure saturation curve at a given temperature <code>T</code> (°C).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/climate/variables_computations.jl#LL21-L25">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.energy_balance" href="#PlantBiophysics.energy_balance"><code>PlantBiophysics.energy_balance</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">energy_balance(object, meteo, constants = Constants())
energy_balance!(object, meteo, constants = Constants())</code></pre><p>Computes the energy balance of one or several components based on the type of the model it was parameterized with in <code>object.energy_balance</code>, and on one or several meteorology time-steps.</p><p>At the moment, two models are implemented in the package:</p><ul><li><a href="#PlantBiophysics.Monteith"><code>Monteith</code></a>: the model found in Monteith and Unsworth (2013)</li><li><code>Missing</code>: if no computation of the energy balance is needed</li></ul><p><strong>Arguments</strong></p><ul><li><code>object</code>: a <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a>, a Dict/Array of <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a>, or an MTG.</li><li><code>meteo::Union{AbstractAtmosphere,Weather}</code>: meteorology structure, see <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a> or</li></ul><p><a href="#PlantBiophysics.Weather"><code>Weather</code></a></p><ul><li><code>constants = Constants()</code>: physical constants. See <a href="#PlantBiophysics.Constants"><code>Constants</code></a> for more details</li></ul><p><strong>Note</strong></p><p>Some models need input values for some variables. For example <a href="#PlantBiophysics.Monteith"><code>Monteith</code></a> requires a value for <code>Rₛ</code>, <code>d</code> and <code>sky_fraction</code>. If you read the models from a file, you can use <a href="#PlantBiophysics.init_status!-Tuple{Dict{String, ModelList}}"><code>init_status!</code></a> (see examples).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># ---Simple example---

meteo = Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)

# Using the model of Monteith and Unsworth (2013) for energy, Farquhar et al. (1980) for
# photosynthesis, and Medlyn et al. (2011) for stomatal conductance:
leaf =
    ModelList(
        energy_balance = Monteith(),
        photosynthesis = Fvcb(),
        stomatal_conductance = Medlyn(0.03, 12.0),
        status = (Rₛ = 13.747, sky_fraction = 1.0, PPFD = 1500.0, d = 0.03)
    )

energy_balance(leaf,meteo)

# ---Using several components---

leaf2 = copy(leaf)
leaf2.status.PPFD = 800.0

energy_balance([leaf,leaf2],meteo)

# You can use a Dict if you&#39;d like to keep track of the leaf in the returned DataFrame:
energy_balance(Dict(:leaf1 =&gt; leaf, :leaf2 =&gt; leaf2), meteo)

# ---Using several meteo time-steps---

w = Weather([Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65),
             Atmosphere(T = 25.0, Wind = 1.5, P = 101.3, Rh = 0.55)],
             (site = &quot;Test site&quot;,))

energy_balance(leaf, w)

# ---Using several meteo time-steps and several components---

energy_balance(Dict(:leaf1 =&gt; leaf, :leaf2 =&gt; leaf2), w)

# ---Using a model file---

model = read_model(joinpath(dirname(dirname(pathof(PlantBiophysics))),&quot;test&quot;,&quot;inputs&quot;,&quot;models&quot;,&quot;plant_coffee.yml&quot;))

# An example model file is available here:
# &quot;https://raw.githubusercontent.com/VEZY/PlantBiophysics/main/test/inputs/models/plant_coffee.yml&quot;

# Initialising the mandatory variables:
init_status!(model, Rₛ = 13.747, sky_fraction = 1.0, PPFD = 1500.0, Tₗ = 25.0, d = 0.03)

# NB: To know which variables has to be initialized according to the models used, you can use
# `to_initialize(ComponentModels)`, *e.g.*:
to_initialize(model[&quot;Leaf&quot;])

# Running a simulation for all component types in the same scene:
energy_balance!(model, meteo)

model[&quot;Leaf&quot;].status.Rn
model[&quot;Leaf&quot;].status.A
model[&quot;Leaf&quot;].status.Cᵢ

# ---Simulation on a full plant using an MTG---


using PlantBiophysics, MultiScaleTreeGraph, PlantGeom, GLMakie, Dates

file = joinpath(dirname(dirname(pathof(PlantBiophysics))), &quot;test&quot;, &quot;inputs&quot;, &quot;scene&quot;, &quot;opf&quot;, &quot;coffee.opf&quot;)
mtg = read_opf(file)

# Import the meteorology:
meteo = read_weather(
    &quot;archimed/meteo.csv&quot;,
    :temperature =&gt; :T,
    :relativeHumidity =&gt; (x -&gt; x ./ 100) =&gt; :Rh,
    :wind =&gt; :Wind,
    :atmosphereCO2_ppm =&gt; :Cₐ,
    date_format = DateFormat(&quot;yyyy/mm/dd&quot;)
)

# Make the models:
models = Dict(
    &quot;Leaf&quot; =&gt;
        ModelList(
            energy_balance = Monteith(),
            photosynthesis = Fvcb(),
            stomatal_conductance = Medlyn(0.03, 12.0),
            status = (d = 0.03,)
        )
)

# List the MTG attributes:
names(mtg)
# We have the skyFraction already, but not Rₛ and PPFD, so we must compute them first.
# Rₛ is the shortwave radiation (or global radiation), so it is the sum of Ra_PAR_f and Ra_NIR_f.
# PPFD is the PAR in μmol m-2 s-1, so Ra_PAR_f * 4.57.

# We can compute them using the following code (transform! comes from MultiScaleTreeGraph.jl):
transform!(
    mtg,
    [:Ra_PAR_f, :Ra_NIR_f] =&gt; ((x, y) -&gt; x + y) =&gt; :Rₛ,
    :Ra_PAR_f =&gt; (x -&gt; x * 4.57) =&gt; :PPFD,
    ignore_nothing = true
)

# Making the simulation:
energy_balance!(mtg, models, status, meteo)

# Pull the leaf temperature of the first step:
transform!(
    mtg,
    :Tₗ =&gt; (x -&gt; x[1]) =&gt; :Tₗ_1,
    ignore_nothing = true
)

# Vizualise the output:
viz(mtg, color = :Tₗ_1)</code></pre><p><strong>References</strong></p><p>Duursma, R. A., et B. E. Medlyn. 2012. « MAESPA: a model to study interactions between water limitation, environmental drivers and vegetation function at tree and stand levels, with an example application to [CO2] × drought interactions ». Geoscientific Model Development 5 (4): 919‑40. https://doi.org/10.5194/gmd-5-919-2012.</p><p>Monteith, John L., et Mike H. Unsworth. 2013. « Chapter 13 - Steady-State Heat Balance: (i) Water Surfaces, Soil, and Vegetation ». In Principles of Environmental Physics (Fourth Edition), edited by John L. Monteith et Mike H. Unsworth, 217‑47. Boston: Academic Press.</p><p>Schymanski, Stanislaus J., et Dani Or. 2017. « Leaf-Scale Experiments Reveal an Important Omission in the Penman–Monteith Equation ». Hydrology and Earth System Sciences 21 (2): 685‑706. https://doi.org/10.5194/hess-21-685-2017.</p><p>Vezy, Rémi, Mathias Christina, Olivier Roupsard, Yann Nouvellon, Remko Duursma, Belinda Medlyn, Maxime Soma, et al. 2018. « Measuring and modelling energy partitioning in canopies of varying complexity using MAESPA model ». Agricultural and Forest Meteorology 253‑254 (printemps): 203‑17. https://doi.org/10.1016/j.agrformet.2018.02.005.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/energy/energy_balance.jl#LL10-L173">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.energy_balance!" href="#PlantBiophysics.energy_balance!"><code>PlantBiophysics.energy_balance!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">energy_balance(object, meteo, constants = Constants())
energy_balance!(object, meteo, constants = Constants())</code></pre><p>Computes the energy balance of one or several components based on the type of the model it was parameterized with in <code>object.energy_balance</code>, and on one or several meteorology time-steps.</p><p>At the moment, two models are implemented in the package:</p><ul><li><a href="#PlantBiophysics.Monteith"><code>Monteith</code></a>: the model found in Monteith and Unsworth (2013)</li><li><code>Missing</code>: if no computation of the energy balance is needed</li></ul><p><strong>Arguments</strong></p><ul><li><code>object</code>: a <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a>, a Dict/Array of <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a>, or an MTG.</li><li><code>meteo::Union{AbstractAtmosphere,Weather}</code>: meteorology structure, see <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a> or</li></ul><p><a href="#PlantBiophysics.Weather"><code>Weather</code></a></p><ul><li><code>constants = Constants()</code>: physical constants. See <a href="#PlantBiophysics.Constants"><code>Constants</code></a> for more details</li></ul><p><strong>Note</strong></p><p>Some models need input values for some variables. For example <a href="#PlantBiophysics.Monteith"><code>Monteith</code></a> requires a value for <code>Rₛ</code>, <code>d</code> and <code>sky_fraction</code>. If you read the models from a file, you can use <a href="#PlantBiophysics.init_status!-Tuple{Dict{String, ModelList}}"><code>init_status!</code></a> (see examples).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># ---Simple example---

meteo = Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)

# Using the model of Monteith and Unsworth (2013) for energy, Farquhar et al. (1980) for
# photosynthesis, and Medlyn et al. (2011) for stomatal conductance:
leaf =
    ModelList(
        energy_balance = Monteith(),
        photosynthesis = Fvcb(),
        stomatal_conductance = Medlyn(0.03, 12.0),
        status = (Rₛ = 13.747, sky_fraction = 1.0, PPFD = 1500.0, d = 0.03)
    )

energy_balance(leaf,meteo)

# ---Using several components---

leaf2 = copy(leaf)
leaf2.status.PPFD = 800.0

energy_balance([leaf,leaf2],meteo)

# You can use a Dict if you&#39;d like to keep track of the leaf in the returned DataFrame:
energy_balance(Dict(:leaf1 =&gt; leaf, :leaf2 =&gt; leaf2), meteo)

# ---Using several meteo time-steps---

w = Weather([Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65),
             Atmosphere(T = 25.0, Wind = 1.5, P = 101.3, Rh = 0.55)],
             (site = &quot;Test site&quot;,))

energy_balance(leaf, w)

# ---Using several meteo time-steps and several components---

energy_balance(Dict(:leaf1 =&gt; leaf, :leaf2 =&gt; leaf2), w)

# ---Using a model file---

model = read_model(joinpath(dirname(dirname(pathof(PlantBiophysics))),&quot;test&quot;,&quot;inputs&quot;,&quot;models&quot;,&quot;plant_coffee.yml&quot;))

# An example model file is available here:
# &quot;https://raw.githubusercontent.com/VEZY/PlantBiophysics/main/test/inputs/models/plant_coffee.yml&quot;

# Initialising the mandatory variables:
init_status!(model, Rₛ = 13.747, sky_fraction = 1.0, PPFD = 1500.0, Tₗ = 25.0, d = 0.03)

# NB: To know which variables has to be initialized according to the models used, you can use
# `to_initialize(ComponentModels)`, *e.g.*:
to_initialize(model[&quot;Leaf&quot;])

# Running a simulation for all component types in the same scene:
energy_balance!(model, meteo)

model[&quot;Leaf&quot;].status.Rn
model[&quot;Leaf&quot;].status.A
model[&quot;Leaf&quot;].status.Cᵢ

# ---Simulation on a full plant using an MTG---


using PlantBiophysics, MultiScaleTreeGraph, PlantGeom, GLMakie, Dates

file = joinpath(dirname(dirname(pathof(PlantBiophysics))), &quot;test&quot;, &quot;inputs&quot;, &quot;scene&quot;, &quot;opf&quot;, &quot;coffee.opf&quot;)
mtg = read_opf(file)

# Import the meteorology:
meteo = read_weather(
    &quot;archimed/meteo.csv&quot;,
    :temperature =&gt; :T,
    :relativeHumidity =&gt; (x -&gt; x ./ 100) =&gt; :Rh,
    :wind =&gt; :Wind,
    :atmosphereCO2_ppm =&gt; :Cₐ,
    date_format = DateFormat(&quot;yyyy/mm/dd&quot;)
)

# Make the models:
models = Dict(
    &quot;Leaf&quot; =&gt;
        ModelList(
            energy_balance = Monteith(),
            photosynthesis = Fvcb(),
            stomatal_conductance = Medlyn(0.03, 12.0),
            status = (d = 0.03,)
        )
)

# List the MTG attributes:
names(mtg)
# We have the skyFraction already, but not Rₛ and PPFD, so we must compute them first.
# Rₛ is the shortwave radiation (or global radiation), so it is the sum of Ra_PAR_f and Ra_NIR_f.
# PPFD is the PAR in μmol m-2 s-1, so Ra_PAR_f * 4.57.

# We can compute them using the following code (transform! comes from MultiScaleTreeGraph.jl):
transform!(
    mtg,
    [:Ra_PAR_f, :Ra_NIR_f] =&gt; ((x, y) -&gt; x + y) =&gt; :Rₛ,
    :Ra_PAR_f =&gt; (x -&gt; x * 4.57) =&gt; :PPFD,
    ignore_nothing = true
)

# Making the simulation:
energy_balance!(mtg, models, status, meteo)

# Pull the leaf temperature of the first step:
transform!(
    mtg,
    :Tₗ =&gt; (x -&gt; x[1]) =&gt; :Tₗ_1,
    ignore_nothing = true
)

# Vizualise the output:
viz(mtg, color = :Tₗ_1)</code></pre><p><strong>References</strong></p><p>Duursma, R. A., et B. E. Medlyn. 2012. « MAESPA: a model to study interactions between water limitation, environmental drivers and vegetation function at tree and stand levels, with an example application to [CO2] × drought interactions ». Geoscientific Model Development 5 (4): 919‑40. https://doi.org/10.5194/gmd-5-919-2012.</p><p>Monteith, John L., et Mike H. Unsworth. 2013. « Chapter 13 - Steady-State Heat Balance: (i) Water Surfaces, Soil, and Vegetation ». In Principles of Environmental Physics (Fourth Edition), edited by John L. Monteith et Mike H. Unsworth, 217‑47. Boston: Academic Press.</p><p>Schymanski, Stanislaus J., et Dani Or. 2017. « Leaf-Scale Experiments Reveal an Important Omission in the Penman–Monteith Equation ». Hydrology and Earth System Sciences 21 (2): 685‑706. https://doi.org/10.5194/hess-21-685-2017.</p><p>Vezy, Rémi, Mathias Christina, Olivier Roupsard, Yann Nouvellon, Remko Duursma, Belinda Medlyn, Maxime Soma, et al. 2018. « Measuring and modelling energy partitioning in canopies of varying complexity using MAESPA model ». Agricultural and Forest Meteorology 253‑254 (printemps): 203‑17. https://doi.org/10.1016/j.agrformet.2018.02.005.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/energy/energy_balance.jl#LL10-L173">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.fit" href="#PlantBiophysics.fit"><code>PlantBiophysics.fit</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">fit(::Type{&lt;:AbstractModel}, df; kwargs)</code></pre><p>Optimize the parameters of a model using measurements in <code>df</code> and the initialisation values in <code>kwargs</code>. Note that the columns in <code>df</code> should match exactly the names and units used in the model. See particular implementations for more details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/fitting/fit.jl#LL2-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.fit-Union{Tuple{T}, Tuple{T, Any}} where T&lt;:Type{Medlyn}" href="#PlantBiophysics.fit-Union{Tuple{T}, Tuple{T, Any}} where T&lt;:Type{Medlyn}"><code>PlantBiophysics.fit</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit(::Type{Medlyn}, df)</code></pre><p>Optimize the parameters of the <a href="#PlantBiophysics.Medlyn"><code>Medlyn</code></a> model. Note that here Gₛ is stomatal conductance for CO2, not H2O.</p><p><strong>Arguments</strong></p><ul><li>df: a DataFrame with columns A, VPD, Cₐ and Gₛ, where each row is an observation. The column</li></ul><p>names should match exactly.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantBiophysics, Plots, DataFrames

file = joinpath(dirname(dirname(pathof(PlantBiophysics))),&quot;test&quot;,&quot;inputs&quot;,&quot;data&quot;,&quot;P1F20129.csv&quot;)
df = read_walz(file)
# Removing the CO2 and ligth Curve, we fit the parameters on the Rh curve:
filter!(x -&gt; x.curve != &quot;ligth Curve&quot; &amp;&amp; x.curve != &quot;CO2 Curve&quot;, df)

# Fit the parameters values:
g0, g1 = fit(Medlyn, df)

# Re-simulating Gₛ using the newly fitted parameters:
w = Weather(select(df, :T, :P, :Rh, :Cₐ, :VPD, :T =&gt; (x -&gt; 10) =&gt; :Wind))
leaf = ModelList(
        stomatal_conductance = Medlyn(g0, g1),
        status = (A = df.A, Cₛ = df.Cₐ, Dₗ = df.VPD)
    )
stomatal_conductance!(leaf, w)

# Visualising the results:
gsAvpd = PlantBiophysics.GsAVPD(g0, g1, df.Gₛ, df.VPD, df.A, df.Cₐ, leaf[:Gₛ])
plot(gsAvpd,leg=:bottomright)
# As in [`Medlyn`](@ref) reference paper, linear regression is also plotted.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/fitting/fit_Medlyn.jl#LL1-L37">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.fit-Union{Tuple{T}, Tuple{T, Any}} where T&lt;:Union{Type{Fvcb}, Type{FvcbIter}, Type{FvcbRaw}}" href="#PlantBiophysics.fit-Union{Tuple{T}, Tuple{T, Any}} where T&lt;:Union{Type{Fvcb}, Type{FvcbIter}, Type{FvcbRaw}}"><code>PlantBiophysics.fit</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit(::Type{Fvcb}, df; Tᵣ = nothing, VcMaxRef = 0., JMaxRef = 0., RdRef = 0., TPURef = 0.)</code></pre><p>Optimize the parameters of the <a href="#PlantBiophysics.Fvcb"><code>Fvcb</code></a> model. Also works for <a href="#PlantBiophysics.FvcbIter"><code>FvcbIter</code></a>.</p><p><strong>Arguments</strong></p><ul><li>df: a DataFrame with columns A, PPFD, Tₗ and Cᵢ, where each row is an observation. The column</li></ul><p>names should match exactly</p><ul><li>Tᵣ: reference temperature for the optimized parameter values. If not provided, use the average Tₗ.</li><li>VcMaxRef, JMaxRef, RdRef: initialisation values for the parameter optimisation</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantBiophysics, Plots, DataFrames

file = joinpath(dirname(dirname(pathof(PlantBiophysics))),&quot;test&quot;,&quot;inputs&quot;,&quot;data&quot;,&quot;P1F20129.csv&quot;)
df = read_walz(file)
# Removing the Rh and light curves for the fitting because temperature varies
filter!(x -&gt; x.curve != &quot;Rh Curve&quot; &amp;&amp; x.curve != &quot;ligth Curve&quot;, df)

# Fit the parameter values:
VcMaxRef, JMaxRef, RdRef, TPURef = fit(Fvcb, df; Tᵣ = 25.0)
# Note that Tᵣ was set to 25 °C in our response curve. You should adapt its value to what you
# had during the response curves

# Checking the results:
filter!(x -&gt; x.curve == &quot;CO2 Curve&quot;, df)

# Sort the DataFrame by :Cᵢ to get ordered data point
sort!(df, :Cᵢ)

# Re-simulating A using the newly fitted parameters:
leaf =
    ModelList(
        photosynthesis = FvcbRaw(VcMaxRef = VcMaxRef, JMaxRef = JMaxRef, RdRef = RdRef, TPURef = TPURef),
        status = (Tₗ = df.Tₗ, PPFD = df.PPFD, Cᵢ = df.Cᵢ)
    )
photosynthesis!(leaf)
df_sim = DataFrame(leaf)

# Visualising the results:
ACi_struct = PlantBiophysics.ACi(VcMaxRef, JMaxRef, RdRef, df.A, df_sim.A, df[:,:Cᵢ], df_sim.Cᵢ)
plot(ACi_struct,leg=:bottomright)

# Note that we can also simulate the results using the full photosynthesis model too (Fvcb):
# Adding the windspeed to simulate the boundary-layer conductance (we put a high value):
df[!, :Wind] .= 10.0

leaf = ModelList(
        photosynthesis = Fvcb(VcMaxRef = VcMaxRef, JMaxRef = JMaxRef, RdRef = RdRef, Tᵣ = 25.0, TPURef = TPURef),
        # stomatal_conductance = ConstantGs(0.0, df[i,:Gₛ]),
        stomatal_conductance = Medlyn(0.03, 12.),
        status = (Tₗ = df.Tₗ, PPFD = df.PPFD, Cₛ = df.Cₐ, Dₗ = 0.1)
    )

w = Weather(select(df, :T, :P, :Rh, :Cₐ, :T =&gt; (x -&gt; 10) =&gt; :Wind))
photosynthesis!(leaf, w)
df_sim2 = DataFrame(leaf)

# And finally we plot the results:
ACi_struct_full = PlantBiophysics.ACi(VcMaxRef, JMaxRef, RdRef, df.A, df_sim2.A, df[:,:Cᵢ], df_sim2.Cᵢ)
plot(ACi_struct_full,leg=:bottomright)
# Note that the results differ a bit because there are more variables that are re-simulated (e.g. Cᵢ)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/fitting/fit_FvCB.jl#LL1-L67">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.gbh_to_gbw" href="#PlantBiophysics.gbh_to_gbw"><code>PlantBiophysics.gbh_to_gbw</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gbh_to_gbw(gbh, Gbₕ_to_Gbₕ₂ₒ = Constants().Gbₕ_to_Gbₕ₂ₒ)
gbw_to_gbh(gbh, Gbₕ_to_Gbₕ₂ₒ = Constants().Gbₕ_to_Gbₕ₂ₒ)</code></pre><p>Boundary layer conductance for water vapor from boundary layer conductance for heat.</p><p><strong>Arguments</strong></p><ul><li><code>gbh</code> (m s-1): boundary layer conductance for heat under mixed convection.</li><li><code>Gbₕ_to_Gbₕ₂ₒ</code>: conversion factor.</li></ul><p><strong>Note</strong></p><p>Gbₕ is the sum of free and forced convection. See <a href="#PlantBiophysics.gbₕ_free"><code>gbₕ_free</code></a> and <a href="#PlantBiophysics.gbₕ_forced-Tuple{Any, Any}"><code>gbₕ_forced</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/conversions.jl#LL121-L135">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.gbₕ_forced-Tuple{Any, Any}" href="#PlantBiophysics.gbₕ_forced-Tuple{Any, Any}"><code>PlantBiophysics.gbₕ_forced</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gbₕ_forced(Wind,d)</code></pre><p>Boundary layer conductance for heat under <strong>forced</strong> convection (m s-1). See eq. E1 from Leuning et al. (1995) for more details.</p><p><strong>Arguments</strong></p><ul><li><code>Wind</code> (m s-1): wind speed</li><li><code>d</code> (m): characteristic dimension, <em>e.g.</em> leaf width (see eq. 10.9 from Monteith and Unsworth, 2013).</li></ul><p><strong>Notes</strong></p><p><code>d</code> is the minimal dimension of the surface of an object in contact with the air.</p><p><strong>References</strong></p><p>Leuning, R., F. M. Kelliher, DGG de Pury, et E.-D. SCHULZE. 1995. « Leaf nitrogen, photosynthesis, conductance and transpiration: scaling from leaves to canopies ». Plant, Cell &amp; Environment 18 (10): 1183‑1200.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/conductances/boundary/gb.jl#LL45-L65">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.gbₕ_free" href="#PlantBiophysics.gbₕ_free"><code>PlantBiophysics.gbₕ_free</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gbₕ_free(Tₐ,Tₗ,d,Dₕ₀)
gbₕ_free(Tₐ,Tₗ,d)</code></pre><p>Leaf boundary layer conductance for heat under <strong>free</strong> convection (m s-1).</p><p><strong>Arguments</strong></p><ul><li><code>Tₐ</code> (°C): air temperature</li><li><code>Tₗ</code> (°C): leaf temperature</li><li><code>d</code> (m): characteristic dimension, <em>e.g.</em> leaf width (see eq. 10.9 from Monteith and Unsworth, 2013).</li><li><code>Dₕ₀ = 21.5e-6</code>: molecular diffusivity for heat at base temperature. Use value from</li></ul><p><a href="#PlantBiophysics.Constants"><code>Constants</code></a> if not provided.</p><p><strong>Note</strong></p><p><code>R</code> and <code>Dₕ₀</code> can be found using <a href="#PlantBiophysics.Constants"><code>Constants</code></a>. To transform in <span>$mol\ m^{-2}\ s^{-1}$</span>, use <a href="#PlantBiophysics.ms_to_mol-NTuple{5, Any}"><code>ms_to_mol</code></a>.</p><p><strong>References</strong></p><p>Leuning, R., F. M. Kelliher, DGG de Pury, et E.-D. SCHULZE. 1995. « Leaf nitrogen, photosynthesis, conductance and transpiration: scaling from leaves to canopies ». Plant, Cell &amp; Environment 18 (10): 1183‑1200.</p><p>Monteith, John, et Mike Unsworth. 2013. Principles of environmental physics: plants, animals, and the atmosphere. Academic Press. Paragraph 10.1.3, eq. 10.9.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/conductances/boundary/gb.jl#LL1-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.get_Cᵢᵥ-NTuple{7, Any}" href="#PlantBiophysics.get_Cᵢᵥ-NTuple{7, Any}"><code>PlantBiophysics.get_Cᵢᵥ</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Analytic resolution of Cᵢ when the RuBisCo activity is limiting (<span>$μmol\ mol^{-1}$</span>)</p><p><strong>Arguments</strong></p><ul><li><code>VcMAX</code>: maximum rate of RuBisCo activity(<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>Γˢ</code>: CO2 compensation point <span>$Γ^⋆$</span> (<span>$μmol\ mol^{-1}$</span>)</li><li><code>Cₛ</code>: stomatal CO₂ concentration (<span>$μmol\ mol^{-1}$</span>)</li><li><code>Rd</code>: day respiration (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>g0</code>: residual stomatal conductance (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>st_closure</code>: stomatal conductance term computed from a given implementation of a Gs model,</li></ul><p>e.g. <a href="#PlantBiophysics.Medlyn"><code>Medlyn</code></a>.</p><ul><li><code>Km</code>: effective Michaelis–Menten coefficient for CO2 (<span>$μ mol\ mol^{-1}$</span>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/FvCB.jl#LL375-L388">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.get_Cᵢⱼ-NTuple{6, Any}" href="#PlantBiophysics.get_Cᵢⱼ-NTuple{6, Any}"><code>PlantBiophysics.get_Cᵢⱼ</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Analytic resolution of Cᵢ when the rate of electron transport is limiting (<span>$μmol\ mol^{-1}$</span>)</p><p><strong>Arguments</strong></p><ul><li><code>Vⱼ</code>: RuBP regeneration (J/4.0, <span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>Γˢ</code>: CO2 compensation point <span>$Γ^⋆$</span> (<span>$μmol\ mol^{-1}$</span>)</li><li><code>Cₛ</code>: stomatal CO₂ concentration (<span>$μmol\ mol^{-1}$</span>)</li><li><code>Rd</code>: day respiration (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>g0</code>: residual stomatal conductance (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>st_closure</code>: stomatal conductance term computed from a given implementation of a Gs model,</li></ul><p>e.g. <a href="#PlantBiophysics.Medlyn"><code>Medlyn</code></a>.</p><p><strong>References</strong></p><p>Duursma, R. A., et B. E. Medlyn. 2012. « MAESPA: a model to study interactions between water limitation, environmental drivers and vegetation function at tree and stand levels, with an example application to [CO2] × drought interactions ». Geoscientific Model Development 5 (4): 919‑40. https://doi.org/10.5194/gmd-5-919-2012.</p><p>Wang and Leuning, 1998</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/FvCB.jl#LL342-L364">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.get_Dₕ" href="#PlantBiophysics.get_Dₕ"><code>PlantBiophysics.get_Dₕ</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_Dₕ(T,Dₕ₀)
get_Dₕ(T)</code></pre><p>Dₕ -molecular diffusivity for heat at base temperature- from Dₕ₀ (corrected by temperature). See Monteith and Unsworth (2013, eq. 3.10).</p><p><strong>Arguments</strong></p><ul><li><code>Tₐ</code> (°C): temperature</li><li><code>Dₕ₀</code>: molecular diffusivity for heat at base temperature. Use value from <a href="#PlantBiophysics.Constants"><code>Constants</code></a></li></ul><p>if not provided.</p><p><strong>References</strong></p><p>Monteith, John, et Mike Unsworth. 2013. Principles of environmental physics: plants, animals, and the atmosphere. Academic Press. Paragraph 10.1.3.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/conductances/boundary/gb.jl#LL71-L88">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.get_J-NTuple{4, Any}" href="#PlantBiophysics.get_J-NTuple{4, Any}"><code>PlantBiophysics.get_J</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Rate of electron transport J (<span>$μmol\ m^{-2}\ s^{-1}$</span>), computed using the smaller root of the quadratic equation (eq. 4 from Medlyn et al., 2002):</p><pre><code class="nohighlight hljs">θ * J² - (α * PPFD + JMax) * J + α * PPFD * JMax</code></pre><p>NB: we use the smaller root because considering the range of values for θ and α (quite stable), and PPFD and JMax, the function always tends to JMax with high PPFD with the smaller root (behavior we are searching), and the opposite with the larger root.</p><p><strong>Returns</strong></p><p>A tuple with (A, Gₛ, Cᵢ):</p><ul><li>A: carbon assimilation (μmol m-2 s-1)</li><li>Gₛ: stomatal conductance (mol m-2 s-1)</li><li>Cᵢ: intercellular CO₂ concentration (ppm)</li></ul><p><strong>Arguments</strong></p><ul><li><code>PPFD</code>: absorbed photon irradiance (<span>$μmol_{quanta}\ m^{-2}\ s^{-1}$</span>)</li><li><code>α</code>: quantum yield of electron transport (<span>$mol_e\ mol^{-1}_{quanta}$</span>)</li><li><code>JMax</code>: maximum rate of electron transport (<span>$μmol\ m^{-2}\ s^{-1}$</span>)</li><li><code>θ</code>: determines the shape of the non-rectangular hyperbola (-)</li></ul><p><strong>References</strong></p><p>Medlyn, B. E., E. Dreyer, D. Ellsworth, M. Forstreuter, P. C. Harley, M. U. F. Kirschbaum, X. Le Roux, et al. 2002. « Temperature response of parameters of a biochemically based model of photosynthesis. II. A review of experimental data ». Plant, Cell &amp; Environment 25 (9): 1167‑79. https://doi.org/10.1046/j.1365-3040.2002.00891.x.</p><p>Von Caemmerer, Susanna. 2000. Biochemical models of leaf photosynthesis. Csiro publishing.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs"># Using default values for the model:
julia&gt; A = Fvcb()
Fvcb{Float64}(25.0, 200.0, 250.0, 0.6, 9999.0, 46390.0, 210.0, 29680.0, 200000.0, 631.88, 58550.0, 200000.0, 629.26, 0.24, 0.7)

julia&gt; PlantBiophysics.get_J(1500, A.JMaxRef, A.α, A.θ)
188.17537926909347</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/FvCB.jl#LL294-L337">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.get_km" href="#PlantBiophysics.get_km"><code>PlantBiophysics.get_km</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Compute the effective Michaelis–Menten coefficient for CO2 <span>$Km$</span> (<span>$μ mol\ mol^{-1}$</span>) according to Medlyn et al. (2002), equations (5) and (6).</p><p><strong>References</strong></p><p>Medlyn, B. E., E. Dreyer, D. Ellsworth, M. Forstreuter, P. C. Harley, M. U. F. Kirschbaum, X. Le Roux, et al. 2002. « Temperature response of parameters of a biochemically based model of photosynthesis. II. A review of experimental data ». Plant, Cell &amp; Environment 25 (9): 1167‑79. https://doi.org/10.1046/j.1365-3040.2002.00891.x.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># computing the temperature dependence of γˢ:
get_km(28,25,210.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/temperature-dependence.jl#LL139-L158">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.get_model-Tuple{Any, Any}" href="#PlantBiophysics.get_model-Tuple{Any, Any}"><code>PlantBiophysics.get_model</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_model(x)</code></pre><p>Return the model (the actual struct) given its name passed as a String.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/io/read_model.jl#LL91-L95">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.get_process-Tuple{Any}" href="#PlantBiophysics.get_process-Tuple{Any}"><code>PlantBiophysics.get_process</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_process(x)</code></pre><p>Return the process type (the actual struct) given its name passed as a String.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/io/read_model.jl#LL66-L70">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.grey_body-NTuple{4, Any}" href="#PlantBiophysics.grey_body-NTuple{4, Any}"><code>PlantBiophysics.grey_body</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Thermal infrared, <em>i.e.</em> longwave radiation emitted from an object at temperature T.</p><ul><li><code>T</code>: temperature of the object in Celsius degree</li><li><code>ε</code> object <a href="https://en.wikipedia.org/wiki/Emissivity">emissivity</a> (not to confuse with ε the</li></ul><p>ratio of molecular weights from <a href="#PlantBiophysics.Constants"><code>Constants</code></a>). A typical value for a leaf is 0.955.</p><ul><li><code>K₀</code>: absolute zero (°C)</li><li><code>σ</code> (<span>$W\ m^{-2}\ K^{-4}$</span>) <a href="https://en.wikipedia.org/wiki/Stefan%E2%80%93Boltzmann_law">Stefan-Boltzmann constant</a></li></ul><p><strong>Note</strong></p><p><code>K₀</code> and <code>σ</code> are taken from <a href="#PlantBiophysics.Constants"><code>Constants</code></a> if not provided.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Thermal infrared radiation of water at 25 °C:
grey_body(25.0, 0.96)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/energy/longwave_energy.jl#LL27-L46">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.gs_closure" href="#PlantBiophysics.gs_closure"><code>PlantBiophysics.gs_closure</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Constant stomatal closure. Usually called from a photosynthesis model.</p><p><strong>Note</strong></p><p><code>meteo</code> is just declared here for compatibility with other formats of calls.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/conductances/stomatal/constantGs.jl#LL34-L40">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.gs_closure-Tuple{Medlyn, Any, Any, Any}" href="#PlantBiophysics.gs_closure-Tuple{Medlyn, Any, Any, Any}"><code>PlantBiophysics.gs_closure</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gs_closure(leaf::ModelList,meteo)</code></pre><p>Stomatal closure for CO₂ according to Medlyn et al. (2011). Carefull, this is just a part of the computation of the stomatal conductance.</p><p>The result of this function is then used as:</p><pre><code class="nohighlight hljs">gs_mod = gs_closure(leaf,meteo)

# And then stomatal conductance (μmol m-2 s-1) calling [`stomatal_conductance`](@ref):
Gₛ = leaf.stomatal_conductance.g0 + gs_mod * leaf.status.A</code></pre><p><strong>Arguments</strong></p><ul><li><code>::Medlyn</code>: a medlyn model, usually the leaf model (<em>i.e.</em> leaf.stomatal_conductance)</li><li><code>leaf::ModelList</code>: A <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a> struct holding the parameters for</li></ul><p>the model.</p><ul><li><code>status</code>: A status, usually the leaf status (<em>i.e.</em> leaf.status)</li><li><code>meteo</code>: meteorology structure, see <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a>. Is not used in this model.</li></ul><p><strong>Details</strong></p><p>Use <code>variables()</code> on Medlyn to get the variables that must be instantiated in the <code>ModelList</code> struct.</p><p><strong>Notes</strong></p><ul><li><code>Cₛ</code> is used instead of <code>Cₐ</code> because Gₛ is between the surface and the intercellular space. The conductance</li></ul><p>between the atmosphere and the surface is accounted for using the boundary layer conductance (<code>Gbc</code> in <a href="#PlantBiophysics.Monteith"><code>Monteith</code></a>). Medlyn et al. (2011) uses <code>Cₐ</code> in their paper because they relate their models to the measurements made at leaf level, with a well-mixed chamber where<code>Cₛ ≈ Cₐ</code>.</p><ul><li><code>Dₗ</code> is forced to be &gt;= 1e-9 because it is used in a squared root. It is prefectly acceptable to</li></ul><p>get a negative Dₗ when leaves are re-hydrating from air. Cloud forests are the perfect example. See <em>e.g.</em>: Guzmán‐Delgado, P, Laca, E, Zwieniecki, MA. Unravelling foliar water uptake pathways: The contribution of stomata and the cuticle. Plant Cell Environ. 2021; 1– 13. https://doi.org/10.1111/pce.14041</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">meteo = Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)

leaf =
    ModelList(
        stomatal_conductance = Medlyn(0.03, 12.0),
        status = (Cₛ = 380.0, Dₗ = meteo.VPD)
    )

gs_mod = gs_closure(leaf, meteo)

A = 20 # example assimilation (μmol m-2 s-1)
Gs = leaf.stomatal_conductance.g0 + gs_mod * A

# Or more directly using `stomatal_conductance()`:

leaf =
    ModelList(
        stomatal_conductance = Medlyn(0.03, 12.0),
        status = (A = A, Cₛ = 380.0, Dₗ = meteo.VPD)
    )
stomatal_conductance(leaf,meteo)</code></pre><p><strong>References</strong></p><p>Medlyn, Belinda E., Remko A. Duursma, Derek Eamus, David S. Ellsworth, I. Colin Prentice, Craig V. M. Barton, Kristine Y. Crous, Paolo De Angelis, Michael Freeman, et Lisa Wingate.</p><ol><li>« Reconciling the optimal and empirical approaches to modelling stomatal conductance ».</li></ol><p>Global Change Biology 17 (6): 2134‑44. https://doi.org/10.1111/j.1365-2486.2010.02375.x.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/conductances/stomatal/medlyn.jl#LL67-L138">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.gsc_to_gsw" href="#PlantBiophysics.gsc_to_gsw"><code>PlantBiophysics.gsc_to_gsw</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gsc_to_gsw(Gₛ, Gsc_to_Gsw = Constants().Gsc_to_Gsw)</code></pre><p>Conversion of a stomatal conductance for CO₂ into stomatal conductance for H₂O.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/conversions.jl#LL145-L149">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.gsw_to_gsc" href="#PlantBiophysics.gsw_to_gsc"><code>PlantBiophysics.gsw_to_gsc</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gsw_to_gsc(Gₛ, Gsc_to_Gsw = Constants().Gsc_to_Gsw)</code></pre><p>Conversion of a stomatal conductance for H₂O into stomatal conductance for CO₂.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/conversions.jl#LL154-L158">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.init_mtg_models!" href="#PlantBiophysics.init_mtg_models!"><code>PlantBiophysics.init_mtg_models!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">init_mtg_models!(
    mtg::MultiScaleTreeGraph.Node,
    models::Dict{String,&lt;:ModelList},
    i=nothing;
    verbose=true,
    attr_name=:models
)</code></pre><p>initialize the components of an MTG (<em>i.e.</em> nodes) with the corresponding models.</p><p>The function checks if the models associated to each component of the MTG are fully initialized, and if not, tries to initialize the variables using the MTG attributes with the exact same name, and if not found, returns an error.</p><p><strong>Arguments</strong></p><ul><li><code>mtg::MultiScaleTreeGraph.Node</code>: the MTG tree.</li><li><code>models::Dict{String,ModelList}</code>: a dictionary of models named by components names</li><li><code>i=nothing</code>: the time-step to initialize. If <code>nothing</code>, initialize all the time-steps.</li><li><code>verbose = true</code>: return information during the processes</li><li><code>attr_name = :models</code>: the node attribute name used to store the models</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantBiophysics, MultiScaleTreeGraph, PlantGeom

# Read the file
file = joinpath(dirname(dirname(pathof(PlantBiophysics))),&quot;test&quot;,&quot;inputs&quot;,&quot;scene&quot;,&quot;opf&quot;,&quot;coffee.opf&quot;)
mtg = read_opf(file)

# Declare our models:
models = Dict(
    &quot;Leaf&quot; =&gt;
        ModelList(
            energy_balance = Monteith(),
            photosynthesis = Fvcb(),
            stomatal_conductance = Medlyn(0.03, 12.0),
            status = (d = 0.03,)
        )
)

# Checking which variables are needed for our models:
[component =&gt; to_initialize(model) for (component, model) in models]
# OK we need to initialize Rₛ, sky_fraction and the PPFD

# We can compute them directly inside the MTG from available variables:
transform!(
    mtg,
    [:Ra_PAR_f, :Ra_NIR_f] =&gt; ((x, y) -&gt; x + y) =&gt; :Rₛ,
    :Ra_PAR_f =&gt; (x -&gt; x * 4.57) =&gt; :PPFD,
    ignore_nothing = true
)

# Initialising all components with their corresponding models and initialisations:
init_mtg_models!(mtg, models)
# Note that this is possible only because the initialisation values are found in the MTG.
# If the initialisations are constant values between components, we can directly initialize
# them in the models definition (we initialize `:d` like this in our example).</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/mtg/init_mtg_models.jl#LL1-L62">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.init_status!-Tuple{Dict{String, ModelList}}" href="#PlantBiophysics.init_status!-Tuple{Dict{String, ModelList}}"><code>PlantBiophysics.init_status!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">init_status!(object::Dict{String,ModelList};vars...)
init_status!(component::ModelList;vars...)</code></pre><p>Intialise model variables for components with user input.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">model = read_model(&quot;a-model-file.yml&quot;)
init_status!(model, Tₗ = 25.0, PPFD = 1000.0, Cₛ = 400.0, Dₗ = 1.2)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/model_initialisation.jl#LL79-L91">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.init_variables-Tuple{T} where T&lt;:AbstractModel" href="#PlantBiophysics.init_variables-Tuple{T} where T&lt;:AbstractModel"><code>PlantBiophysics.init_variables</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">init_variables(models...)</code></pre><p>Intialized model variables with their default values. The variables are taken from the inputs and outputs of the models.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">init_variables(Monteith())
init_variables(energy_balance = Monteith(), stomatal_conductance = Medlyn(0.03,12.0))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/model_initialisation.jl#LL117-L129">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.init_variables_manual-Tuple{Any, Any}" href="#PlantBiophysics.init_variables_manual-Tuple{Any, Any}"><code>PlantBiophysics.init_variables_manual</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">init_variables_manual(models...;vars...)</code></pre><p>Return an initialisation of the model variables with given values.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">init_variables_manual(status, (Tₗ = 20.0,))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/model_initialisation.jl#LL293-L303">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.inputs-Tuple{T} where T&lt;:AbstractModel" href="#PlantBiophysics.inputs-Tuple{T} where T&lt;:AbstractModel"><code>PlantBiophysics.inputs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">inputs(model::AbstractModel)
inputs(...)</code></pre><p>Get the inputs of one or several models.</p><p>Returns an empty tuple by default for <code>AbstractModel</code>s (no inputs) or <code>Missing</code> models.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/models_inputs_outputs.jl#LL1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.instantiate-NTuple{4, Any}" href="#PlantBiophysics.instantiate-NTuple{4, Any}"><code>PlantBiophysics.instantiate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">instantiate(x)</code></pre><p>Instantiate a model given its parameter names, considering that parameter names can be different compared to the model fields (used to insure compatibility with Archimed).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/io/read_model.jl#LL119-L124">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.is_initialized-Tuple{T} where T&lt;:ModelList" href="#PlantBiophysics.is_initialized-Tuple{T} where T&lt;:ModelList"><code>PlantBiophysics.is_initialized</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">is_initialized(m::T) where T &lt;: ModelList
is_initialized(m::T, models...) where T &lt;: ModelList</code></pre><p>Check if the variables that must be initialized are, and return <code>true</code> if so, and <code>false</code> and an information message if not.</p><p><strong>Note</strong></p><p>There is no way to know before-hand which process will be simulated by the user, so if you have a component with a model for each process, the variables to initialize are always the smallest subset of all, meaning it is considered the user will simulate the variables needed for other models.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">leaf = ModelList(photosynthesis = Fvcb(), stomatal_conductance = Medlyn(0.03,12.0))
is_initialized(leaf)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/model_initialisation.jl#LL221-L241">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.is_model-Tuple{Any}" href="#PlantBiophysics.is_model-Tuple{Any}"><code>PlantBiophysics.is_model</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">is_model(model)</code></pre><p>Check if a model object has the&quot;Group&quot; and &quot;Type&quot; keys as the first level of a Dict type object. But the function is generic as long as the input struct has a <code>keys()</code> method.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">models = read_model(&quot;path_to_a_model_file.yaml&quot;)
is_model(models)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/io/read_model.jl#LL206-L218">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.latent_heat-NTuple{8, Any}" href="#PlantBiophysics.latent_heat-NTuple{8, Any}"><code>PlantBiophysics.latent_heat</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">latent_heat(Rn, VPD, γˢ, Rbₕ, Δ, ρ, aₛₕ, Cₚ)
latent_heat(Rn, VPD, γˢ, Rbₕ, Δ, ρ, aₛₕ)</code></pre><p>λE -the latent heat flux (W m-2)- using the Monteith and Unsworth (2013) definition corrected by Schymanski et al. (2017), eq.22.</p><ul><li><code>Rn</code> (W m-2): net radiation. Carefull: not the isothermal net radiation</li><li><code>VPD</code> (kPa): air vapor pressure deficit</li><li><code>γˢ</code> (kPa K−1): apparent value of psychrometer constant (see <a href="#PlantBiophysics.γ_star-NTuple{6, Any}"><code>γ_star</code></a>)</li><li><code>Rbₕ</code> (s m-1): resistance for heat transfer by convection, i.e. resistance to sensible heat</li><li><code>Δ</code> (KPa K-1): rate of change of saturation vapor pressure with temperature (see <a href="#PlantBiophysics.e_sat_slope-Tuple{Any}"><code>e_sat_slope</code></a>)</li><li><code>ρ</code> (kg m-3): air density of moist air.</li><li><code>aₛₕ</code> (1,2): number of sides that exchange energy for heat (2 for leaves)</li><li><code>Cₚ</code> (J K-1 kg-1): specific heat of air for constant pressure</li></ul><p><strong>References</strong></p><p>Monteith, J. and Unsworth, M., 2013. Principles of environmental physics: plants, animals, and the atmosphere. Academic Press. See eq. 13.33.</p><p>Schymanski et al. (2017), Leaf-scale experiments reveal an important omission in the Penman–Monteith equation, Hydrology and Earth System Sciences. DOI: https://doi.org/10.5194/hess-21-685-2017. See equ. 22.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">Tₐ = 20.0 ; P = 100.0 ;
ρ = air_density(Tₐ, P) # in kg m-3
Δ = e_sat_slope(Tₐ)

latent_heat(300.0, 2.0, 0.1461683, 50.0, Δ, ρ, 2.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/energy/Monteith.jl#LL231-L263">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.latent_heat_vaporization-Tuple{Any, Any}" href="#PlantBiophysics.latent_heat_vaporization-Tuple{Any, Any}"><code>PlantBiophysics.latent_heat_vaporization</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">latent_heat_vaporization(Tₐ,λ₀)
latent_heat_vaporization(Tₐ)</code></pre><p>λ, the latent heat of vaporization for water (J kg-1).</p><p><strong>Arguments</strong></p><ul><li><code>Tₐ</code> (°C): air temperature</li><li><code>λ₀</code>: latent heat of vaporization for water at 0 degree Celsius. Taken from <code>Constants().λ₀</code></li></ul><p>if not provided (see <a href="#PlantBiophysics.Constants"><code>Constants</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/climate/variables_computations.jl#LL141-L153">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.light_interception" href="#PlantBiophysics.light_interception"><code>PlantBiophysics.light_interception</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">light_interception(object, meteo, constants = Constants())
light_interception!(object, meteo, constants = Constants())</code></pre><p>Computes the light interception of one or several objects based on the type of the model it was parameterized with in <code>object.light_interception</code>, and on one or several meteorology time-steps.</p><p>At the moment, two models are implemented in the package:</p><ul><li><a href="#PlantBiophysics.Beer"><code>Beer</code></a>: the Beer-Lambert law of ligth extinction</li><li><a href="#PlantBiophysics.Ignore"><code>Ignore</code></a>: ignore the computation of light interception (this one is for backward</li></ul><p>compatibility with ARCHIMED-ϕ)</p><p><strong>Arguments</strong></p><ul><li><code>object</code>: a <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a>, a Dict/Array of <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a>, or an MTG.</li><li><code>meteo::Union{AbstractAtmosphere,Weather}</code>: meteorology structure, see <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a> or</li></ul><p><a href="#PlantBiophysics.Weather"><code>Weather</code></a></p><ul><li><code>constants = Constants()</code>: physical constants. See <a href="#PlantBiophysics.Constants"><code>Constants</code></a> for more details</li></ul><p><strong>Note</strong></p><p>Some models need input values for some variables. For example <a href="#PlantBiophysics.Beer"><code>Beer</code></a> requires a value for <code>LAI</code>, the leaf area index. If you read the models from a file, you can use <a href="#PlantBiophysics.init_status!-Tuple{Dict{String, ModelList}}"><code>init_status!</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">m = ModelList(light_interception=Beer(0.5), status=(LAI=2.0,))

meteo = Atmosphere(T=20.0, Wind=1.0, P=101.3, Rh=0.65, Ri_PAR_f=300.0)

light_interception!(m, meteo)

m[:aPAR]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/light/light_interception.jl#LL8-L45">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.light_interception!" href="#PlantBiophysics.light_interception!"><code>PlantBiophysics.light_interception!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">light_interception(object, meteo, constants = Constants())
light_interception!(object, meteo, constants = Constants())</code></pre><p>Computes the light interception of one or several objects based on the type of the model it was parameterized with in <code>object.light_interception</code>, and on one or several meteorology time-steps.</p><p>At the moment, two models are implemented in the package:</p><ul><li><a href="#PlantBiophysics.Beer"><code>Beer</code></a>: the Beer-Lambert law of ligth extinction</li><li><a href="#PlantBiophysics.Ignore"><code>Ignore</code></a>: ignore the computation of light interception (this one is for backward</li></ul><p>compatibility with ARCHIMED-ϕ)</p><p><strong>Arguments</strong></p><ul><li><code>object</code>: a <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a>, a Dict/Array of <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a>, or an MTG.</li><li><code>meteo::Union{AbstractAtmosphere,Weather}</code>: meteorology structure, see <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a> or</li></ul><p><a href="#PlantBiophysics.Weather"><code>Weather</code></a></p><ul><li><code>constants = Constants()</code>: physical constants. See <a href="#PlantBiophysics.Constants"><code>Constants</code></a> for more details</li></ul><p><strong>Note</strong></p><p>Some models need input values for some variables. For example <a href="#PlantBiophysics.Beer"><code>Beer</code></a> requires a value for <code>LAI</code>, the leaf area index. If you read the models from a file, you can use <a href="#PlantBiophysics.init_status!-Tuple{Dict{String, ModelList}}"><code>init_status!</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">m = ModelList(light_interception=Beer(0.5), status=(LAI=2.0,))

meteo = Atmosphere(T=20.0, Wind=1.0, P=101.3, Rh=0.65, Ri_PAR_f=300.0)

light_interception!(m, meteo)

m[:aPAR]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/light/light_interception.jl#LL8-L45">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.mol_to_ms-NTuple{5, Any}" href="#PlantBiophysics.mol_to_ms-NTuple{5, Any}"><code>PlantBiophysics.mol_to_ms</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ms_to_mol(G,T,P,R,K₀)
ms_to_mol(G,T,P)</code></pre><p>Conversion of a conductance <code>G</code> from <span>$mol\ m^{-2}\ s^{-1}$</span> to <span>$m\ s^{-1}$</span>.</p><p><strong>Arguments</strong></p><ul><li><code>G</code> (<span>$m\ s^{-1}$</span>): conductance</li><li><code>T</code> (°C): air temperature</li><li><code>P</code> (kPa): air pressure</li><li><code>R</code> (<span>$J\ mol^{-1}\ K^{-1}$</span>): universal gas constant.</li><li><code>K₀</code> (°C): absolute zero</li></ul><p><strong>See also</strong></p><p><a href="#PlantBiophysics.ms_to_mol-NTuple{5, Any}"><code>ms_to_mol</code></a> for the inverse process.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/conversions.jl#LL28-L45">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.ms_to_mol-NTuple{5, Any}" href="#PlantBiophysics.ms_to_mol-NTuple{5, Any}"><code>PlantBiophysics.ms_to_mol</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ms_to_mol(G,T,P,R,K₀)
ms_to_mol(G,T,P)</code></pre><p>Conversion of a conductance <code>G</code> from <span>$m\ s^{-1}$</span> to <span>$mol\ m^{-2}\ s^{-1}$</span>.</p><p><strong>Arguments</strong></p><ul><li><code>G</code> (<span>$m\ s^{-1}$</span>): conductance</li><li><code>T</code> (°C): air temperature</li><li><code>P</code> (kPa): air pressure</li><li><code>R</code> (<span>$J\ mol^{-1}\ K^{-1}$</span>): universal gas constant.</li><li><code>K₀</code> (°C): absolute zero</li></ul><p><strong>See also</strong></p><p><a href="#PlantBiophysics.mol_to_ms-NTuple{5, Any}"><code>mol_to_ms</code></a> for the inverse process.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/conversions.jl#LL1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.net_longwave_radiation-NTuple{7, Any}" href="#PlantBiophysics.net_longwave_radiation-NTuple{7, Any}"><code>PlantBiophysics.net_longwave_radiation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">net_longwave_radiation(T₁,T₂,ε₁,ε₂,F₁,K₀,σ)
net_longwave_radiation(T₁,T₂,ε₁,ε₂,F₁)</code></pre><p>Net longwave radiation fluxes (<em>i.e.</em> thermal radiation, W m-2) between an object and another. The object of interest is at temperature T₁ and has an emissivity ε₁, and the object with which it exchanges energy is at temperature T₂ and has an emissivity ε₂.</p><p>If the result is positive, then the object of interest gain energy.</p><p><strong>Arguments</strong></p><ul><li><code>T₁</code> (Celsius degree): temperature of the target object (object 1)</li><li><code>T₂</code> (Celsius degree): temperature of the object with which there is potential exchange (object 2)</li><li><code>ε₁</code>: object 1 emissivity</li><li><code>ε₂</code>: object 2 emissivity</li><li><code>F₁</code>: view factor (0-1), <em>i.e.</em> visible fraction of object 2 from object 1 (see note)</li><li><code>K₀</code>: absolute zero (°C)</li><li><code>σ</code> (<span>$W\ m^{-2}\ K^{-4}$</span>) <a href="https://en.wikipedia.org/wiki/Stefan%E2%80%93Boltzmann_law">Stefan-Boltzmann constant</a></li></ul><p><strong>Note</strong></p><p><code>F₁</code>, the view factor (also called shape factor) is a coefficient applied to the semi-hemisphere field of view of object 1 that &quot;sees&quot; object 2. E.g. a leaf can be viewed as a plane. If one side of the leaf sees only object 2 in its field of view (e.g. the sky), then <code>F₁ = 1</code>. Then the net longwave radiation flux for this part of the leaf is multiplied by its actual surface to get the exchange. Note that we apply reciprocity between the two objects for the view factor (they have the same value), <em>i.e.</em>: A₁F₁₂ = A₂F₂₁.</p><p>Then, if we take a leaf as object 1, and the sky as object 2, the visible fraction of sky viewed by the leaf would be:</p><ul><li><code>0.5</code> if the leaf is on top of the canopy, <em>i.e.</em> the upper side of the leaf sees the sky,</li></ul><p>the side bellow sees other leaves and the soil.</p><ul><li>between 0 and 0.5 if it is within the canopy and partly shaded by other objects.</li></ul><p>Note that <code>A₁</code> for a leaf is twice its common used leaf area, because <code>A₁</code> is the <strong>total</strong> leaf area of the object that exchange energy.</p><pre><code class="language-julia hljs"># Net thermal radiation fluxes between a leaf and the sky considering the leaf at the top of
# the canopy:
Tₗ = 25.0 ; Tₐ = 20.0
ε₁ = 0.955 ; ε₂ = 1.0
Rₗₗ = net_longwave_radiation(Tₗ,Tₐ,ε₁,ε₂,1.0)
Rₗₗ

# Rₗₗ is the net longwave radiation flux between the leaf and the atmosphere per surface area.
# To get the actual net longwave radiation flux we need to multiply by the surface of the
# leaf, e.g. for a leaf of 2cm²:
leaf_area = 2e-4 # in m²
Rₗₗ * leaf_area

# The leaf lose ~0.0055 W towards the atmosphere.</code></pre><p><strong>References</strong></p><p>Cengel, Y, et Transfer Mass Heat. 2003. A practical approach. New York, NY, USA: McGraw-Hill.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/energy/longwave_energy.jl#LL57-L116">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.outputs-Tuple{T} where T&lt;:AbstractModel" href="#PlantBiophysics.outputs-Tuple{T} where T&lt;:AbstractModel"><code>PlantBiophysics.outputs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">outputs(model::AbstractModel)
outputs(...)</code></pre><p>Get the outputs of one or several models.</p><p>Returns an empty tuple by default for <code>AbstractModel</code>s (no outputs) or <code>Missing</code> models.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/models_inputs_outputs.jl#LL25-L32">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.photosynthesis" href="#PlantBiophysics.photosynthesis"><code>PlantBiophysics.photosynthesis</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">photosynthesis(object, meteo, constants = Constants())
photosynthesis!(object, meteo, constants = Constants())</code></pre><p>Generic photosynthesis model for photosynthetic organs. Computes the assimilation and stomatal conductance according to the models set in (or each component in) <code>object</code>.</p><p>The models used are defined by the types of the <code>photosynthesis</code> and <code>stomatal_conductance</code> fields of <code>leaf</code>. For exemple to use the implementation of the Farquhar–von Caemmerer–Berry (FvCB) model (see <a href="#PlantBiophysics.photosynthesis"><code>photosynthesis</code></a>), the <code>leaf.photosynthesis</code> field should be of type <a href="#PlantBiophysics.Fvcb"><code>Fvcb</code></a>.</p><p><strong>Arguments</strong></p><ul><li><code>object</code>: a <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a>, a Dict/Array of <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a>, or an MTG.</li><li><code>meteo::Union{AbstractAtmosphere,Weather}</code>: meteorology structure, see <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a> or</li></ul><p><a href="#PlantBiophysics.Weather"><code>Weather</code></a></p><ul><li><code>constants = Constants()</code>: physical constants. See <a href="#PlantBiophysics.Constants"><code>Constants</code></a> for more details</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">meteo = Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)

# Using Fvcb model:
leaf =
    ModelList(
        photosynthesis = Fvcb(),
        stomatal_conductance = Medlyn(0.03, 12.0),
        status = (Tₗ = 25.0, PPFD = 1000.0, Cₛ = 400.0, Dₗ = meteo.VPD)
    )

photosynthesis(leaf, meteo)

# ---Using several components---

leaf2 = copy(leaf)
leaf2.status.PPFD = 800.0

photosynthesis([leaf,leaf2],meteo)

# ---Using several meteo time-steps---

w = Weather(
        [
            Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65),
            Atmosphere(T = 25.0, Wind = 1.5, P = 101.3, Rh = 0.55)
        ],
        (site = &quot;Test site,)
    )

photosynthesis(leaf, w)

# ---Using several meteo time-steps and several components---

photosynthesis(Dict(:leaf1 =&gt; leaf, :leaf2 =&gt; leaf2), w)

# Using a model file:

model = read_model(&quot;a-model-file.yml&quot;)

# Initialising the mandatory variables:
init_status!(model, Tₗ = 25.0, PPFD = 1000.0, Cₛ = 400.0, Dₗ = meteo.VPD)

# Running a simulation for all component types in the same scene:
photosynthesis!(model, meteo)
model[&quot;Leaf&quot;].status.A
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/photosynthesis.jl#LL12-L81">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.photosynthesis!" href="#PlantBiophysics.photosynthesis!"><code>PlantBiophysics.photosynthesis!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">photosynthesis(object, meteo, constants = Constants())
photosynthesis!(object, meteo, constants = Constants())</code></pre><p>Generic photosynthesis model for photosynthetic organs. Computes the assimilation and stomatal conductance according to the models set in (or each component in) <code>object</code>.</p><p>The models used are defined by the types of the <code>photosynthesis</code> and <code>stomatal_conductance</code> fields of <code>leaf</code>. For exemple to use the implementation of the Farquhar–von Caemmerer–Berry (FvCB) model (see <a href="#PlantBiophysics.photosynthesis"><code>photosynthesis</code></a>), the <code>leaf.photosynthesis</code> field should be of type <a href="#PlantBiophysics.Fvcb"><code>Fvcb</code></a>.</p><p><strong>Arguments</strong></p><ul><li><code>object</code>: a <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a>, a Dict/Array of <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a>, or an MTG.</li><li><code>meteo::Union{AbstractAtmosphere,Weather}</code>: meteorology structure, see <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a> or</li></ul><p><a href="#PlantBiophysics.Weather"><code>Weather</code></a></p><ul><li><code>constants = Constants()</code>: physical constants. See <a href="#PlantBiophysics.Constants"><code>Constants</code></a> for more details</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">meteo = Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)

# Using Fvcb model:
leaf =
    ModelList(
        photosynthesis = Fvcb(),
        stomatal_conductance = Medlyn(0.03, 12.0),
        status = (Tₗ = 25.0, PPFD = 1000.0, Cₛ = 400.0, Dₗ = meteo.VPD)
    )

photosynthesis(leaf, meteo)

# ---Using several components---

leaf2 = copy(leaf)
leaf2.status.PPFD = 800.0

photosynthesis([leaf,leaf2],meteo)

# ---Using several meteo time-steps---

w = Weather(
        [
            Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65),
            Atmosphere(T = 25.0, Wind = 1.5, P = 101.3, Rh = 0.55)
        ],
        (site = &quot;Test site,)
    )

photosynthesis(leaf, w)

# ---Using several meteo time-steps and several components---

photosynthesis(Dict(:leaf1 =&gt; leaf, :leaf2 =&gt; leaf2), w)

# Using a model file:

model = read_model(&quot;a-model-file.yml&quot;)

# Initialising the mandatory variables:
init_status!(model, Tₗ = 25.0, PPFD = 1000.0, Cₛ = 400.0, Dₗ = meteo.VPD)

# Running a simulation for all component types in the same scene:
photosynthesis!(model, meteo)
model[&quot;Leaf&quot;].status.A
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/photosynthesis.jl#LL12-L81">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.photosynthesis!_" href="#PlantBiophysics.photosynthesis!_"><code>PlantBiophysics.photosynthesis!_</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">photosynthesis!_(::Fvcb, models, status, meteo, constants=Constants())</code></pre><p>Coupled photosynthesis and conductance model using the Farquhar–von Caemmerer–Berry (FvCB) model for C3 photosynthesis (Farquhar et al., 1980; von Caemmerer and Farquhar, 1981) that models the assimilation as the most limiting factor between three processes:</p><ul><li>RuBisCo-limited photosynthesis, when the kinetics of the RuBisCo enzyme for fixing</li></ul><p>CO₂ is at its maximum (RuBisCo = Ribulose-1,5-bisphosphate carboxylase-oxygenase). It happens mostly when the CO₂ concentration in the stomata is too low. The main parameter is VcMaxRef, the maximum rate of RuBisCo activity at reference temperature. See <a href="#PlantBiophysics.get_Cᵢᵥ-NTuple{7, Any}"><code>get_Cᵢᵥ</code></a> for the computation.</p><ul><li>RuBP-limited photosynthesis, when the rate of RuBP (ribulose-1,5-bisphosphate) regeneration</li></ul><p>associated with electron transport rates on the thylakoid membrane (RuBP) is limiting. It happens mostly when light is limiting, or when CO₂ concentration is rather high. It is parameterized using <code>JMaxRef</code>, the potential rate of electron transport. See <a href="#PlantBiophysics.get_Cᵢⱼ-NTuple{6, Any}"><code>get_Cᵢⱼ</code></a> for the computation.</p><ul><li>TPU-limited photosynthesis, when the rate at which inorganic phosphate is released for</li></ul><p>regenerating ATP from ADP during the utilization of triose phosphate (TPU) is limiting. It happens at very high assimilation rate, when neither light or CO₂ are limiting factors. The parameter is <code>TPURef</code>.</p><p>The computation in this function is made following Farquhar &amp; Wong (1984), Leuning et al. (1995), and the MAESPA model (Duursma et al., 2012).</p><p>The resolution is analytical as first presented in Baldocchi (1994), and needs Cₛ as input. Triose phosphate utilization (TPU) limitation is taken into account as proposed in Lombardozzi (2018) (<em>i.e.</em> <code>Aₚ = 3 * TPURef</code>, making the assumption that glycolate recycling is set to <code>0</code>). <code>TPURef</code> is set at <code>9999.0</code> by default, meaning there is no limitation of photosynthesis by TPU. Note that <code>TPURef</code> can be (badly) approximated using the simple equation <code>TPURef = 0.167 * VcMaxRef</code> as presented in Lombardozzi (2018).</p><p>If you prefer to use Gbc, you can use the iterative implementation of the Fvcb model <a href="#PlantBiophysics.FvcbIter"><code>FvcbIter</code></a></p><p>If you want a version that is de-coupled from the stomatal conductance use <a href="#PlantBiophysics.FvcbRaw"><code>FvcbRaw</code></a>, but you&#39;ll need Cᵢ as input of the model.</p><p><strong>Returns</strong></p><p>Modify the first argument in place for A, Gₛ and Cᵢ:</p><ul><li>A: carbon assimilation (μmol[CO₂] m-2 s-1)</li><li>Gₛ: stomatal conductance for CO₂ (mol[CO₂] m-2 s-1)</li><li>Cᵢ: intercellular CO₂ concentration (ppm)</li></ul><p><strong>Arguments</strong></p><ul><li><code>::Fvcb</code>: the Farquhar–von Caemmerer–Berry (FvCB) model</li><li><code>models</code>: a <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a> struct holding the parameters for the model with</li></ul><p>initialisations for:     - <code>Tₗ</code> (°C): leaf temperature     - <code>PPFD</code> (μmol m-2 s-1): absorbed Photosynthetic Photon Flux Density     - <code>Cₛ</code> (ppm): surface CO₂ concentration.     - <code>Dₗ</code> (kPa): vapour pressure difference between the surface and the saturated     air vapour pressure in case you&#39;re using the stomatal conductance model of <a href="#PlantBiophysics.Medlyn"><code>Medlyn</code></a>.</p><ul><li><code>status</code>: A status, usually the leaf status (<em>i.e.</em> leaf.status)</li><li><code>meteo</code>: meteorology structure, see <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a></li><li><code>constants = Constants()</code>: physical constants. See <a href="#PlantBiophysics.Constants"><code>Constants</code></a> for more details</li></ul><p><strong>Note</strong></p><p><code>Tₗ</code>, <code>PPFD</code>, <code>Cₛ</code> (and <code>Dₗ</code> if you use <a href="#PlantBiophysics.Medlyn"><code>Medlyn</code></a>) must be initialized by providing them as keyword arguments (see examples). If in doubt, it is simpler to compute the energy balance of the leaf with the photosynthesis to get those variables. See <a href="#PlantBiophysics.energy_balance"><code>energy_balance</code></a> for more details.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">meteo = Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)

leaf =
    ModelList(
        photosynthesis = Fvcb(),
        stomatal_conductance = Medlyn(0.03, 12.0),
        status = (Tₗ = 25.0, PPFD = 1000.0, Cₛ = 400.0, Dₗ = meteo.VPD)
    )
# NB: we need  to initalise Tₗ, PPFD and Cₛ

photosynthesis!(leaf,meteo,Constants())
leaf.status.A
leaf.status.Cᵢ</code></pre><p><strong>References</strong></p><p>Baldocchi, Dennis. 1994. « An analytical solution for coupled leaf photosynthesis and stomatal conductance models ». Tree Physiology 14 (7-8‑9): 1069‑79. https://doi.org/10.1093/treephys/14.7-8-9.1069.</p><p>Duursma, R. A., et B. E. Medlyn. 2012. « MAESPA: a model to study interactions between water limitation, environmental drivers and vegetation function at tree and stand levels, with an example application to [CO2] × drought interactions ». Geoscientific Model Development 5 (4): 919‑40. https://doi.org/10.5194/gmd-5-919-2012.</p><p>Farquhar, G. D., S. von von Caemmerer, et J. A. Berry. 1980. « A biochemical model of photosynthetic CO2 assimilation in leaves of C3 species ». Planta 149 (1): 78‑90.</p><p>Leuning, R., F. M. Kelliher, DGG de Pury, et E.D. Schulze. 1995. « Leaf nitrogen, photosynthesis, conductance and transpiration: scaling from leaves to canopies ». Plant, Cell &amp; Environment 18 (10): 1183‑1200.</p><p>Lombardozzi, L. D. et al. 2018.« Triose phosphate limitation in photosynthesis models reduces leaf photosynthesis and global terrestrial carbon storage ». Environmental Research Letters 13.7: 1748-9326. https://doi.org/10.1088/1748-9326/aacf68.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/FvCB.jl#LL120-L227">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.photosynthesis!_" href="#PlantBiophysics.photosynthesis!_"><code>PlantBiophysics.photosynthesis!_</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">photosynthesis!_(::FvcbIter, models, status, meteo, constants=Constants())</code></pre><p>Photosynthesis using the Farquhar–von Caemmerer–Berry (FvCB) model for C3 photosynthesis  (Farquhar et al., 1980; von Caemmerer and Farquhar, 1981). Computation is made following Farquhar &amp; Wong (1984), Leuning et al. (1995), and the Archimed model.</p><p>Iterative implementation, i.e. the assimilation is computed iteratively over Cᵢ. For the analytical resolution, see <a href="#PlantBiophysics.Fvcb"><code>Fvcb</code></a>.</p><p><strong>Returns</strong></p><p>Modify the first argument in place for A, Gₛ and Cᵢ:</p><ul><li>A: carbon assimilation (μmol[CO₂] m-2 s-1)</li><li>Gₛ: stomatal conductance for CO₂ (mol[CO₂] m-2 s-1)</li><li>Cᵢ: intercellular CO₂ concentration (ppm)</li></ul><p><strong>Arguments</strong></p><ul><li><code>::FvcbIter</code>: Farquhar–von Caemmerer–Berry (FvCB) model with iterative resolution.</li><li><code>models</code>: a <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a> struct holding the parameters for the model with</li></ul><p>initialisations for:     - <code>Tₗ</code> (°C): leaf temperature     - <code>PPFD</code> (μmol m-2 s-1): absorbed Photosynthetic Photon Flux Density     - <code>Gbc</code> (mol m-2 s-1): boundary conductance for CO₂     - <code>Dₗ</code> (kPa): is the difference between the vapour pressure at the leaf surface and the     saturated air vapour pressure in case you&#39;re using the stomatal conductance model of <a href="#PlantBiophysics.Medlyn"><code>Medlyn</code></a>.</p><ul><li><code>status</code>: A status, usually the leaf status (<em>i.e.</em> leaf.status)</li><li><code>meteo</code>: meteorology structure, see <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a></li><li><code>constants = Constants()</code>: physical constants. See <a href="#PlantBiophysics.Constants"><code>Constants</code></a> for more details</li></ul><p><strong>Note</strong></p><p><code>Tₗ</code>, <code>PPFD</code>, <code>Gbc</code> (and <code>Dₗ</code> if you use <a href="#PlantBiophysics.Medlyn"><code>Medlyn</code></a>) must be initialized by providing them as keyword arguments (see examples). If in doubt, it is simpler to compute the energy balance of the leaf with the photosynthesis to get those variables. See <a href="#PlantBiophysics.energy_balance"><code>energy_balance</code></a> for more details.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">meteo = Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)

leaf =
    ModelList(
        photosynthesis = FvcbIter(),
        stomatal_conductance = Medlyn(0.03, 12.0),
        status = (Tₗ = 25.0, PPFD = 1000.0, Gbc = 0.67, Dₗ = meteo.VPD)
    )
# NB: we need  to initalise Tₗ, PPFD and Gbc.

photosynthesis!_(leaf,meteo,Constants())
leaf.status.A
leaf.status.Cᵢ</code></pre><p><strong>References</strong></p><p>Baldocchi, Dennis. 1994. « An analytical solution for coupled leaf photosynthesis and stomatal conductance models ». Tree Physiology 14 (7-8‑9): 1069‑79. https://doi.org/10.1093/treephys/14.7-8-9.1069.</p><p>Farquhar, G. D., S. von von Caemmerer, et J. A. Berry. 1980. « A biochemical model of photosynthetic CO2 assimilation in leaves of C3 species ». Planta 149 (1): 78‑90.</p><p>Leuning, R., F. M. Kelliher, DGG de Pury, et E.D. Schulze. 1995. Leaf nitrogen, photosynthesis, conductance and transpiration: scaling from leaves to canopies ». Plant, Cell &amp; Environment 18 (10): 1183‑1200.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/FvCBIter.jl#LL61-L131">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.photosynthesis!_" href="#PlantBiophysics.photosynthesis!_"><code>PlantBiophysics.photosynthesis!_</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">photosynthesis!_(::FvcbRaw, models, status, meteo=nothing, constants=Constants())</code></pre><p>Direct implementation of the photosynthesis model for C3 photosynthesis from Farquhar–von Caemmerer–Berry (Farquhar et al., 1980; von Caemmerer and Farquhar, 1981).</p><p><strong>Returns</strong></p><p>Modify the first argument in place for A, the carbon assimilation (μmol[CO₂] m-2 s-1).</p><p><strong>Arguments</strong></p><ul><li><code>::FvcbRaw</code>: the Farquhar–von Caemmerer–Berry (FvCB) model (not coupled)</li><li><code>models</code>: a <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a> struct holding the parameters for the model with</li></ul><p>initialisations for:     - <code>Tₗ</code> (°C): leaf temperature     - <code>PPFD</code> (μmol m-2 s-1): absorbed Photosynthetic Photon Flux Density     - <code>Cₛ</code> (ppm): surface CO₂ concentration.     - <code>Dₗ</code> (kPa): vapour pressure difference between the surface and the saturated     air vapour pressure in case you&#39;re using the stomatal conductance model of <a href="#PlantBiophysics.Medlyn"><code>Medlyn</code></a>.</p><ul><li><code>status</code>: A status, usually the leaf status (<em>i.e.</em> leaf.status)</li><li><code>constants = Constants()</code>: physical constants. See <a href="#PlantBiophysics.Constants"><code>Constants</code></a> for more details</li></ul><p><strong>Note</strong></p><p><code>Tₗ</code>, <code>PPFD</code>, <code>Cₛ</code> (and <code>Dₗ</code> if you use <a href="#PlantBiophysics.Medlyn"><code>Medlyn</code></a>) must be initialized by providing them as keyword arguments (see examples). If in doubt, it is simpler to compute the energy balance of the leaf with the photosynthesis to get those variables. See <a href="#PlantBiophysics.energy_balance"><code>energy_balance</code></a> for more details.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">leaf = ModelList(photosynthesis = FvcbRaw(), status = (Tₗ = 25.0, PPFD = 1000.0, Cᵢ = 400.0))
# NB: we need Tₗ, PPFD and Cᵢ as inputs (see [`inputs`](@ref))

photosynthesis!_(leaf)
leaf.status.A
leaf.status.Cᵢ

# using several time-steps:
leaf =
    ModelList(
        photosynthesis = FvcbRaw(),
        status = (Tₗ = [20., 25.0], PPFD = 1000.0, Cᵢ = [380.,400.0])
    )
# NB: we need Tₗ, PPFD and Cᵢ as inputs (see [`inputs`](@ref))

photosynthesis!_(leaf)
DataFrame(leaf) # fetch the leaf status as a DataFrame</code></pre><p><strong>References</strong></p><p>Baldocchi, Dennis. 1994. « An analytical solution for coupled leaf photosynthesis and stomatal conductance models ». Tree Physiology 14 (7-8‑9): 1069‑79. https://doi.org/10.1093/treephys/14.7-8-9.1069.</p><p>Duursma, R. A., et B. E. Medlyn. 2012. « MAESPA: a model to study interactions between water limitation, environmental drivers and vegetation function at tree and stand levels, with an example application to [CO2] × drought interactions ». Geoscientific Model Development 5 (4): 919‑40. https://doi.org/10.5194/gmd-5-919-2012.</p><p>Farquhar, G. D., S. von von Caemmerer, et J. A. Berry. 1980. « A biochemical model of photosynthetic CO2 assimilation in leaves of C3 species ». Planta 149 (1): 78‑90.</p><p>Leuning, R., F. M. Kelliher, DGG de Pury, et E.D. Schulze. 1995. « Leaf nitrogen, photosynthesis, conductance and transpiration: scaling from leaves to canopies ». Plant, Cell &amp; Environment 18 (10): 1183‑1200.</p><p>Lombardozzi, L. D. et al. 2018.« Triose phosphate limitation in photosynthesis models reduces leaf photosynthesis and global terrestrial carbon storage ». Environmental Research Letters 13.7: 1748-9326. https://doi.org/10.1088/1748-9326/aacf68.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/FvCBRaw.jl#LL70-L143">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.photosynthesis!_" href="#PlantBiophysics.photosynthesis!_"><code>PlantBiophysics.photosynthesis!_</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">photosynthesis!_(::ConstantA; models, status, meteo, constants=Constants())</code></pre><p>Constant photosynthesis (forcing the value).</p><p><strong>Returns</strong></p><p>Modify the leaf status in place for A with a constant value:</p><ul><li>A: carbon assimilation, set to leaf.photosynthesis.A (μmol[CO₂] m-2 s-1)</li></ul><p><strong>Arguments</strong></p><ul><li><code>::ConstantA</code>: a constant assimilation model</li><li><code>models</code>: a <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a> struct holding the parameters for the model.</li><li><code>status</code>: A status, usually the leaf status (<em>i.e.</em> leaf.status)</li><li><code>meteo</code>: meteorology structure, see <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a></li><li><code>constants = Constants()</code>: physical constants. See <a href="#PlantBiophysics.Constants"><code>Constants</code></a> for more details</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">meteo = Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)
leaf = ModelList(photosynthesis = ConstantA(26.0))

photosynthesis!(leaf,meteo,Constants())

leaf.status.A</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/constantA.jl#LL28-L57">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.photosynthesis!_" href="#PlantBiophysics.photosynthesis!_"><code>PlantBiophysics.photosynthesis!_</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">photosynthesis!_(::ConstantAGs, models, status, meteo, constants=Constants())</code></pre><p>Constant photosynthesis coupled with a stomatal conductance model.</p><p><strong>Returns</strong></p><p>Modify the leaf status in place for A, Gₛ and Cᵢ:</p><ul><li>A: carbon assimilation, set to leaf.photosynthesis.A (μmol[CO₂] m-2 s-1)</li><li>Gₛ: stomatal conductance for CO₂ (mol[CO₂] m-2 s-1)</li><li>Cᵢ: intercellular CO₂ concentration (ppm)</li></ul><p><strong>Arguments</strong></p><ul><li><code>::ConstantAGs</code>: a constant assimilation model coupled to a stomatal conductance model</li><li><code>models</code>: a <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a> struct holding the parameters for the model with</li></ul><p>initialisations for:     - <code>Cₛ</code> (mol m-2 s-1): surface CO₂ concentration.     - any other value needed by the stomatal conductance model.</p><ul><li><code>status</code>: A status, usually the leaf status (<em>i.e.</em> leaf.status)</li><li><code>meteo</code>: meteorology structure, see <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a></li><li><code>constants = Constants()</code>: physical constants. See <a href="#PlantBiophysics.Constants"><code>Constants</code></a> for more details</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">meteo = Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)
leaf = ModelList(
    photosynthesis = ConstantAGs(),
    stomatal_conductance = Medlyn(0.03, 12.0),
    status = (Cₛ = 400.0, Dₗ = 2.0)
)

photosynthesis!(leaf,meteo,Constants())

status(leaf, :A)
status(leaf, :Cᵢ)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/constantAGs.jl#LL26-L65">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.psychrometer_constant-NTuple{4, Any}" href="#PlantBiophysics.psychrometer_constant-NTuple{4, Any}"><code>PlantBiophysics.psychrometer_constant</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">psychrometer_constant(P, λ, Cₚ, ε)
psychrometer_constant(P, λ)</code></pre><p>γ, the psychrometer constant, also called psychrometric constant (kPa K−1). See Monteith and Unsworth (2013), p. 222.</p><p><strong>Arguments</strong></p><ul><li><code>P</code> (kPa): air pressure</li><li><code>λ</code> (<span>$J\ kg^{-1}$</span>): latent heat of vaporization for water (see <a href="#PlantBiophysics.latent_heat_vaporization-Tuple{Any, Any}"><code>latent_heat_vaporization</code></a>)</li><li><code>Cₚ</code> (J kg-1 K-1): specific heat of air at constant pressure (<span>$J\ K^{-1}\ kg^{-1}$</span>)</li><li><code>ε</code> (Celsius degree): temperature in Celsius degree at 0 Kelvin</li></ul><p><strong>Note</strong></p><p>Cₚ, ε and λ₀ are taken from <a href="#PlantBiophysics.Constants"><code>Constants</code></a> if not provided.</p><pre><code class="language-julia hljs">Tₐ = 20.0

λ = latent_heat_vaporization(Tₐ, λ₀)
psychrometer_constant(100.0, λ)</code></pre><p><strong>References</strong></p><p>Monteith, John L., et Mike H. Unsworth. 2013. « Chapter 13 - Steady-State Heat Balance: (i) Water Surfaces, Soil, and Vegetation ». In Principles of Environmental Physics (Fourth Edition), edited by John L. Monteith et Mike H. Unsworth, 217‑47. Boston: Academic Press.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/climate/variables_computations.jl#LL61-L93">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.pull_status!-Tuple{Any}" href="#PlantBiophysics.pull_status!-Tuple{Any}"><code>PlantBiophysics.pull_status!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">pull_status!(node)</code></pre><p>Copy the status of a node&#39;s component models (<em>e.g.</em> the outputs of a [<code>ModelList</code>]@ref simulation) into the MTG attributes. This function is used when we need to compute further the simulation outputs with <em>e.g.</em> <a href="@ref"><code>transform!</code></a>.</p><p><strong>Notes</strong></p><p>Carefull, this function makes a copy, so the values are then present at two locations (can take a lot of memory space if using several plants).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Read the file
mtg = read_mtg(joinpath(dirname(dirname(pathof(PlantBiophysics))),&quot;test&quot;,&quot;inputs&quot;,&quot;scene&quot;,&quot;opf&quot;,&quot;coffee.opf&quot;))

# Declare our models:
models = Dict(
    &quot;Leaf&quot; =&gt;
        ModelList(
            energy_balance = Monteith(),
            photosynthesis = Fvcb(),
            stomatal_conductance = Medlyn(0.03, 12.0),
            status = (d = 0.03,)
        )
)

transform!(
    mtg,
    [:Ra_PAR_f, :Ra_NIR_f] =&gt; ((x, y) -&gt; x + y) =&gt; :Rₛ,
    :Ra_PAR_f =&gt; (x -&gt; x * 4.57) =&gt; :PPFD,
    ignore_nothing = true
)

# Initialising all components with their corresponding models and initialisations:
init_mtg_models!(mtg, models)

# Make a simulation
transform!(mtg, :models =&gt; (x -&gt; energy_balance!(x, meteo)), ignore_nothing = true)
# Pull the simulation results into the MTG attributes:
transform!(mtg, pull_status!)
# Now the simulated variables are available from the MTG attributes field:
names(mtg)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/mtg/mtg_helpers.jl#LL1-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.read_licor6400-Tuple{Any}" href="#PlantBiophysics.read_licor6400-Tuple{Any}"><code>PlantBiophysics.read_licor6400</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_licor6400(file)</code></pre><p>Import Licor6400 data (such as Medlyn 2001 data) with the units and names corresponding to the ones used in PlantBiophysics.jl.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/io/read_licor6400.jl#LL1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.read_model-Tuple{Any}" href="#PlantBiophysics.read_model-Tuple{Any}"><code>PlantBiophysics.read_model</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_model(file)</code></pre><p>Read a model file. The model file holds the choice and the parameterization of the models.</p><p><strong>Arguments</strong></p><ul><li><code>file::String</code>: path to a model file</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">file = joinpath(dirname(dirname(pathof(PlantBiophysics))), &quot;test&quot;, &quot;inputs&quot;, &quot;models&quot;, &quot;plant_coffee.yml&quot;)
models = read_model(file)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/io/read_model.jl#LL3-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.read_walz-Tuple{Any}" href="#PlantBiophysics.read_walz-Tuple{Any}"><code>PlantBiophysics.read_walz</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_walz(file)</code></pre><p>Import a Walz GFS-3000 output file.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">file = joinpath(dirname(dirname(pathof(PlantBiophysics))),&quot;test&quot;,&quot;inputs&quot;,&quot;data&quot;,&quot;P1F20129.csv&quot;)
read_walz(file)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/io/read_walz.jl#LL1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.read_weather-Tuple{Any, Vararg{Any}}" href="#PlantBiophysics.read_weather-Tuple{Any, Vararg{Any}}"><code>PlantBiophysics.read_weather</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_weather(file[,args...];
    date_format = DateFormat(&quot;yyyy-mm-ddTHH:MM:SS.s&quot;),
    hour_format = DateFormat(&quot;HH:MM:SS&quot;)
)</code></pre><p>Read a meteo file. The meteo file is a CSV, and optionnaly with metadata in a header formatted as a commented YAML. The column names <strong>and units</strong> should match exactly the fields of <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a>, or the user should provide their transformation as arguments (<code>args</code>) to help mapping the two. The transformations are given as for <code>DataFrames</code>.</p><p><strong>Note</strong></p><p>The variables found in the file will be used as is if not transformed, and not recomputed from the other variables. Please check that all variables have the same units as in the <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a> structure.</p><p><strong>Arguments</strong></p><ul><li><code>file::String</code>: path to a meteo file</li><li><code>var_names = Dict()</code>: A Dict to map the file variable names to the Atmosphere variable names</li><li><code>date_format = DateFormat(&quot;yyyy-mm-ddTHH:MM:SS.s&quot;)</code>: the format for the <code>DateTime</code> columns</li><li><code>hour_format = DateFormat(&quot;HH:MM:SS&quot;)</code>: the format for the <code>Time</code> columns (<em>e.g.</em> <code>hour_start</code>)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using Dates

file = joinpath(dirname(dirname(pathof(PlantBiophysics))),&quot;test&quot;,&quot;inputs&quot;,&quot;meteo.csv&quot;)

meteo = read_weather(
    file,
    :temperature =&gt; :T,
    :relativeHumidity =&gt; (x -&gt; x ./100) =&gt; :Rh,
    :wind =&gt; :Wind,
    :atmosphereCO2_ppm =&gt; :Cₐ,
    date_format = DateFormat(&quot;yyyy/mm/dd&quot;)
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/io/read_weather.jl#LL1-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.rh_from_e-Tuple{Any, Any}" href="#PlantBiophysics.rh_from_e-Tuple{Any, Any}"><code>PlantBiophysics.rh_from_e</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rh_from_e(VPD,eₛ)</code></pre><p>Conversion between e (kPa) and rh (0-1).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">rh_from_e(1.5,25.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/conversions.jl#LL87-L97">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.rh_from_vpd-Tuple{Any, Any}" href="#PlantBiophysics.rh_from_vpd-Tuple{Any, Any}"><code>PlantBiophysics.rh_from_vpd</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rh_from_vpd(VPD,eₛ)</code></pre><p>Conversion between VPD and rh.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">eₛ = e_sat(Tₐ)
rh_from_vpd(1.5,eₛ)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/conversions.jl#LL71-L82">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.sensible_heat-NTuple{8, Any}" href="#PlantBiophysics.sensible_heat-NTuple{8, Any}"><code>PlantBiophysics.sensible_heat</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">sensible_heat(Rn, VPD, γˢ, Rbₕ, Δ, ρ, aₛₕ, Cₚ)
sensible_heat(Rn, VPD, γˢ, Rbₕ, Δ, ρ, aₛₕ)</code></pre><p>H -the sensible heat flux (W m-2)- using the Monteith and Unsworth (2013) definition corrected by Schymanski et al. (2017), eq.22.</p><ul><li><code>Rn</code> (W m-2): net radiation. Carefull: not the isothermal net radiation</li><li><code>VPD</code> (kPa): air vapor pressure deficit</li><li><code>γˢ</code> (kPa K−1): apparent value of psychrometer constant (see <a href="#PlantBiophysics.γ_star-NTuple{6, Any}"><code>γ_star</code></a>)</li><li><code>Rbₕ</code> (s m-1): resistance for heat transfer by convection, i.e. resistance to sensible heat</li><li><code>Δ</code> (KPa K-1): rate of change of saturation vapor pressure with temperature (see <a href="#PlantBiophysics.e_sat_slope-Tuple{Any}"><code>e_sat_slope</code></a>)</li><li><code>ρ</code> (kg m-3): air density of moist air.</li><li><code>aₛₕ</code> (1,2): number of sides that exchange energy for heat (2 for leaves)</li><li><code>Cₚ</code> (J K-1 kg-1): specific heat of air for constant pressure</li></ul><p><strong>References</strong></p><p>Monteith, J. and Unsworth, M., 2013. Principles of environmental physics: plants, animals, and the atmosphere. Academic Press. See eq. 13.33.</p><p>Schymanski et al. (2017), Leaf-scale experiments reveal an important omission in the Penman–Monteith equation, Hydrology and Earth System Sciences. DOI: https://doi.org/10.5194/hess-21-685-2017. See equ. 22.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">Tₐ = 20.0 ; P = 100.0 ;
ρ = air_density(Tₐ, P) # in kg m-3
Δ = e_sat_slope(Tₐ)

sensible_heat(300.0, 2.0, 0.1461683, 50.0, Δ, ρ, 2.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/energy/Monteith.jl#LL273-L305">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.status-Tuple{Any}" href="#PlantBiophysics.status-Tuple{Any}"><code>PlantBiophysics.status</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">status(m)
status(m::AbstractArray{&lt;:ModelList})
status(m::AbstractDict{T,&lt;:ModelList})</code></pre><p>Get a ModelList status, <em>i.e.</em> the state of the input (and output) variables.</p><p>See also <a href="#PlantBiophysics.is_initialized-Tuple{T} where T&lt;:ModelList"><code>is_initialized</code></a> and <a href="#PlantBiophysics.to_initialize-Tuple{ModelList}"><code>to_initialize</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/component_models/get_status.jl#LL1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.stomatal_conductance" href="#PlantBiophysics.stomatal_conductance"><code>PlantBiophysics.stomatal_conductance</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">stomatal_conductance(leaf::ModelList,gs_mod)
stomatal_conductance(leaf::ModelList,meteo&lt;:AbstractAtmosphere)</code></pre><p>Default method to compute the stomatal conductance for CO₂ (mol m-2 s-1), it takes the form:</p><p><code>leaf.stomatal_conductance.g0 + gs_closure(leaf,meteo) * leaf.status.A</code></p><p>where gs<em>closure(leaf,meteo) computes the stomatal closure, and must be implemented for the type of `leaf.stomatal</em>conductance<code>. The stomatal conductance is not allowed to go below</code>leaf.stomatal<em>conductance.gs</em>min`.</p><p><strong>Arguments</strong></p><ul><li><code>Gs::Gsm</code>: a stomatal conductance model, usually the leaf model (<em>i.e.</em> leaf.stomatal_conductance)</li><li><code>models::ModelList</code>: A leaf struct holding the parameters for the model. See</li></ul><p><a href="#PlantBiophysics.ModelList"><code>ModelList</code></a>, and <a href="#PlantBiophysics.Medlyn"><code>Medlyn</code></a> or <a href="#PlantBiophysics.ConstantGs"><code>ConstantGs</code></a> for the conductance models.</p><ul><li><code>status::Status</code>: A status, usually the leaf status (<em>i.e.</em> leaf.status)</li><li><code>gs_mod</code>: the output from a <a href="#PlantBiophysics.gs_closure"><code>gs_closure</code></a> implementation (the conductance models</li></ul><p>generally only implement this function)</p><ul><li><code>meteo&lt;:AbstractAtmosphere</code>: meteo data, see <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">meteo = Atmosphere(T = 22.0, Wind = 0.8333, P = 101.325, Rh = 0.4490995)

# Using a constant value for Gs:

leaf =
    ModelList(
        stomatal_conductance = Medlyn(0.03,12.0), # Instance of a Medlyn type
        status = (A = 20.0, Cₛ = 380.0, Dₗ = meteo.VPD)
    )

# Computing the stomatal conductance using the Medlyn et al. (2011) model:
stomatal_conductance(leaf,meteo)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/conductances/stomatal/stomatal_conductance.jl#LL13-L51">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.stomatal_conductance!" href="#PlantBiophysics.stomatal_conductance!"><code>PlantBiophysics.stomatal_conductance!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">stomatal_conductance(leaf::ModelList,gs_mod)
stomatal_conductance(leaf::ModelList,meteo&lt;:AbstractAtmosphere)</code></pre><p>Default method to compute the stomatal conductance for CO₂ (mol m-2 s-1), it takes the form:</p><p><code>leaf.stomatal_conductance.g0 + gs_closure(leaf,meteo) * leaf.status.A</code></p><p>where gs<em>closure(leaf,meteo) computes the stomatal closure, and must be implemented for the type of `leaf.stomatal</em>conductance<code>. The stomatal conductance is not allowed to go below</code>leaf.stomatal<em>conductance.gs</em>min`.</p><p><strong>Arguments</strong></p><ul><li><code>Gs::Gsm</code>: a stomatal conductance model, usually the leaf model (<em>i.e.</em> leaf.stomatal_conductance)</li><li><code>models::ModelList</code>: A leaf struct holding the parameters for the model. See</li></ul><p><a href="#PlantBiophysics.ModelList"><code>ModelList</code></a>, and <a href="#PlantBiophysics.Medlyn"><code>Medlyn</code></a> or <a href="#PlantBiophysics.ConstantGs"><code>ConstantGs</code></a> for the conductance models.</p><ul><li><code>status::Status</code>: A status, usually the leaf status (<em>i.e.</em> leaf.status)</li><li><code>gs_mod</code>: the output from a <a href="#PlantBiophysics.gs_closure"><code>gs_closure</code></a> implementation (the conductance models</li></ul><p>generally only implement this function)</p><ul><li><code>meteo&lt;:AbstractAtmosphere</code>: meteo data, see <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">meteo = Atmosphere(T = 22.0, Wind = 0.8333, P = 101.325, Rh = 0.4490995)

# Using a constant value for Gs:

leaf =
    ModelList(
        stomatal_conductance = Medlyn(0.03,12.0), # Instance of a Medlyn type
        status = (A = 20.0, Cₛ = 380.0, Dₗ = meteo.VPD)
    )

# Computing the stomatal conductance using the Medlyn et al. (2011) model:
stomatal_conductance(leaf,meteo)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/conductances/stomatal/stomatal_conductance.jl#LL13-L51">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.to_initialize-Tuple{ModelList}" href="#PlantBiophysics.to_initialize-Tuple{ModelList}"><code>PlantBiophysics.to_initialize</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">to_initialize(v::T, vars...) where T &lt;: Union{Missing,AbstractModel}
to_initialize(m::T)  where T &lt;: ModelList</code></pre><p>Return the variables that must be initialized providing a set of models and processes. The function takes into account model coupling and only returns the variables that are needed considering that some variables that are outputs of some models are used as inputs of others.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">to_initialize(photosynthesis = Fvcb(), stomatal_conductance = Medlyn(0.03,12.0))

# Or using a component directly:
leaf = ModelList(photosynthesis = Fvcb(), stomatal_conductance = Medlyn(0.03,12.0))
to_initialize(leaf)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/model_initialisation.jl#LL1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.vapor_pressure-Tuple{Any, Any}" href="#PlantBiophysics.vapor_pressure-Tuple{Any, Any}"><code>PlantBiophysics.vapor_pressure</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">vapor_pressure(Tₐ, rh)</code></pre><p>Vapor pressure (kPa) at given temperature (°C) and relative hunidity (0-1).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/climate/variables_computations.jl#LL1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.variables-Tuple{}" href="#PlantBiophysics.variables-Tuple{}"><code>PlantBiophysics.variables</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">variables()</code></pre><p>Returns a dataframe of all variables in PlantBiophysics, their description and their units.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/models_inputs_outputs.jl#LL77-L81">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.variables-Union{Tuple{T}, Tuple{T, Vararg{Any}}} where T&lt;:Union{Missing, AbstractModel}" href="#PlantBiophysics.variables-Union{Tuple{T}, Tuple{T, Vararg{Any}}} where T&lt;:Union{Missing, AbstractModel}"><code>PlantBiophysics.variables</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">variables(model)
variables(model, models...)</code></pre><p>Returns a tuple with the name of the variables needed by a model, or a union of those variables for several models.</p><p><strong>Note</strong></p><p>Each model can (and should) have a method for this function.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">variables(Monteith())

variables(Monteith(), Medlyn(0.03,12.0))</code></pre><p><strong>See also</strong></p><p><a href="#PlantBiophysics.inputs-Tuple{T} where T&lt;:AbstractModel"><code>inputs</code></a>, <a href="#PlantBiophysics.outputs-Tuple{T} where T&lt;:AbstractModel"><code>outputs</code></a> and <a href="#PlantBiophysics.variables_typed-Tuple{T} where T&lt;:AbstractModel"><code>variables_typed</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/models_inputs_outputs.jl#LL50-L72">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.variables_typed-Tuple{T} where T&lt;:AbstractModel" href="#PlantBiophysics.variables_typed-Tuple{T} where T&lt;:AbstractModel"><code>PlantBiophysics.variables_typed</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">variables_typed(model)
variables_typed(model, models...)</code></pre><p>Returns a named tuple with the name and the types of the variables needed by a model, or a union of those for several models.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">variables_typed(Monteith())

variables_typed(Monteith(), Medlyn(0.03,12.0))</code></pre><p><strong>See also</strong></p><p><a href="#PlantBiophysics.inputs-Tuple{T} where T&lt;:AbstractModel"><code>inputs</code></a>, <a href="#PlantBiophysics.outputs-Tuple{T} where T&lt;:AbstractModel"><code>outputs</code></a> and <a href="#PlantBiophysics.variables-Tuple{}"><code>variables</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/models_inputs_outputs.jl#LL86-L105">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.Γ_star" href="#PlantBiophysics.Γ_star"><code>PlantBiophysics.Γ_star</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Γ_star(Tₖ,Tᵣₖ,R = Constants().R)</code></pre><p>CO₂ compensation point <span>$Γ^⋆$</span> (<span>$μ mol\ mol^{-1}$</span>) according to equation (12) from Medlyn et al. (2002).</p><blockquote><p><span>$Γ^⋆$</span> is the [CO₂] at which oxygenation proceeds at</p></blockquote><p>twice the rate of carboxylation causing photosynthetic uptake of CO2 to be exactly compensated by photorespiratory CO₂ release (Sharkey et al., 2007).</p><p><strong>Notes</strong></p><p>Could be replaced by equation (38) from Farquhar et al. (1980), but Medlyn et al. (2002) states that <span>$Γ^⋆$</span> as a relatively low effect on the model outputs.</p><p><strong>Arguments</strong></p><ul><li><code>Tₖ</code> (Kelvin): current temperature</li><li><code>Tᵣₖ</code> (Kelvin): reference temperature at which A was measured</li><li><code>R</code> (<span>$J\ mol^{-1}\ K^{-1}$</span>): is the universal gas constant</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Importing the physical constants:
constants = Constants()
# computing the temperature dependence of γˢ:
Γ_star(28-constants.K₀,25-constants.K₀,constants.R)</code></pre><p><strong>References</strong></p><p>Farquhar, G. D., S. von von Caemmerer, et J. A. Berry. 1980. « A biochemical model of photosynthetic CO2 assimilation in leaves of C3 species ». Planta 149 (1): 78‑90.</p><p>Medlyn, B. E., E. Dreyer, D. Ellsworth, M. Forstreuter, P. C. Harley, M. U. F. Kirschbaum, X. Le Roux, et al. 2002. « Temperature response of parameters of a biochemically based model of photosynthesis. II. A review of experimental data ». Plant, Cell &amp; Environment 25 (9): 1167‑79. https://doi.org/10.1046/j.1365-3040.2002.00891.x.</p><p>Sharkey, Thomas D., Carl J. Bernacchi, Graham D. Farquhar, et Eric L. Singsaas. 2007. « Fitting Photosynthetic Carbon Dioxide Response Curves for C3 Leaves ». Plant, Cell &amp; Environment 30 (9): 1035‑40. https://doi.org/10.1111/j.1365-3040.2007.01710.x.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/temperature-dependence.jl#LL90-L134">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.γ_star-NTuple{6, Any}" href="#PlantBiophysics.γ_star-NTuple{6, Any}"><code>PlantBiophysics.γ_star</code></a> — <span class="docstring-category">Method</span></header><section><div><p>γ<em>star(γ, a</em>sh, a_s, rbv, Rsᵥ, Rbₕ)</p><p>γ∗, the apparent value of psychrometer constant (kPa K−1).</p><p><strong>Arguments</strong></p><ul><li><code>γ</code> (kPa K−1): psychrometer constant</li><li><code>aₛₕ</code> (1,2): number of faces exchanging heat fluxes (see Schymanski et al., 2017)</li><li><code>aₛᵥ</code> (1,2): number of faces exchanging water fluxes (see Schymanski et al., 2017)</li><li><code>Rbᵥ</code> (s m-1): boundary layer resistance to water vapor</li><li><code>Rsᵥ</code> (s m-1): stomatal resistance to water vapor</li><li><code>Rbₕ</code> (s m-1): boundary layer resistance to heat</li></ul><p><strong>Note</strong></p><p>Using the corrigendum from Schymanski et al. (2017) in here so the definition of <a href="#PlantBiophysics.latent_heat-NTuple{8, Any}"><code>latent_heat</code></a> remains generic.</p><p>Not to be confused with <a href="#PlantBiophysics.Γ_star"><code>Γ_star</code></a> in FcVB model, which is the CO₂ compensation point.</p><p><strong>References</strong></p><p>Monteith, John L., et Mike H. Unsworth. 2013. « Chapter 13 - Steady-State Heat Balance: (i) Water Surfaces, Soil, and Vegetation ». In Principles of Environmental Physics (Fourth Edition), edited by John L. Monteith et Mike H. Unsworth, 217‑47. Boston: Academic Press.</p><p>Schymanski, Stanislaus J., et Dani Or. 2017. Leaf-Scale Experiments Reveal an Important Omission in the Penman–Monteith Equation ». Hydrology and Earth System Sciences 21 (2): 685‑706. https://doi.org/10.5194/hess-21-685-2017.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/climate/variables_computations.jl#LL105-L135">source</a></section></article><h2 id="Un-exported-functions"><a class="docs-heading-anchor" href="#Un-exported-functions">Un-exported functions</a><a id="Un-exported-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Un-exported-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.AbstractAtmosphere" href="#PlantBiophysics.AbstractAtmosphere"><code>PlantBiophysics.AbstractAtmosphere</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Abstract atmospheric conditions type. The suptypes of AbstractAtmosphere should describe the atmospheric conditions for one time-step only, see <em>e.g.</em> <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/climate/atmosphere.jl#LL1-L4">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.AbstractStatus" href="#PlantBiophysics.AbstractStatus"><code>PlantBiophysics.AbstractStatus</code></a> — <span class="docstring-category">Type</span></header><section><div><p>AbstractStatus is the abstract type used for all Status types that store the values of the variables during simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/component_models/Status.jl#LL1-L4">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.NRMSE-Tuple{Any, Any}" href="#PlantBiophysics.NRMSE-Tuple{Any, Any}"><code>PlantBiophysics.NRMSE</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">NRMSE(obs,sim)

Returns the Normalized Root Mean Squared Error between observations `obs` and simulations `sim`.
Normalization is performed using division by observations range (max-min).

Output: Float/Particles</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/evaluation/statistics.jl#LL13-L20">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.atmosphere_emissivity-Tuple{Any, Any, Any}" href="#PlantBiophysics.atmosphere_emissivity-Tuple{Any, Any, Any}"><code>PlantBiophysics.atmosphere_emissivity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">atmosphere_emissivity(Tₐ,eₐ)</code></pre><p>Emissivity of the atmoshpere at a given temperature and vapor pressure.</p><p><strong>Arguments</strong></p><ul><li><code>Tₐ</code> (°C): air temperature</li><li><code>eₐ</code> (kPa): air vapor pressure</li><li><code>K₀</code> (°C): absolute zero</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">Tₐ = 20.0
VPD = 1.5
atmosphere_emissivity(Tₐ, vapor_pressure(Tₐ,VPD))</code></pre><p><strong>References</strong></p><p>Leuning, R., F. M. Kelliher, DGG de Pury, et E.-D. SCHULZE. 1995. Leaf nitrogen, photosynthesis, conductance and transpiration: scaling from leaves to canopies ». Plant, Cell &amp; Environment 18 (10): 1183‑1200.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/energy/longwave_energy.jl#LL126-L150">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.check_status_wheather-Union{Tuple{T}, Tuple{T, Weather}} where T&lt;:TimeSteps" href="#PlantBiophysics.check_status_wheather-Union{Tuple{T}, Tuple{T, Weather}} where T&lt;:TimeSteps"><code>PlantBiophysics.check_status_wheather</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">check_status_meteo(component,weather)
check_status_meteo(status,weather)</code></pre><p>Checks if a component status and the weather have the same length, or if they can be recycled (length 1).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/checks/status_weather_corresp.jl#LL1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.compute_date!-Tuple{Any, Any, Any}" href="#PlantBiophysics.compute_date!-Tuple{Any, Any, Any}"><code>PlantBiophysics.compute_date!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_date!(df, date_format, hour_format)</code></pre><p>Compute the <code>date</code> column depending on several cases:</p><ul><li>If it is already in the DataFrame and is a <code>DateTime</code>, does nothing.</li><li>If it is a <code>String</code>, tries and parse it using a user-input <code>DateFormat</code></li><li>If it is a <code>Date</code>, return it as is, or try to make it a <code>DateTime</code> if there&#39;s a column named</li></ul><p><code>hour_start</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/io/read_weather.jl#LL97-L106">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.compute_duration!-Tuple{Any, Any}" href="#PlantBiophysics.compute_duration!-Tuple{Any, Any}"><code>PlantBiophysics.compute_duration!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_duration!(df, hour_format)</code></pre><p>Compute the <code>duration</code> column depending on several cases:</p><ul><li>If it is already in the DataFrame, does nothing.</li><li>If it is not, but there&#39;s a column named <code>hour_end</code> and another one either called <code>hour_start</code></li></ul><p>or <code>date</code>, compute the duration from the period between <code>hour_start</code> (or <code>date</code>) and <code>hour_end</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/io/read_weather.jl#LL143-L151">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.convert_status-Union{Tuple{T}, Tuple{Type{T}, Any}} where T" href="#PlantBiophysics.convert_status-Union{Tuple{T}, Tuple{Type{T}, Any}} where T"><code>PlantBiophysics.convert_status</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">convert_status(T, x)
convert_status(::Type{MutableNamedTuple}, x)</code></pre><p>Convert a type into another type.</p><p>The generic method simply uses <code>convert(T, x)</code>. This function is used to convert the status often given as a <code>NamedTuple</code> into the desired type, by default a <code>MutableNamedTuple</code>.</p><p>We need to override this method for any other type we would need for the status.</p><p>Note: we implement this function to avoid type piracy, <em>i.e.</em> implementing generic functions for types we don&#39;t own.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/model_initialisation.jl#LL177-L190">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.convert_vars-Tuple{Dict{DataType, DataType}, Any}" href="#PlantBiophysics.convert_vars-Tuple{Dict{DataType, DataType}, Any}"><code>PlantBiophysics.convert_vars</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">convert_vars(type_promotion::Dict{DataType,DataType}, ref_vars)
convert_vars(type_promotion::Nothing, ref_vars)</code></pre><p>Convert the status variables to the type specified in the type promotion dictionary.</p><p><strong>Examples</strong></p><p>If we want all the variables that are Reals to be Float32, we can use:</p><pre><code class="language-julia hljs">ref_vars = init_variables(energy_balance=Monteith(), photosynthesis=Fvcb(), stomatal_conductance=Medlyn(0.03, 12.0))
type_promotion = Dict(Real =&gt; Float32)

convert_vars(type_promotion, ref_vars)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/component_models/ModelList.jl#LL199-L215">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.diff_vars-Tuple{Any, Any}" href="#PlantBiophysics.diff_vars-Tuple{Any, Any}"><code>PlantBiophysics.diff_vars</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">diff_vars(x, y)</code></pre><p>Returns the names of variables that have different values in x and y.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/models_inputs_outputs.jl#LL148-L152">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.energy_balance!_" href="#PlantBiophysics.energy_balance!_"><code>PlantBiophysics.energy_balance!_</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">energy_balance!_(::Missing, models::ModelList, status, meteo::AbstractAtmosphere,constants = Constants())</code></pre><p>Method for when energy balance is missing (do nothing).</p><p><strong>Arguments</strong></p><ul><li><code>::Missing</code>: a Missing model.</li><li><code>models</code>: a <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a> struct with a missing energy model.</li><li><code>status</code>: the status of the model, usually the one from the models (<em>i.e.</em> models.status)</li><li><code>meteo</code>: meteorology structure, see <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a></li><li><code>constants = Constants()</code>: physical constants. See <a href="#PlantBiophysics.Constants"><code>Constants</code></a> for more details</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/energy/Missing.jl#LL1-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.energy_balance!_" href="#PlantBiophysics.energy_balance!_"><code>PlantBiophysics.energy_balance!_</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">energy_balance!_(::Monteith, models, status, meteo::AbstractAtmosphere, constants=Constants())</code></pre><p>Leaf energy balance according to Monteith and Unsworth (2013), and corrigendum from Schymanski et al. (2017). The computation is close to the one from the MAESPA model (Duursma et al., 2012, Vezy et al., 2018) here. The leaf temperature is computed iteratively to close the energy balance using the mass flux (~ Rn - λE).</p><p><strong>Arguments</strong></p><ul><li><code>::Monteith</code>: a Monteith model, usually from a model list (<em>i.e.</em> m.energy_balance)</li><li><code>models</code>: A <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a> struct holding the parameters for the model with</li></ul><p>initialisations for:     - <code>Rₛ</code> (W m-2): net shortwave radiation (PAR + NIR). Often computed from a light interception model     - <code>sky_fraction</code> (0-2): view factor between the object and the sky for both faces (see details).     - <code>d</code> (m): characteristic dimension, <em>e.g.</em> leaf width (see eq. 10.9 from Monteith and Unsworth, 2013).</p><ul><li><code>status</code>: the status of the model, usually the model list status (<em>i.e.</em> leaf.status)</li><li><code>meteo</code>: meteorology structure, see <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a></li><li><code>constants = Constants()</code>: physical constants. See <a href="#PlantBiophysics.Constants"><code>Constants</code></a> for more details</li></ul><p><strong>Details</strong></p><p>The sky_fraction in the variables is equal to 2 if all the leaf is viewing is sky (e.g. in a controlled chamber), 1 if the leaf is <em>e.g.</em> up on the canopy where the upper side of the leaf sees the sky, and the side bellow sees soil + other leaves that are all considered at the same temperature than the leaf, or less than 1 if it is partly shaded.</p><p><strong>Notes</strong></p><p>If you want the algorithm to print a message whenever it does not reach convergence, use the debugging mode by executing this in the REPL: <code>ENV[&quot;JULIA_DEBUG&quot;] = PlantBiophysics</code>.</p><p>More information <a href="https://docs.julialang.org/en/v1/stdlib/Logging/#Environment-variables">here</a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">meteo = Atmosphere(T = 22.0, Wind = 0.8333, P = 101.325, Rh = 0.4490995)

# Using a constant value for Gs:
leaf = ModelList(
    energy_balance = Monteith(),
    photosynthesis = Fvcb(),
    stomatal_conductance = ConstantGs(0.0, 0.0011),
    status = (Rₛ = 13.747, sky_fraction = 1.0, d = 0.03)
)

energy_balance!(leaf,meteo)
leaf.status.Rn
julia&gt; 12.902547446281233

# Using the model from Medlyn et al. (2011) for Gs:
leaf = ModelList(
    energy_balance = Monteith(),
    photosynthesis = Fvcb(),
    stomatal_conductance = Medlyn(0.03, 12.0),
    status = (Rₛ = 13.747, sky_fraction = 1.0, PPFD = 1500.0, d = 0.03)
)

energy_balance!(leaf,meteo)
leaf[:Rn]
leaf[:Rₗₗ]
leaf[:A]

DataFrame(leaf)</code></pre><p><strong>References</strong></p><p>Duursma, R. A., et B. E. Medlyn. 2012. « MAESPA: a model to study interactions between water limitation, environmental drivers and vegetation function at tree and stand levels, with an example application to [CO2] × drought interactions ». Geoscientific Model Development 5 (4): 919‑40. https://doi.org/10.5194/gmd-5-919-2012.</p><p>Monteith, John L., et Mike H. Unsworth. 2013. « Chapter 13 - Steady-State Heat Balance: (i) Water Surfaces, Soil, and Vegetation ». In Principles of Environmental Physics (Fourth Edition), edited by John L. Monteith et Mike H. Unsworth, 217‑47. Boston: Academic Press.</p><p>Schymanski, Stanislaus J., et Dani Or. 2017. « Leaf-Scale Experiments Reveal an Important Omission in the Penman–Monteith Equation ». Hydrology and Earth System Sciences 21 (2): 685‑706. https://doi.org/10.5194/hess-21-685-2017.</p><p>Vezy, Rémi, Mathias Christina, Olivier Roupsard, Yann Nouvellon, Remko Duursma, Belinda Medlyn, Maxime Soma, et al. 2018. « Measuring and modelling energy partitioning in canopies of varying complexity using MAESPA model ». Agricultural and Forest Meteorology 253‑254 (printemps): 203‑17. https://doi.org/10.1016/j.agrformet.2018.02.005.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/energy/Monteith.jl#LL48-L134">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.energy_balance!_" href="#PlantBiophysics.energy_balance!_"><code>PlantBiophysics.energy_balance!_</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">light_interception!_(::Ignore, models::ModelList, status, meteo::AbstractAtmosphere,constants = Constants())</code></pre><p>Method for when light interception should be explicitely ignored (do nothing).</p><p><strong>Arguments</strong></p><ul><li><code>::Ignore</code>: an <code>Ignore</code> model.</li><li><code>models</code>: a <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a> struct with a missing energy model.</li><li><code>status</code>: the status of the model, usually the one from the models (<em>i.e.</em> models.status)</li><li><code>meteo</code>: meteorology structure, see <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a></li><li><code>constants = Constants()</code>: physical constants. See <a href="#PlantBiophysics.Constants"><code>Constants</code></a> for more details</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/light/Ignore.jl#LL8-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.f_ms_to_mol-NTuple{4, Any}" href="#PlantBiophysics.f_ms_to_mol-NTuple{4, Any}"><code>PlantBiophysics.f_ms_to_mol</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Conversion factor between conductance in <span>$m\ s^{-1}$</span> to <span>$mol\ m^{-2}\ s^{-1}$</span>.</p><p><strong>Arguments</strong></p><ul><li><code>T</code> (°C): air temperature</li><li><code>P</code> (kPa): air pressure</li><li><code>R</code> (<span>$J\ mol^{-1}\ K^{-1}$</span>): universal gas constant.</li><li><code>K₀</code> (°C): absolute zero</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/conversions.jl#LL55-L64">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.get_attr_i-Union{Tuple{T}, Tuple{Any, Any, T}} where T&lt;:Nothing" href="#PlantBiophysics.get_attr_i-Union{Tuple{T}, Tuple{Any, Any, T}} where T&lt;:Nothing"><code>PlantBiophysics.get_attr_i</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_attr_i(node, attr, i&lt;:Nothing)
get_attr_i(node, attr, i)</code></pre><p>Get node attribute at ith value or only value if <code>i&lt;:Nothing</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/mtg/init_mtg_models.jl#LL151-L156">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.homogeneous_type_steps" href="#PlantBiophysics.homogeneous_type_steps"><code>PlantBiophysics.homogeneous_type_steps</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">homogeneous_type_steps(ref_vars, vars, datatype=MutableNamedTuple)</code></pre><p>Return a <a href="#PlantBiophysics.Status"><code>Status</code></a> or <a href="#PlantBiophysics.TimeSteps"><code>TimeSteps</code></a> based on the length of the variables in vars. <code>ref_vars</code> is a struct with the default values of all the variables needed by the models. <code>datatype</code> is the type used to hold the status inside the Status.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/component_models/ModelList.jl#LL127-L133">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.light_interception!_-Tuple{Beer, Any, Any, Any, Any}" href="#PlantBiophysics.light_interception!_-Tuple{Beer, Any, Any, Any, Any}"><code>PlantBiophysics.light_interception!_</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">light_interception!_(object, meteo, constants = Constants())</code></pre><p>Computes the light interception of an object using the Beer-Lambert law.</p><p><strong>Arguments</strong></p><ul><li><code>::Beer</code>: a Beer model, from the model list (<em>i.e.</em> m.light_interception)</li><li><code>models</code>: A <a href="#PlantBiophysics.ModelList"><code>ModelList</code></a> struct holding the parameters for the model with</li></ul><p>initialisations for <code>LAI</code> (m² m⁻²): the leaf area index.</p><ul><li><code>status</code>: the status of the model, usually the model list status (<em>i.e.</em> m.status)</li><li><code>meteo</code>: meteorology structure, see <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a></li><li><code>constants = Constants()</code>: physical constants. See <a href="#PlantBiophysics.Constants"><code>Constants</code></a> for more details</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">m = ModelList(light_interception=Beer(0.5), status=(LAI=2.0,))

meteo = Atmosphere(T=20.0, Wind=1.0, P=101.3, Rh=0.65, Ri_PAR_f=300.0)

light_interception!(m, meteo)

m[:aPAR]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/light/Beer.jl#LL16-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.locf!-Tuple{Any}" href="#PlantBiophysics.locf!-Tuple{Any}"><code>PlantBiophysics.locf!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">locf!(var)</code></pre><p>Last observation carried forward (LOCF) iterates forwards <code>var</code> and fills missing data with the last existing observation.</p><p>This function is heavily inspired (<em>i.e.</em> copied) by the function <code>locf</code> in the package <code>Impute</code> (MIT licence). See <a href="https://github.com/invenia/Impute.jl/blob/9230661ae5f3dc828fea58b32970c874574cb654/src/imputors/locf.jl#LL44-L64">here</a> for more details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/io/read_walz.jl#LL41-L51">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.max_root-Tuple{Any, Any, Any}" href="#PlantBiophysics.max_root-Tuple{Any, Any, Any}"><code>PlantBiophysics.max_root</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Maximum value between two roots of a quadratic equation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/FvCB.jl#LL397-L399">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.merge_status-Tuple{Any, Any}" href="#PlantBiophysics.merge_status-Tuple{Any, Any}"><code>PlantBiophysics.merge_status</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">merge_status(::Type{MutableNamedTuple}, x, y)
merge_status(::Type{NamedTuple}, x, y)</code></pre><p>Merge two status.</p><p>The generic version simply uses <code>merge</code>. We use <code>merge_status</code> so we can implement merge for types we don&#39;t own, avoiding type piracy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/model_initialisation.jl#LL203-L211">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.negative_root-Tuple{Any, Any, Any}" href="#PlantBiophysics.negative_root-Tuple{Any, Any, Any}"><code>PlantBiophysics.negative_root</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Negative root of a quadratic equation, but returns 0 if Δ is negative. Careful, this is not right mathematically, but biologically OK because used in the computation of Cᵢ (gives A = 0 in this case).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/FvCB.jl#LL418-L422">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.positive_root-Tuple{Any, Any, Any}" href="#PlantBiophysics.positive_root-Tuple{Any, Any, Any}"><code>PlantBiophysics.positive_root</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Positive root of a quadratic equation, but returns 0 if Δ is negative. Careful, this is not right mathematically, but biologically OK because used in the computation of Cᵢ (gives A = 0 in this case).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/photosynthesis/FvCB.jl#LL408-L412">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.pre_allocate_attr!-Tuple{Any, Any}" href="#PlantBiophysics.pre_allocate_attr!-Tuple{Any, Any}"><code>PlantBiophysics.pre_allocate_attr!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">pre_allocate_attr!(node, nsteps; attr_name = :models)</code></pre><p>Pre-allocate the node attributes based on the status of a component model and a given number of simulation steps.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/mtg/mtg_helpers.jl#LL86-L91">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.pull_status_step!-Tuple{Any, Any}" href="#PlantBiophysics.pull_status_step!-Tuple{Any, Any}"><code>PlantBiophysics.pull_status_step!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">pull_status_step!(node, step; attr_name = :models)</code></pre><p>Copy the status of a node&#39;s ModelList (<em>i.e.</em> the outputs of the simulations) into the pre-allocated MTG attributes, i.e. one value per step.</p><p>See <a href="#PlantBiophysics.pre_allocate_attr!-Tuple{Any, Any}"><code>pre_allocate_attr!</code></a> for the pre-allocation step.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/mtg/mtg_helpers.jl#LL69-L76">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.stomatal_conductance!_-Tuple{ConstantGs, Any, Any, Any}" href="#PlantBiophysics.stomatal_conductance!_-Tuple{ConstantGs, Any, Any, Any}"><code>PlantBiophysics.stomatal_conductance!_</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Constant stomatal conductance for CO₂ (mol m-2 s-1).</p><p><strong>Note</strong></p><p><code>meteo</code> or <code>gs_mod</code> are just declared here for compatibility with the call from photosynthesis (need a constant way of calling the functions).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/conductances/stomatal/constantGs.jl#LL45-L52">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.update_mtg_models!-Tuple{MultiScaleTreeGraph.Node, Any, Any, Symbol}" href="#PlantBiophysics.update_mtg_models!-Tuple{MultiScaleTreeGraph.Node, Any, Any, Symbol}"><code>PlantBiophysics.update_mtg_models!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">update_mtg_models!(mtg::MultiScaleTreeGraph.Node, i, attr_name::Symbol)</code></pre><p>Update the mtg models initialisations by using the ith time-step. The mtg is considered fully initialized already once, so <a href="#PlantBiophysics.init_mtg_models!"><code>init_mtg_models!</code></a> must be called before <code>update_mtg_models!</code>.</p><p>The values are updated only for node attributes in <code>to_init</code>. Those attributes must have several time-steps, <em>i.e.</em> indexable by 1:n time-steps.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/mtg/init_mtg_models.jl#LL165-L174">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.vars_not_init_-Union{Tuple{T}, Tuple{T, Any}} where T&lt;:Status" href="#PlantBiophysics.vars_not_init_-Union{Tuple{T}, Tuple{T, Any}} where T&lt;:Status"><code>PlantBiophysics.vars_not_init_</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">vars_not_init_(st&lt;:Status, var_names)</code></pre><p>Get which variable is not properly initialized in the status struct.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/model_initialisation.jl#LL263-L267">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.vpd-Tuple{Any, Any}" href="#PlantBiophysics.vpd-Tuple{Any, Any}"><code>PlantBiophysics.vpd</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">vpd(VPD,eₛ)</code></pre><p>Compute vapor pressure deficit (kPa) from the air relative humidity (0-1) and temperature (°C).</p><p>The computation simply uses vpd = eₛ - e.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">vpd(0.4,25.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/conversions.jl#LL103-L115">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.λE_to_E" href="#PlantBiophysics.λE_to_E"><code>PlantBiophysics.λE_to_E</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">λE_to_E(λE, λ, Mₕ₂ₒ=Constants().Mₕ₂ₒ)
E_to_λE(E, λ, Mₕ₂ₒ=Constants().Mₕ₂ₒ)</code></pre><p>Conversion from latent heat (W m-2) to evaporation (mol[H₂O] m-2 s-1) or the opposite (<code>E_to_λE</code>).</p><p><strong>Arguments</strong></p><ul><li><code>λE</code>: latent heat flux (W m-2)</li><li><code>E</code>: water evaporation (mol[H₂O] m-2 s-1)</li><li><code>λ</code> (J kg-1): latent heat of vaporization</li><li><code>Mₕ₂ₒ = 18.0e-3</code> (kg mol-1): Molar mass for water.</li></ul><p><strong>Note</strong></p><p><code>λ</code> can be computed using:</p><pre><code class="nohighlight hljs">λ = latent_heat_vaporization(T, constants.λ₀)</code></pre><p>It is also directly available from the <a href="#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a> structure, and by extention in <a href="#PlantBiophysics.Weather"><code>Weather</code></a>.</p><p>To convert E from mol[H₂O] m-2 s-1 to mm s-1 you can simply do:</p><pre><code class="nohighlight hljs">E_mms = E_mol / constants.Mₕ₂ₒ</code></pre><p>mm[H₂O] s-1 is equivalent to kg[H₂O] m-2 s-1, wich is equivalent to l[H₂O] m-2 s-1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/conversions.jl#LL164-L192">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantBiophysics.@gen_process_methods-Tuple{Any}" href="#PlantBiophysics.@gen_process_methods-Tuple{Any}"><code>PlantBiophysics.@gen_process_methods</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@gen_process_methods(process::String)</code></pre><p>This macro generate all standard methods for processes:</p><ul><li>The base method that calls the actual algorithms implemented using the process name   suffixed by <code>_</code>, <em>e.g.</em> <code>photosynthesis_</code>.</li><li>The method applying the computation over several objects (<em>e.g.</em> all leaves of a plant)</li></ul><p>in an Array</p><ul><li>The same method over a Dict(-alike) of objects</li><li>The method that applies the computation over several meteo time steps (called Weather) and</li></ul><p>possibly several objects</p><ul><li>A method for calling the process without any meteo (<em>e.g.</em> for fitting)</li><li>A method to apply the above over MTG nodes</li><li>A non-mutating version of the function (make a copy before the call, and return the copy)</li></ul><p>The macro returns two functions: the mutating one and the non-mutating one. For example <code>energy_balance()</code> and <code>energy_balance!()</code> for the energy balance. And of course the function that implements the computation is assumed to be <code>energy_balance!_()</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">@gen_process_methods &quot;dummy_process&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/VEZY/PlantBiophysics.jl/blob/2a032e3dbc244adad2fa66384869f22d9a58d944/src/processes/process_methods_generation.jl#LL1-L26">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../extending/implement_a_process/">« Implement a process</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Sunday 18 September 2022 08:05">Sunday 18 September 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
