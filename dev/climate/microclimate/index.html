<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Micro-climate · PlantBiophysics.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://VEZY.github.io/PlantBiophysics.jl/climate/microclimate/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="PlantBiophysics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PlantBiophysics.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../getting_started/get_started/">TL;DR</a></li><li><a class="tocitem" href="../../getting_started/first_fit/">Parameter fitting</a></li></ul></li><li><a class="tocitem" href="../../concepts/package_design/">Design</a></li><li><a class="tocitem" href="../../variables/">Variables</a></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../../models/photosynthesis/">Photosynthesis</a></li><li><a class="tocitem" href="../../models/gs/">Stomatal conductance</a></li><li><a class="tocitem" href="../../models/energy_balance/">Energy balance</a></li><li><a class="tocitem" href="../../models/light/">Light interception</a></li></ul></li><li class="is-active"><a class="tocitem" href>Micro-climate</a><ul class="internal"><li><a class="tocitem" href="#Helper-functions"><span>Helper functions</span></a></li></ul></li><li><a class="tocitem" href="../../fitting/parameter_fitting/">Tutorial: Parameter fitting</a></li><li><span class="tocitem">Tutorial: Simulation</span><ul><li><a class="tocitem" href="../../simulation/first_simulation/">Simple Simulation</a></li><li><a class="tocitem" href="../../simulation/several_simulation/">Several time steps</a></li><li><a class="tocitem" href="../../simulation/several_objects_simulation/">Several objects</a></li><li><a class="tocitem" href="../../simulation/mtg_simulation/">Whole-plant simulation</a></li></ul></li><li><a class="tocitem" href="../../simulation/uncertainty_propagation/">Tutorial: Uncertainty propagation</a></li><li><span class="tocitem">Extending PlantBiophysics</span><ul><li><a class="tocitem" href="../../extending/implement_a_model/">Implement a model</a></li><li><a class="tocitem" href="../../extending/implement_a_process/">Implement a process</a></li></ul></li><li><a class="tocitem" href="../../functions/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Micro-climate</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Micro-climate</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/VEZY/PlantBiophysics.jl/blob/master/docs/src/climate/microclimate.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="microclimate_page"><a class="docs-heading-anchor" href="#microclimate_page">Micro-climate</a><a id="microclimate_page-1"></a><a class="docs-heading-anchor-permalink" href="#microclimate_page" title="Permalink"></a></h1><p>The micro-climatic/meteorological conditions measured close to the object or component are given as the second argument of the simulation functions shown earlier.</p><p>PlantBiophysics provides its own data structure to declare those conditions, and to pre-compute other required variables. This data structure is a type called <a href="../../functions/#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a>.</p><p>The mandatory variables to provide are: <code>T</code> (air temperature in °C), <code>Rh</code> (relative humidity, 0-1), <code>Wind</code> (the wind speed in m s-1) and <code>P</code> (the air pressure in kPa).</p><p>We can declare such conditions using <a href="../../functions/#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a> such as:</p><pre><code class="language-julia hljs">meteo = Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Atmosphere{Float64, Dates.DateTime, Float64}(Dates.DateTime(&quot;2022-08-19T16:43:25.568&quot;), 1.0, 20.0, 1.0, 101.3, 0.65, 400.0, 1.5255470730405223, 2.3469954969854188, 0.8214484239448965, 1.2037851579511918, 2.4537e6, 0.06723680111943287, 0.5848056484857892, 0.14573378083416522, 9999.9, 9999.9, 9999.9, 9999.9, 9999.9, 9999.9)</code></pre><p>The <a href="../../functions/#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a> also computes other variables based on the provided conditions, such as the vapor pressure deficit (VPD) or the air density (ρ). You can also provide those variables as inputs if necessary. For example if you need another way of computing the VPD, you can provide it as follows:</p><pre><code class="language-julia hljs">Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65, VPD = 0.82)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Atmosphere{Float64, Dates.DateTime, Float64}(Dates.DateTime(&quot;2022-08-19T16:43:26.317&quot;), 1.0, 20.0, 1.0, 101.3, 0.65, 400.0, 1.5255470730405223, 2.3469954969854188, 0.82, 1.2037851579511918, 2.4537e6, 0.06723680111943287, 0.5848056484857892, 0.14573378083416522, 9999.9, 9999.9, 9999.9, 9999.9, 9999.9, 9999.9)</code></pre><p>To access the values of the variables after instantiation, we can use the dot syntax. For example if we need the vapor pressure at saturation, we would do as follows:</p><pre><code class="language-julia hljs">meteo.eₛ</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2.3469954969854188</code></pre><p>See the documentation of the function if you need more information about the variables: <a href="../../functions/#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a>.</p><p>If you want to simulate several time-steps with varying conditions, you can do so by using <a href="../../functions/#PlantBiophysics.Weather"><code>Weather</code></a> instead of <a href="../../functions/#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a>.</p><p><a href="../../functions/#PlantBiophysics.Weather"><code>Weather</code></a> is just an array of <a href="../../functions/#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a> along with some optional metadata. For example for three time-steps, we can declare it like so:</p><pre><code class="language-julia hljs">w = Weather(
    [
        Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65),
        Atmosphere(T = 23.0, Wind = 1.5, P = 101.3, Rh = 0.60),
        Atmosphere(T = 25.0, Wind = 3.0, P = 101.3, Rh = 0.55)
    ],
    (
        site = &quot;Montpellier&quot;,
        other_info = &quot;another crucial metadata&quot;
    )
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Weather data.
Metadata: `(site = &quot;Montpellier&quot;, other_info = &quot;another crucial metadata&quot;)`.
Data:
3×21 DataFrame
 Row │ date                     duration  T        Wind     P        Rh        ⋯
     │ DateTime                 Float64   Float64  Float64  Float64  Float64   ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ 2022-08-19T16:43:26.410       1.0     20.0      1.0    101.3     0.65   ⋯
   2 │ 2022-08-19T16:43:26.410       1.0     23.0      1.5    101.3     0.6
   3 │ 2022-08-19T16:43:26.410       1.0     25.0      3.0    101.3     0.55
                                                              15 columns omitted</code></pre><p>As you see the first argument is an array of <a href="../../functions/#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a>, and the second is a named tuple of optional metadata such as the site or whatever you think is important.</p><p>A <a href="../../functions/#PlantBiophysics.Weather"><code>Weather</code></a> can also be declared from a DataFrame, provided each row is an observation from a time-step, and each column is a variable needed for <a href="../../functions/#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a> (see the help of <a href="../../functions/#PlantBiophysics.Atmosphere"><code>Atmosphere</code></a> for more details on the possible variables and their units).</p><p>Here&#39;s an example of using a DataFrame as input:</p><pre><code class="language-julia hljs">using CSV, DataFrames
file = joinpath(dirname(dirname(pathof(PlantBiophysics))),&quot;test&quot;,&quot;inputs&quot;,&quot;meteo.csv&quot;)
df = CSV.read(file, DataFrame; header=5, datarow = 6)
# Select and rename the variables:
select!(df, :date, :temperature =&gt; :T, :relativeHumidity =&gt; (x -&gt; x ./ 100 ) =&gt; :Rh, :wind =&gt; :Wind, :atmosphereCO2_ppm =&gt; :Cₐ)
df[!,:duration] .= 1800 # Add the time-step duration, 30min

# Make the weather, and add some metadata:
Weather(df, (site = &quot;Aquiares&quot;, file = file))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Weather data.
Metadata: `(site = &quot;Aquiares&quot;, file = &quot;/home/runner/work/PlantBiophysics.jl/PlantBiophysics.jl/test/inputs/meteo.csv&quot;)`.
Data:
3×21 DataFrame
 Row │ date        duration  T        Wind     P        Rh       Cₐ       e    ⋯
     │ String15    Int64     Float64  Float64  Float64  Float64  Float64  Floa ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ 2016/06/12      1800     25.0      1.0  101.325     0.6     380.0  1.90 ⋯
   2 │ 2016/06/12      1800     26.0      1.5  101.325     0.62    380.0  2.09
   3 │ 2016/06/12      1800     25.3      1.5  101.325     0.58    380.0  1.87
                                                              14 columns omitted</code></pre><p>One can also directly import the Weather from an <a href="https://archimed-platform.github.io/archimed-phys-user-doc/">Archimed-ϕ</a>-formatted meteorology file (a csv file optionally enriched with some metadata). In this case, the user can rename and transform the variables from the file to match the names and units needed in PlantBiophysics using a <a href="https://dataframes.juliadata.org/stable/"><code>DataFrame.jl</code></a>-alike syntax:</p><pre><code class="language-julia hljs">using Dates

meteo = read_weather(
    joinpath(dirname(dirname(pathof(PlantBiophysics))),&quot;test&quot;,&quot;inputs&quot;,&quot;meteo.csv&quot;),
    :temperature =&gt; :T,
    :relativeHumidity =&gt; (x -&gt; x ./100) =&gt; :Rh,
    :wind =&gt; :Wind,
    :atmosphereCO2_ppm =&gt; :Cₐ,
    date_format = DateFormat(&quot;yyyy/mm/dd&quot;)
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Weather data.
Metadata: `(name = &quot;Aquiares&quot;, latitude = 15.0, altitude = 100.0, use = [:clearness], file = &quot;/home/runner/work/PlantBiophysics.jl/PlantBiophysics.jl/test/inputs/meteo.csv&quot;)`.
Data:
3×21 DataFrame
 Row │ date                 duration    T        Wind     P        Rh       Cₐ ⋯
     │ DateTime             Minute      Float64  Float64  Float64  Float64  Fl ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ 2016-06-12T12:00:00  30 minutes     25.0      1.0  101.325     0.6      ⋯
   2 │ 2016-06-12T12:30:00  30 minutes     26.0      1.5  101.325     0.62
   3 │ 2016-06-12T13:00:00  30 minutes     25.3      1.5  101.325     0.58
                                                              15 columns omitted</code></pre><h2 id="Helper-functions"><a class="docs-heading-anchor" href="#Helper-functions">Helper functions</a><a id="Helper-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Helper-functions" title="Permalink"></a></h2><p>PlantBiophysics provides some helper functions to compute some micro-climate related variables.</p><p>Here is a complete list of these functions:</p><ul><li><a href="../../functions/#PlantBiophysics.vapor_pressure-Tuple{Any, Any}"><code>vapor_pressure</code></a> computes e (kPa), the vapor pressure from the air temperature and the relative humidity</li><li><a href="../../functions/#PlantBiophysics.e_sat-Tuple{Any}"><code>e_sat</code></a> computes eₛ (kPa), the saturated vapor pressure from the air temperature</li><li><a href="../../functions/#PlantBiophysics.air_density-NTuple{4, Any}"><code>air_density</code></a> computes ρ (kg m-3), the air density from the air temperature, the pressure, and some constants</li><li><a href="../../functions/#PlantBiophysics.latent_heat_vaporization-Tuple{Any, Any}"><code>latent_heat_vaporization</code></a> computes λ (J kg-1), the latent heat of vaporization from the air temperature and a constant</li><li><a href="../../functions/#PlantBiophysics.psychrometer_constant-NTuple{4, Any}"><code>psychrometer_constant</code></a> computes γ (kPa K−1), the psychrometer &quot;constant&quot; from the air pressure, the latent heat of vaporization and some constants</li><li><a href="climate/@ref"><code>atmosphere_emissivity(T,e,constants.K₀)</code></a> computes ε (0-1), the atmosphere emissivity from the air temperature, the vapor pressure and a constant</li><li><a href="../../functions/#PlantBiophysics.e_sat_slope-Tuple{Any}"><code>e_sat_slope</code></a> computes Δ (0-1), the slope of the saturation vapor pressure at air temperature, from the air temperature</li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>All constants are found in <a href="../../functions/#PlantBiophysics.Constants"><code>Constants</code></a></p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../models/light/">« Light interception</a><a class="docs-footer-nextpage" href="../../fitting/parameter_fitting/">Tutorial: Parameter fitting »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.14 on <span class="colophon-date" title="Friday 19 August 2022 16:49">Friday 19 August 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
