<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Energy balance · PlantBiophysics.jl</title><meta name="title" content="Energy balance · PlantBiophysics.jl"/><meta property="og:title" content="Energy balance · PlantBiophysics.jl"/><meta property="twitter:title" content="Energy balance · PlantBiophysics.jl"/><meta name="description" content="Documentation for PlantBiophysics.jl."/><meta property="og:description" content="Documentation for PlantBiophysics.jl."/><meta property="twitter:description" content="Documentation for PlantBiophysics.jl."/><meta property="og:url" content="https://VEZY.github.io/PlantBiophysics.jl/models/energy_balance/"/><meta property="twitter:url" content="https://VEZY.github.io/PlantBiophysics.jl/models/energy_balance/"/><link rel="canonical" href="https://VEZY.github.io/PlantBiophysics.jl/models/energy_balance/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="PlantBiophysics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PlantBiophysics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../getting_started/get_started/">TL;DR</a></li><li><a class="tocitem" href="../../getting_started/first_fit/">Parameter fitting</a></li></ul></li><li><a class="tocitem" href="../../concepts/package_design/">Design</a></li><li><a class="tocitem" href="../../variables/">Variables</a></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../photosynthesis/">Photosynthesis</a></li><li><a class="tocitem" href="../gs/">Stomatal conductance</a></li><li class="is-active"><a class="tocitem" href>Energy balance</a><ul class="internal"><li><a class="tocitem" href="#Models-overview"><span>Models overview</span></a></li><li><a class="tocitem" href="#Monteith"><span>Monteith</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../light/">Light interception</a></li></ul></li><li><a class="tocitem" href="../../climate/microclimate/">Micro-climate</a></li><li><a class="tocitem" href="../../fitting/parameter_fitting/">Tutorial: Parameter fitting</a></li><li><span class="tocitem">Tutorial: Simulation</span><ul><li><a class="tocitem" href="../../simulation/first_simulation/">Simple Simulation</a></li><li><a class="tocitem" href="../../simulation/several_simulation/">Several time steps</a></li><li><a class="tocitem" href="../../simulation/several_objects_simulation/">Several objects</a></li><li><a class="tocitem" href="../../simulation/mtg_simulation/">Whole-plant simulation</a></li></ul></li><li><a class="tocitem" href="../../simulation/uncertainty_propagation/">Tutorial: Uncertainty propagation</a></li><li><span class="tocitem">Extending PlantBiophysics</span><ul><li><a class="tocitem" href="../../extending/implement_a_model/">Implement a model</a></li><li><a class="tocitem" href="../../extending/implement_a_process/">Implement a process</a></li></ul></li><li><a class="tocitem" href="../../functions/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Models</a></li><li class="is-active"><a href>Energy balance</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Energy balance</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/VEZY/PlantBiophysics.jl/blob/master/docs/src/models/energy_balance.md#L" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="nrj_page"><a class="docs-heading-anchor" href="#nrj_page">Energy balance</a><a id="nrj_page-1"></a><a class="docs-heading-anchor-permalink" href="#nrj_page" title="Permalink"></a></h1><p>The energy balance is the process of computing the balance between influx and outflux of energy in all its form: latent and sensible heat, thermal radiation...</p><h2 id="Models-overview"><a class="docs-heading-anchor" href="#Models-overview">Models overview</a><a id="Models-overview-1"></a><a class="docs-heading-anchor-permalink" href="#Models-overview" title="Permalink"></a></h2><p>Only one model is available to-date:</p><ul><li><a href="#Monteith"><code>Monteith</code></a>: an implementation of the Monteith et al. (2013) model</li></ul><p>You can choose which model to use by passing a model list with an energy balance model set to one of the <code>structs</code> above:</p><pre><code class="language-julia hljs">using PlantBiophysics, PlantSimEngine

meteo = Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)

leaf = ModelList(
    Monteith(),
    Fvcb(),
    Medlyn(0.03, 12.0),
    status = (Ra_SW_f = 13.747, sky_fraction = 1.0, aPPFD = 1500.0, d = 0.03)
)

run!(leaf,meteo)
leaf[:Rn]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{Float64}:
 21.40940340906749</code></pre><h2 id="Monteith"><a class="docs-heading-anchor" href="#Monteith">Monteith</a><a id="Monteith-1"></a><a class="docs-heading-anchor-permalink" href="#Monteith" title="Permalink"></a></h2><p>Leaf energy balance according to Monteith and Unsworth (2013), and corrigendum from Schymanski et al. (2017). The computation is close to the one from the MAESPA model (Duursma et al., 2012, Vezy et al., 2018) here. The leaf temperature is computed iteratively to close the energy balance using the mass flux (~ Rn - λE).</p><h3 id="param_monteith"><a class="docs-heading-anchor" href="#param_monteith">Parameters</a><a id="param_monteith-1"></a><a class="docs-heading-anchor-permalink" href="#param_monteith" title="Permalink"></a></h3><p>The Monteith model has the following set of parameters:</p><ul><li><code>aₛₕ = 2</code>: number of faces of the object that exchange sensible heat fluxes</li><li><code>aₛᵥ = 1</code>: number of faces of the object that exchange latent heat fluxes (hypostomatous =&gt; 1)</li><li><code>ε = 0.955</code>: emissivity of the object</li><li><code>maxiter = 10</code>: maximal number of iterations allowed to close the energy balance</li><li><code>ΔT = 0.01</code> (°C): maximum difference in object temperature between two iterations to consider convergence</li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Objects are surfaces, not volumes, so the maximum number of faces is two.</p></div></div><h3 id="inputs_monteith"><a class="docs-heading-anchor" href="#inputs_monteith">Input variables</a><a id="inputs_monteith-1"></a><a class="docs-heading-anchor-permalink" href="#inputs_monteith" title="Permalink"></a></h3><p>The <a href="#Monteith"><code>Monteith</code></a> model needs three input variables:</p><pre><code class="language-julia hljs">inputs(Monteith())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(:Ra_SW_f, :sky_fraction, :d)</code></pre><p><code>Ra_SW_f</code> (W m-2) is the net shortwave radiation (PAR + NIR), most often computed from a light interception model. <code>sky_fraction</code> (0-2) is the fraction of sky the object is viewing compared to everything else. It is given for the 360° viewing angle, <em>i.e.</em> for both faces. <code>d</code> (m) is the characteristic dimension, <em>e.g.</em> the leaf width (see eq. 10.9 from Monteith and Unsworth, 2013).</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><code>sky_fraction</code> is equal to <code>2</code> if the leaf is viewing sky only (<em>e.g.</em> in a controlled chamber with lights everywhere), <code>1</code> if the leaf is <em>e.g.</em> up on the canopy where the upper side of the leaf sees sky, and the bottom side sees soil and other components, or less than 1 if it is partly shaded. <code>sky_fraction</code> is used to compute the thermal radiation exchanges. Everything except the sky is considered at the same temperature than the object. This simplification makes the computations very fast, but less precise, especially when another object has a very different temperature.</p></div></div><h3 id="outputs_monteith"><a class="docs-heading-anchor" href="#outputs_monteith">Output variables</a><a id="outputs_monteith-1"></a><a class="docs-heading-anchor-permalink" href="#outputs_monteith" title="Permalink"></a></h3><p>The <a href="#Monteith"><code>Monteith</code></a> model computes a lot of variables, mainly because it is also coupled to a photosynthesis model, itself potentially coupled to a stomatal conductance model:</p><pre><code class="language-julia hljs">outputs(Monteith())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(:Tₗ, :Rn, :Ra_LW_f, :H, :λE, :Cₛ, :Cᵢ, :A, :Gₛ, :Gbₕ, :Dₗ, :Gbc, :iter)</code></pre><p><code>Tₗ</code> (°C) is the component temperature, <code>Rn</code> (<span>$W \cdot m^{-2}$</span>) is the net radiation (PAR + NIR + TIR), <code>Ra_LW_f</code> (<span>$W \cdot m^{-2}$</span>) is the longwave radiation (TIR), <code>H</code> (<span>$W \cdot m^{-2}$</span>) is the sensible heat flux, <code>λE</code> (<span>$W \cdot m^{-2}$</span>) is the latent heat flux, <code>Cₛ</code> (ppm) is the air CO₂ concentration at the leaf surface, <code>Cᵢ</code> (ppm) is the intercellular CO₂ concentration, <code>A</code> (<span>$μmol \cdot m^{-2} \cdot s^{-1}$</span>) is the CO₂ assimilation rate, <code>Gₛ</code> (<span>$mol_{CO_2} \cdot m^{-2} \cdot s^{-1}$</span>) the stomatal conductance, <code>Gbₕ</code> (<span>$m \cdot s^{-1}$</span>) the boundary layer conductance to heat, <code>Dₗ</code> (kPa) the difference between the vapour pressure at the leaf surface and the saturated air vapour pressure, <code>Gbc</code> (<span>$mol_{CO_2} \cdot m^{-2} \cdot s^{-1}$</span>) the boundary layer conductance to CO₂, and <code>iter</code> the number of iterations to reach convergence.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The output variables depends on the models we are using for photosynthesis and stomatal conductance.</p></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Convergence is reached whenever the difference in the component temperature (<code>Tₗ</code>, °C) between two time-steps is lower than <code>ΔT</code>.</p></div></div><h3 id="exemple_monteith"><a class="docs-heading-anchor" href="#exemple_monteith">Example</a><a id="exemple_monteith-1"></a><a class="docs-heading-anchor-permalink" href="#exemple_monteith" title="Permalink"></a></h3><p>Here is an example usage:</p><pre><code class="language-julia hljs">meteo = Atmosphere(T = 22.0, Wind = 0.8333, P = 101.325, Rh = 0.4490995)

leaf = ModelList(
    Monteith(),
    Fvcb(),
    Medlyn(0.03, 12.0),
    status = (Ra_SW_f = 13.747, sky_fraction = 1.0, aPPFD = 1500.0, d = 0.03)
)

leaf</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PlantSimEngine.DependencyGraph{Dict{Symbol, PlantSimEngine.SoftDependencyNode}, Any}(Dict{Symbol, PlantSimEngine.SoftDependencyNode}(:energy_balance =&gt; Monteith{Float64, Int64}
), Dict{Symbol, Any}())TimeStepTable{Status{(:Ra_SW_f, :sky_fracti...}(1 x 17):
<span class="sgr31">╭─────┬─────────┬──────────────┬─────────┬─────────┬─────────┬─────────┬────────
│<span class="sgr1"> Row │ Ra_SW_f │ sky_fraction │       d │      Tₗ │      Rn │ Ra_LW_f │       ⋯
│     │</span></span><span class="sgr1"><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90">      Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float ⋯
</span><span class="sgr31">├─────┼─────────┼──────────────┼─────────┼─────────┼─────────┼─────────┼────────
│   1 │  13.747 │          1.0 │    0.03 │    -Inf │    -Inf │    -Inf │    -I ⋯
╰─────┴─────────┴──────────────┴─────────┴─────────┴─────────┴─────────┴────────
</span><span class="sgr36">                                                              11 columns omitted
</span></span></code></pre><p>The Monteith model implementation can be tested on the data provided by Schymanski et al. (2017). Here is a figure comparing our implementation and the data:</p><p><img src="../schymanski_et_al_2017_6a.svg" alt/></p><p><em>Figure 1. Energy flux measured on an artificial leaf (points) or simulated from its digital twin (lines). Data from Schymanski et al. (2017) figure 6a. The code to reproduce this figure is available in <a href="../schymanski.jl">this file</a>.</em></p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>Duursma, R. A., et B. E. Medlyn. 2012. « MAESPA: a model to study interactions between water limitation, environmental drivers and vegetation function at tree and stand levels, with an example application to [CO2] × drought interactions ». Geoscientific Model Development 5 (4): 919‑40. <a href="https://doi.org/10.5194/gmd-5-919-2012">https://doi.org/10.5194/gmd-5-919-2012</a>.</p><p>Monteith, John L., et Mike H. Unsworth. 2013. « Chapter 13 - Steady-State Heat Balance: (i) Water Surfaces, Soil, and Vegetation ». In Principles of Environmental Physics (Fourth Edition), edited by John L. Monteith et Mike H. Unsworth, 217‑47. Boston: Academic Press.</p><p>Schymanski, Stanislaus J., et Dani Or. 2017. « Leaf-Scale Experiments Reveal an Important Omission in the Penman–Monteith Equation ». Hydrology and Earth System Sciences 21 (2): 685‑706. <a href="https://doi.org/10.5194/hess-21-685-2017">https://doi.org/10.5194/hess-21-685-2017</a>.</p><p>Vezy, Rémi, Mathias Christina, Olivier Roupsard, Yann Nouvellon, Remko Duursma, Belinda Medlyn, Maxime Soma, et al. 2018. « Measuring and modelling energy partitioning in canopies of varying complexity using MAESPA model ». Agricultural and Forest Meteorology 253‑254 (printemps): 203‑17. <a href="https://doi.org/10.1016/j.agrformet.2018.02.005">https://doi.org/10.1016/j.agrformet.2018.02.005</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../gs/">« Stomatal conductance</a><a class="docs-footer-nextpage" href="../light/">Light interception »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Friday 29 November 2024 10:38">Friday 29 November 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
